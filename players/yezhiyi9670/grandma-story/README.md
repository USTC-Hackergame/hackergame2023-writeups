## 6. 奶奶的睡前 flag 故事

### 尝试与解决

> 关键词：关键词、漏洞利用、本世纪最弱智 bug

这题看起来似乎毫无头绪，除了这张图之外，再也没有别的信息，题面中也没有隐写什么白色文字。唯一的手段，似乎就是从这张截图中还原 flag 信息。这张截图是一张裁剪后的截图，flag 应当在截图的最下方，可是裁剪过的图怎么可能恢复呢？

然而，题面中给出了几个不寻常的关键词——**谷歌的『亲儿子』**、**连系统都没心思升级**、**截图**。这几个关键词给出了重要的信息：

- **连系统都没心思升级**意味着旧版系统有漏洞。
- **截图**意味着漏洞与截图有关，或许是这个漏洞导致裁剪后的截图能够恢复。
- **谷歌的『亲儿子』**，指的是 Pixel 手机。这个漏洞或许是 Pixel 手机的系统所独有。

这时就可以启动搜索引擎了。关键词：Pixel 截图裁剪 漏洞。很快就可以找到漏洞——Pixel 中的截图标注工具有问题，导致裁剪的截图可以部分还原。甚至有人做了一个在线工具，叫 [aCropalypse](https://acropalypse.app/)。不妨把截图交给这个工具看看。

![](./assets/acropalypse.png)

工具恰好还原出了图片的最下面部分。于是 flag 就来了。

<img src="./assets/acropslypse-pixel-7.png" width="55%" />

### Flag

```plain
flag{sh1nj11ru_k0k0r0_4nata_m4h0}
```

### 拓展阅读

裁剪的截图可以还原，是因为截图软件将裁剪后的图像二进制（通常比原图文件更小）直接覆盖到了原图文件内容上，却没有丢弃多出的未覆盖部分。因此，裁剪后的图片文件实际上包含原图裁剪区域外的部分信息。

这样的截图还原漏洞不约而同地出现在了 Android 原生截图编辑工具和 Windows 的内置截图工具中，持续数年，波及上亿设备，危害了大量网民的隐私安全。好在国内的社交平台通常会二次压缩图像，这会导致图片文件的多余部分被直接丢弃，从而避免了隐私泄露（但是如果发送“原图”就没用了）。目前，此漏洞已被修复。

Bilibili UP 主“差评硬件部”有[一期视频](https://www.bilibili.com/video/BV1nm4y187cY/)专门介绍这个漏洞。UP 主评价这个 bug 为本世纪最弱智 bug。

### 不可行的做法

#### 通过图像处理工具还原

图像处理工具读取图片内容，会直接丢弃图片中的多余数据，自然也就丢弃了包含 flag 的部分，因此无论怎么编辑也无法还原 flag 内容。

比如这样：

<img src="./assets/failed-expansion.png" />

#### 问 ChatGPT

或者试试复现对话内容，

<img src="./assets/failed-conversation-2.png" width="48%" /> <img src="./assets/failed-conversation-1.png" width="48%" />

寄
