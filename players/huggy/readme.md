åšå®¢ç‰ˆæœ¬å‚è€ƒï¼š[https://blog.huggy.moe/posts/2023/5-ustclug-ctf-writeup/](https://blog.huggy.moe/posts/2023/5-ustclug-ctf-writeup/)  
CC BY-NC-SA 3.0
# å¼€ç¯‡åºŸè¯
åˆæ˜¯ä¸€å¹´ hackergame ï¼Œä»Šå¹´å¼€å¯äº†æ–°çš„ç”Ÿæ´»æ¯”è¾ƒå¿™ï¼Œåšå®¢éƒ½åŠå¹´æ›´äº†ï¼ˆç»æœ›ï¼‰ï¼Œä¸è¿‡æŒ‰ç…§æƒ¯ä¾‹ä¸€å¹´ä¸€åº¦çš„ Hackergame è¿˜æ˜¯å‚åŠ ä¸€ä¸‹çš„ã€‚
![score](./img/0.png)  


åŽ†å¹´é¢˜è§£ï¼š  
- [2022](https://blog.huggy.moe/posts/2022/14-ustclug-ctf-writeup/)
- [2021](https://blog.huggy.moe/posts/2021/14-ustclug-ctf-writeup/)
- [2020](https://blog.huggy.moe/posts/2020/15-ustclug-ctf-writeup/)
- [2019](https://blog.huggy.moe/posts/2019/3-ustclug-ctf-writeups/)
# é¢˜ç›®
## ç­¾åˆ°
hackergame å¯åŠ¨ï¼

![genshin-start](./img/1-1.png)  

> https://cnhktrz3k5nc.hack-challenge.lug.ustc.edu.cn:13202/?similarity=100

![genshin-flag](./img/1-2.png)  

ä¸çŽ©åŽŸç¥žï¼Œä¸è¯„ä»·  

## çŒ«å’ªå°æµ‹
> Q1: æƒ³è¦å€Ÿé˜…ä¸–ç•Œå›¾ä¹¦å‡ºç‰ˆå…¬å¸å‡ºç‰ˆçš„ã€ŠA Classical Introduction To Modern Number Theory 2nd ed.ã€‹ï¼Œåº”å½“å‰å¾€ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦è¥¿åŒºå›¾ä¹¦é¦†çš„å“ªä¸€å±‚ï¼Ÿï¼ˆ30 åˆ†ï¼‰  
> A1: 12
å¾€å›¾ä¹¦é¦†é‡Œè¯·ï¼š http://opac.lib.ustc.edu.cn/opac/search_adv.php#/index
![neko-test-1](./img/2-1-1.png)  
---
> Q2: ä»Šå¹´ arXiv ç½‘ç«™çš„å¤©ä½“ç‰©ç†ç‰ˆå—ä¸Šæœ‰äººå‘è¡¨äº†ä¸€ç¯‡å…³äºŽã€Œå¯è§‚æµ‹å®‡å®™ä¸­çš„é¸¡çš„å¯†åº¦ä¸Šé™ã€çš„è®ºæ–‡ï¼Œè¯·é—®è®ºæ–‡ä¸­ä½œè€…è®¡ç®—å‡ºçš„é¸¡å¯†åº¦å‡½æ•°çš„ä¸Šé™ä¸º 10 çš„å¤šå°‘æ¬¡æ–¹æ¯ç«‹æ–¹ç§’å·®è·ï¼Ÿï¼ˆ30 åˆ†ï¼‰  
æ‡’å¾—æ‰¾åŽŸæ–‡ï¼Œä¸Šç©·ä¸¾ï¼š
> A2ï¼š23
---
> Q3: ä¸ºäº†æ”¯æŒ TCP BBR æ‹¥å¡žæŽ§åˆ¶ç®—æ³•ï¼Œåœ¨ç¼–è¯‘ Linux å†…æ ¸æ—¶åº”è¯¥é…ç½®å¥½å“ªä¸€æ¡å†…æ ¸é€‰é¡¹ï¼Ÿï¼ˆ20 åˆ†ï¼‰  
> A3: CONFIG_TCP_CONG_BBR

è‡ªå·±é—® GPT åŽ»

---
> Q4: ã€Œæˆ‘â€¦â€¦ä»Žæ²¡è§‰å¾—å†™ç±»åž‹æ ‡æ³¨æœ‰æ„æ€è¿‡ã€ã€‚åœ¨ä¸€ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…ç»™å‡ºäº†èƒ½å¤Ÿè®© Python çš„ç±»åž‹æ£€æŸ¥å™¨ MyPY mypy é™·å…¥æ­»å¾ªçŽ¯çš„ä»£ç ï¼Œå¹¶è¯æ˜Ž Python çš„ç±»åž‹æ£€æŸ¥å’Œåœæœºé—®é¢˜ä¸€æ ·å›°éš¾ã€‚è¯·é—®è¿™ç¯‡è®ºæ–‡å‘è¡¨åœ¨ä»Šå¹´çš„å“ªä¸ªå­¦æœ¯ä¼šè®®ä¸Šï¼Ÿ  
> A4: ECOOP  

![neko-test-4](./img/2-4-1.png)  
æ‰¾åˆ° pdf åŽå°±æœ‰å‡ºå¤„äº†ã€‚  
Supplementary Material Software (ECOOP 2023 Artifact Evaluation approved artifact):


## æ›´æ·±æ›´æš—
åœ°ç‹±ç¬‘è¯  
![titan-joke](./img/3-3.jpeg)  

F12 åœ¨åº•ä¸‹è—ç€ flag  
![titan-devtool](./img/3-1.png)  

åŸºäºŽ token çš„ sha256 çš„ flagï¼š
![titan-sha256](./img/3-2.png)  



    async function getFlag(token) {
      // Generate the flag based on user's token
      let hash = CryptoJS.SHA256(`dEEper_@nd_d@rKer_${token}`).toString();
      return `flag{T1t@n_${hash.slice(0, 32)}}`;
    }


## æ—…è¡Œç…§ç‰‡ 3.0
> æ¥æ—¥æœ¬å¿«ä¸€å¹´äº†ç”šè‡³æ²¡åŽ»è¿‡ä¸Šé‡Ž >_<

### ä¸Šåˆ
![travel-1-1](./img/4-1-1.jpg)  

ä¸€çœ¼è¯ºè´å°”å¥–ï¼Œå¾—å¥–ä¸»äººä¸º koshiba ï¼Œæ—¥æ–‡è¾“å…¥æ³•ç›´æŽ¥æ‰“å‡ºæ¥ä¸¢ ã€€ã‚°ã‚¦ã‚°ãƒ«ã€€å°±æœ‰äº†ï¼š

ãƒŽãƒ¼ãƒ™ãƒ«è³ž koshiba
![travel-1-2](./img/4-1-2.png)  

> æ°¸è¿œæ€€å¿µå°æŸ´æ˜Œä¿Šå…ˆç”Ÿã€‚
![travel-1-3](./img/4-1-3.png)  

äºŽæ˜¯çŸ¥é“ä½œè€…å’Œæœ‹å‹å‚è§‚äº†ä¸œäº¬å¤§å­¦çš„å±•è§ˆï¼ŒäºŽæ˜¯æˆ‘ä»¬æœç´¢ä¸œäº¬å¤§å­¦å¾—åˆ°è¯ºè´å°”å¥–çš„åå•ï¼š  

https://www.s.u-tokyo.ac.jp/ja/gallery/nobelprize/

è¿˜æ˜¯ iCRR è‰ï¼ˆæ±äº¬å¤§å­¦å®‡å®™ç·šç ”ç©¶æ‰€ï¼‰ 

Q2: åœ¨å­¦æ ¡è¯¥å±•åŽ…å±•ç¤ºçš„æ‰€æœ‰åŒç§é‡‘è‰²å¥–ç‰Œçš„å¾—ä¸»ä¸­ï¼Œå‡ºç”Ÿæœ€æ™šè€…èŽ·å¥–æ—¶æ‰€åœ¨çš„ç ”ç©¶æ‰€ç¼©å†™æ˜¯ä»€ä¹ˆï¼Ÿ  
A2: ICRR

Q1: ä½ è¿˜è®°å¾—ä¸Žå­¦é•¿è§é¢è¿™å¤©æ˜¯å“ªä¸€å¤©å—ï¼Ÿï¼ˆæ ¼å¼ï¼šyyyy-mm-ddï¼‰  
A1: 2023-08-10  
è¿™ä¸ªç­”æ¡ˆä¹Ÿå¤ªè‡­äº†å§ï¼ˆç»æœ›ï¼‰  
^ å½“åˆæ˜¯åšç¬¬äºŒé¢˜æŽ¨æ–­å‡ºç¬¬ä¸€é¢˜çš„ï¼Œè¯·çœ‹ç¬¬äºŒé—®çš„åˆ†æžã€‚
### ä¸­åˆ
> ç¦»å¼€æ ¡å›­åŽï¼Œä½ å’Œå­¦é•¿èµ°åˆ°äº†é™„è¿‘çš„ä¸€å®¶æ‹‰é¢é¦†ç”¨é¤ã€‚é‚£å®¶åº—é‡Œçš„æ‹‰é¢é¦™æ°”æ‰‘é¼»ï¼Œåº—å†…çš„è£…é¥°å’Œæ°›å›´ä¹Ÿå……æ»¡äº†æ—¥å¼çš„é£Žæ ¼ã€‚ å­¦é•¿ï¼ˆä¸‹å›¾å·¦ä¸€ï¼‰ä¸Žä½ åˆ†äº«äº†ä¸å°‘å­¦æ ¡çš„è¶£äº‹ã€‚é¥­åŽï¼Œä½ ä»¬å†³å®šåœ¨é™„è¿‘æ•£æ­¥ï¼Œäº«å—è¿™éš¾å¾—çš„é—²æš‡æ—¶å…‰ã€‚å½“ä½ ä»¬èµ°åˆ°ä¸€åº§åšç‰©é¦†å‰æ—¶ï¼Œ é©¬è·¯å¯¹é¢çš„å–·æ³‰å’Œå®ƒå‘¨å›´çš„æ™¯è‰²å¼•èµ·äº†ä½ çš„æ³¨æ„ã€‚ä¸‹åˆï¼Œç™½è‰²çš„å¸ç¯·é‡Œå³å°†ä¸¾åŠžä¸€åœºå¤§åž‹æ´»åŠ¨ï¼Œäººä»¬å¿™ç¢Œçš„èº«å½±ç©¿æ¢­å…¶ä¸­ï¼Œå……æ»¡äº†æœŸå¾…ä¸Žçƒ­æƒ…ã€‚

![travel-2-1](./img/4-2-1.jpeg)  

![travel-2-2](./img/4-2-2.jpeg)  

æ‹‰é¢é¦†åå­—å« ãƒ©ãƒ¼ãƒ¡ãƒ³ã€€ä¸€ä¿¡ã€€ä¸ä¼šæ‰“æ—¥è¯­çš„åº”è¯¥ä¹Ÿå¾ˆå®¹æ˜“æ‰“å¾—å‡ºæ¥ï¼Œ ã‚°ã‚¦ã‚°ãƒ«ã€€ãƒžãƒƒãƒ—ã€€ä¸€æœå°±æœ‰äº†ï¼Œä¸æœä¹Ÿæ²¡å…³ç³»ï¼Œä¸å½±å“è§£é¢˜ï¼ˆé¢˜ç›®è¯´äº†åœ¨ä¸Šé‡Žé™„è¿‘é€›ï¼Œè¿˜æ˜¯å¯ä»¥æ‰¾åˆ°å–·æ³‰æ‰€åœ¨çš„åœ°æ–¹çš„ï¼‰  
äºŽæ˜¯åœ¨ Google earth ä¸€ä¸ªå…¬å›­ä¸€ä¸ªå…¬å›­ç‚¹è¿‡åŽ»ï¼Œç»ˆäºŽæ‰¾åˆ°äº†æ‰€åœ¨å…¬å›­ --- ä¸Šé‡Žå…¬å›­ã€‚
ï¼ˆæœç´¢è¿‡ç¨‹ç•¥ï¼Œæ¯”å¯¹äº†å¿«1å°æ—¶ï¼‰  

æˆ‘ä»¬å†çœ‹çœ‹é—®é¢˜ï¼š
Q3:å¸ç¯·ä¸­æ´»åŠ¨æ‹›å‹Ÿå¿—æ„¿è€…æ—¶ç”¨äºŽæ”¶é›†æŠ¥åä¿¡æ¯çš„åœ¨çº¿é—®å·çš„ç¼–å·ï¼ˆä»¥å­—æ¯ S å¼€å¤´åŽæŽ¥æ•°å­—ï¼‰æ˜¯å¤šå°‘ï¼Ÿ
ç”Ÿè‰ï¼Œä¸çŸ¥é“æ—¶é—´è¿˜èƒ½æ€Žä¹ˆåŠžï¼Ÿ
è¿™é‡Œæˆ‘ä»¬ç»§ç»­æœç´¢ï¼š

ä¸Šé‡Žå…¬åœ’ ã‚¤ãƒ™ãƒ³ãƒˆ ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢  
ä¸­æ–‡ç¿»è¯‘ï¼š  
ä¸Šé‡Žå…¬å›­  æ´»åŠ¨  å¿—æ„¿è€…  

![travel-volunteer](./img/4-2-6.png)  

A3ï¼šS495584522

æ´»åŠ¨ä¸Šçš„æ—¶é—´æ˜¯ 2023å¹´8æœˆ10æ—¥åˆ°13æ—¥ï¼ŒäºŽæ˜¯ç¬¬ä¸€é¢˜æ‰‹åŠ¨çˆ†ç ´å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆäº†ã€‚  
A1: 2023-08-10

äº‹åŽå¤ç›˜ï¼Œåªè¦æœç´¢ åšç‰©é¤¨ å™´æ°´ åŸºæœ¬ä¸Šå°±åªæœ‰ä¸€ä¸ªåœ°æ–¹äº†ï¼Œä¸Šé‡Žå…¬å›­ï¼š
![travel-2-5](./img/4-2-5.jpg) 

### ä¸‹åˆ

è¿™å¥—ç¤¾å·¥é¢˜æˆ‘éƒ½åšäº†ä¸€ä¸ªä¸‹åˆæ—¶é—´ï¼Œå¤§å®¶æ˜¯å¦‚ä½•å¾—åˆ° 400 ä»½åšå‡ºæ¥çš„æˆç»©çš„ï¼Ÿæ˜¯æœ‰å¥‡è¿¹å‘ç”Ÿä¹ˆã€‚  
å­¦é•¿åˆ°åº•åŽ»å“ªé‡Œäº†Â¿
## èµ›åšäº•å­—æ£‹
å¯¹æ–¹çš„æ£‹å­å¯ä»¥ç›–è¿‡åŽ»ï¼Œä¸è¯´ä»€ä¹ˆäº†ã€‚  
![cyber-1](./img/5-1.png)  
æŠŠæ­¤å¤„åˆ¤æ–­åŽ»æŽ‰å³å¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨å‘åŒ…ã€‚


## å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹
>ã€Œè¿™ä¸ªåœ°æ–¹æ€Žä¹ˆè¿žä¸ªåŽä¸ºæ‰‹æœºéƒ½ä¸å–ã€‚è‹¥æ˜¯ä¹°ä¸ªè‹¹æžœæ‰‹æœºï¼Œå¿ƒç–¼çš„æ˜¯å®ƒè¿žä¸ªå®žä½“ SIM å¡æ§½éƒ½è—èµ·æ¥äº†ï¼Œå›žå›½è‚¯å®šæˆäº†ä¸ªå¤§æ‘†è®¾ã€‚ä¸å¦‚æ¥ä¸ªè°·æ­Œçš„ã€Žäº²å„¿å­ã€ï¼Ÿã€L åŒå­¦è¸Œèº‡æ»¡å¿—åœ°å˜€å’•é“ã€‚  
> é‚£æ—¶ï¼Œåƒæ˜¯ä¸Šå¤©çš„å®‰æŽ’ï¼Œã€Œå’±è¿™å„¿æ­£å¥½æœ‰ä¸ªè°·æ­Œã€Žäº²å„¿å­ã€çš„è€æ‰‹æœºï¼Œä½ æ‹¿åŽ»é€é¥å§ã€ã€‚  
> L åŒå­¦æ»¡çœ¼æ˜Ÿå…‰åœ°æŽ¥è¿‡ï¼Œè¿žç³»ç»Ÿéƒ½æ²¡å¿ƒæ€å‡çº§ï¼Œå°±å¼€å§‹ç–¯ç‹‚å®‰è£…é‚£ä¸ªä¹…é—»å¤§åçš„ GPT ç¨‹åºï¼Œç”šè‡³é›€è·ƒåœ°åœ¨ç¾¤é‡Œæ™’å‡ºä¸€å¼ è·Ÿ GPT å¯¹è¯çš„ç²¾å½©æˆªå›¾ï¼Œä¸€æ—¶é—´æˆä¸ºäº†ç¾¤é‡Œçš„ç„¦ç‚¹äººç‰©ã€‚

å·²ç»è¯´çš„è¿™ä¹ˆæ˜Žæ˜¾äº†ï¼Œæ˜¯ CVE-2023-21036 ï¼Œä¸¢ https://acropalypse.app/ è§£ä¸‹åŠéƒ¨åˆ†å°±è¡Œã€‚

![cve-2023-21036](./img/6-1.png)  

## ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨
å†™ä¸ªè„šæœ¬æ’¤å›žå³å¯
    // ==UserScript==
    // @name         æ’¤å›žå¸¦å¸ˆ
    // @match        http://202.38.93.111:10021
    // ==/UserScript==

    setInterval(() => {
        const chatList = document.querySelectorAll('.fakeqq-container > div')
        for (let i = 0; i < chatList.length; i++) {
            const d = chatList[i];
            const text = d.textContent
            if (text.includes('hack[') && text.includes(']')) {
                d.click()
                d.children[0].click()
                console.log(text)
                d.querySelector('.fakeqq-message__bubble').click()
            }
        }
    },1000)

æ¯”è¾ƒæ‡’ï¼Œè¿™é‡Œæ˜¯å¾ªçŽ¯è¿è¡Œï¼Œèƒ½ç”¨å°±æ˜¯


## JSON âŠ‚ YAML?
### YAML1.1
è€æœ‹å‹ï¼Œä¸€çœ¼ NaN  

{"a": NaN}

    Input your JSON: {"a": NaN}
    As JSON: {'a': nan}
    As YAML 1.1: {'a': 'NaN'}
    Flag1: flag{faf9facd7c9d64f74a4a746468400a50645e101577}

    No flag2
### YAML1.2
é—® gpt é—®çš„ .jpg
![bing ai](./img/9-1.jpg)  

{"a":1,"a":2}

    Input your JSON: {"a":1,"a":2}
    As JSON: {'a': 2}
    As YAML 1.1: {'a': 2}
    No flag1
    Flag2: flag{b1c73f14d04db546b7e7e24cf1cc7252aaae60c417}


## Git? Git!

`git reflog` æ‰¾æœ€è¿‘ä¿®æ”¹ç„¶åŽ `git checkout` å°±å¥½äº†

## HTTP é›†é‚®å†Œ
å¯¹ç€ [mdn](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status) ä¸€é¡¿è¯»ç„¶åŽæž„é€ è¯·æ±‚å¤´å³å¯
ï¼ˆå†…å®¹è¯·å±•å¼€ï¼‰

    # æ²¡æœ‰çŠ¶æ€ç 
    GET /

    # 100
    GET / HTTP/1.1\r\n
    Expect: 100-continue\r\n
    Host: example.com\r\n\r\n

    # 200 
    çœ‹æˆ‘å¹²ä»€ä¹ˆï¼ˆ

    # 206
    GET / HTTP/1.1\r\n
    Host: example.com\r\n
    Range: bytes=0-10\r\n\r\n


    # 304
    GET / HTTP/1.1\r\n
    Host: example.com\r\n
    If-Modified-Since: Tue, 15 Aug 2023 17:03:04 GMT\r\n
    If-None-Match: "64dbafc8-267"\r\n
    Cache-Control: max-age=0\r\n\r\n


    # 400
    # å¤ªå®¹æ˜“è§¦å‘äº†ï¼Œéšä¾¿çŽ©
    GET / HTTP/1.1\r\n
    Haost: example.com\r\n\r\n

    # 404
    çœ‹æˆ‘å¹²ä»€ä¹ˆï¼ˆ

    # 405
    PUT / HTTP/1.1\r\n
    Host: example.com\r\n\r\n

    # 412
    GET / HTTP/1.1\r\n
    Host: example.com:9999 \r\n
    If-Match: "123456"
    \r\n\r\n


    # 413
    GET / HTTP/1.1\r\n
    Host: example.com:9999 \r\n
    Content-Length: 11451419\r\n
    \r\n\r\n

    # 414
    GET /114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853114514191981085311451419198108531145141919810853 HTTP/1.1\r\n
    Host: example.com\r\n\r\n

    # 416
    GET / HTTP/1.1\r\n
    Host: example.com:9999 \r\n
    Range: bytes=1000-1001
    \r\n\r\n


    # 505
    GET / HTTP/2.0\r\n
    Host: example.com\r\n\r\n


## Docker for Everyone

ç®€å• docker ææƒï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¸¦ç‰¹æƒçš„å®¹å™¨æŠŠ /dev/shm æŒ‚è½½è¿›æ¥å³å¯

    alpine:~$ docker run -it --rm -v/dev/shm:/mnt alpine
    / # cat /mnt/flag 
    flag{u5e_r00t1ess_conta1ner_22aa7813bf_plz!}
    / # 

## æƒœå­—å¦‚é‡‘ 2.0
ä»Šå¹´å¤§æ”¾æ°´ï¼Œéšä¾¿åŠ å‡ ä¸ªå­—ç¬¦ä¸²å°±åšå®Œäº†  
ä¿®å¤åŽçš„æºç å‚è€ƒï¼š  

    #!/usr/bin/python3

    def check_equals(left, right):
        if left != right:
            print("g")
            print(left,right)
            exit()

    def get_cod_dict():
        # prepar th cod dict
        cod_dict = []
        cod_dict += ['nymeh1niwemflcir}echaete']
        cod_dict += ['a3g7}kidgojernoetlsup?he']
        cod_dict += ['ulw!ff5soadrhwnrsnstnoeq']
        cod_dict += ['cct{l-findiehaai{oveatas']
        cod_dict += ['ty9kxborszstgguyd?!blm-p']
        check_equals(set(len(s) for s in cod_dict), {24})
        return ''.join(cod_dict)

    def decrypt_data(input_codes):
        # retriev th decrypted data
        cod_dict = get_cod_dict()
        output_chars = [cod_dict[c] for c in input_codes]
        return ''.join(output_chars)

    if __name__ == '__main__':
        # check som obvious things
        check_equals('create', 'cre' + 'ate')
        check_equals('referrer', 'refer' + 'rer')
        # check th flag
        flag = decrypt_data(
        [   53, 41, 85, 109, 75, 1, 33, 48, 77, 90,
            17, 118, 36, 25, 13, 89, 90, 3, 63, 25,
            31, 77, 27, 60, 3, 118, 24, 62, 54, 61,
            25, 63, 77, 36, 5, 32, 60, 67, 113, 28
        ])
        print(flag)
        check_equals(flag.index('flag{'), 0)
        check_equals(flag.index('}'), len(flag) - 1)
        # print th flag
        print(flag)

æˆ‘ä»¬å¯ä»¥è§£æžä¸€ä¸‹ï¼Œé¦–å…ˆæŠŠ `if __name__ == '__main__':` ä¿®äº†

å’Œä¹‹å‰ä¸€æ ·ï¼Œæœ‰ä¸ªæµ‹é•¿åº¦çš„å‡½æ•°ï¼Œæˆ‘ä»¬ç®€å•æ”¹é€ ä¸€ä¸‹ï¼Œæ–¹ä¾¿çŸ¥é“å“ªé‡Œé”™äº†ï¼š  

    def check_equals(left, right):
        if left != right:
            print("g")
            print(left,right)
            exit()

åœ¨ get_cod_dict ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æ²¡ä¸ªæ•°ç»„ï¼ˆå­—å…¸ï¼‰éƒ½æ˜¯ 24 ä¸ªå­—ï¼Œå…ˆå…¨éƒ¨æœ«å°¾åŠ  e

    cod_dict += ['nymeh1niwemflcir}echaete']
    cod_dict += ['a3g7}kidgojernoetlsup?he']
    cod_dict += ['ulw!f5soadrhwnrsnstnoeqe']
    cod_dict += ['ct{l-findiehaai{oveatase']
    cod_dict += ['ty9kxborszstguyd?!blm-pe']

ç„¶åŽè‚¯å®šä¸è¡Œå˜›ï¼Œä¸è¿‡æˆ‘ä»¬ä»ç„¶å¯ä»¥æ‰¾åˆ°è§„å¾‹ï¼š

    â¯ python3 print_flag.py
    5laulyoufeepr3cvees3df7weparsn3sfr1gwn!
    Traceback (most recent call last):
      File "/Users/h/Downloads/hackergame-2023/print_flag.py", line 38, in <module>
        check_equals(flag.index('flag{'), 0)
                    ^^^^^^^^^^^^^^^^^^^
    ValueError: substring not found

è¿™ä¸å°±æ˜¯æ˜Žæ‘†ç€æ˜¯ä»¥ `flag{` å¼€å¤´çš„å—ï¼ŒäºŽæ˜¯æˆ‘ä»¬å¤§æ¦‚å°±å¯ä»¥çŒœå“ªé‡Œè¦è¡¥äº†ã€‚  
é¦–å…ˆæ˜¯ `f`ï¼Œç»™çš„é¡ºåºæ˜¯ 53ï¼Œå®žé™…æ˜¾ç¤ºçš„æ˜¯ `5`ï¼Œæ‰€ä»¥æˆ‘æŠŠç¬¬ä¸‰è¡Œçš„ `f` å¤šåŠ äº†ä¸€ä¸ªï¼ˆç»“å°¾çš„eè®°å¾—åŽ»æŽ‰ï¼‰  
ï¼ˆè¿æ°”æ¯”è¾ƒå¥½ï¼Œä¸€æ¬¡æˆåŠŸï¼Œå¦‚æžœå®žé™…ä¸Šæ˜¯ `f` å‰é¢çš„ `w` æˆ–è€… äº† å†è¯•å‡ æ¬¡å°±è¡Œï¼‰  

    cod_dict += ['ulw!ff5soadrhwnrsnstnoeq']

la æ²¡é—®é¢˜ï¼ŒæŽ¥ä¸‹æ¥ä¿®å¤ä¸º 109 çš„ `g` ï¼ŒåŒæ ·ä¹Ÿæ˜¯ `g` å¤šåŠ ä¸€ä¸ª

    cod_dict += ['ty9kxborszstgguyd?!blm-p']

ç„¶åŽä¿®å¤75 çš„ `{` ä¸æ˜¯ `c` å°±æ˜¯ `t` å…ˆçŒœ `c`

    cod_dict += ['cct{l-findiehaai{oveatas']

ç»“æŸï¼š

    flag{you-ve-r3cover3d-7he-an5w3r-r1ght?}


è¿™ä¸é€åˆ†é¢˜ï¼Ÿ



## ðŸª é«˜é¢‘çŽ‡æ˜Ÿçƒ

ç”¨

    asciinema cat file > a

dump ç„¶åŽåŽ»é™¤æ‚è´¨å³å¯è¿è¡Œã€‚

æºç å¤ªé•¿è´´ä¸å‡ºæ¥ï¼Œå‚è€ƒå®˜æ–¹é¢˜è§£å°±å¥½ï¼Ÿ  

## ðŸª å°åž‹å¤§è¯­è¨€æ¨¡åž‹æ˜Ÿçƒ
éšä¾¿çŽ©äº†çŽ©ï¼Œæ²¡ç ”ç©¶
### You Are Smart

prompt å¿˜äº†ï¼Œå‚è€ƒé¢˜è§£å§ >_<

## ä¸ºä»€ä¹ˆè¦æ‰“å¼€ /flag ðŸ˜¡
### LD_PRELOAD, love!
LD_PRELOAD ä¸€çœ¼é™æ€ç¼–è¯‘

    # gcc -static flag1.c
    #include<stdio.h>

    int main(){
      printf("Â¿ from huggy\n");
      FILE *file;

      file = fopen("/flag", "r");
      char line[100];
      while (fgets(line, sizeof(line), file) != NULL) {
          printf("%s", line);
      }
      fclose(file);
      return 0;
    }

ç¬¬äºŒé¢˜æ²¡ç ”ç©¶ï¼ˆ

# æ®‹å¿µåŒº
## æ—…è¡Œç…§ç‰‡ 3.0
æ­¤å¤„ä¹Ÿæ˜¯éš¾åº¦å¤§æå‡ï¼Œå­¦æœ¯ä¹‹æ—…æ²¡æƒ³åˆ°æ˜¯çœŸçš„å‚åŠ å­¦æœ¯ä¹‹æ—…ï¼ˆè€Œä¸æ˜¯æ‘¸é±¼æ—…æ¸¸ï¼‰
## å¾®ç§¯åˆ†è®¡ç®—å°ç»ƒä¹  2.0
æœ¬æ¥æ˜¯æœ‰åšè®¡åˆ’ window.open çš„ï¼Œä½†æ˜¯æ‰¾ä¸åˆ°ç›¸å…³æ³¨å…¥ç‚¹ï¼Œæ²¡æƒ³åˆ° .open çš„ name å°±è¡Œ >_<
ï¼ˆç”±äºŽ 25 ä¸ªå­—ç¬¦é™åˆ¶ï¼Œæƒ³ä¸åˆ°ä»€ä¹ˆå¥½çš„ callback ç‚¹ï¼‰

# æ€»ç»“
ä»Šå¹´ç›¸æ¯”å‰ä¸¤å¹´æ²¡æœ‰é‚£ä¹ˆå¤šæ—¶é—´è‚äº†ï¼Œä¸ç„¶åº”è¯¥è¿˜æœ‰2-3é¢˜å¯ä»¥å¹²å‡ºæ¥çš„ï¼ˆè¿™æ¬¡ç”šè‡³æœ‰å¾ˆå¤šé¢˜æ²¡æœ‰æ‰“å¼€è¿‡ï¼‰ï¼Œç„¶åŽå¯ä»¥é¢„è§åœ°æ˜Žå¹´æ—¶é—´æ›´å°‘ï¼Œä»Šå¹´ä¹Ÿè®¸çœŸçš„æ˜¯æœ€åŽä¸€æ¬¡å‚ä¸Žã€‚

<br>
<br>
<br>
å®Œ