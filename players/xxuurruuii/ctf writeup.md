# Hackergame2023 writeup By xxuurruuii

ï¼ˆå¸¦æœ‰ç§è´§ï¼‰

### Hackergame å¯åŠ¨

ç­¾åˆ°é¢˜ï¼Œæ³¨æ„åˆ°é“¾æŽ¥é‡Œæœ‰ ```/?similarity=``` ï¼ŒæŠŠåŽé¢çš„æ•°å­—æ”¹æˆ100å°±è¿‡äº†

ä½ è¯´å¾—å¯¹ï¼Œä½†æ˜¯Hackergameæ˜¯ä¸€æ¬¾åŽé¢å¿˜äº†

### çŒ«å’ªå°æµ‹

ç®€å•æœç´¢é¢˜

ç¬¬ä¸€é—®æœä¸å‡ºæ¥ï¼Œä½†æ˜¯å¯ä»¥ç©·ä¸¾ï¼Œç­”æ¡ˆæ˜¯12

ç¬¬äºŒé—®å¾ˆå¥½æœï¼Œä¸¢ç™¾åº¦å°±èƒ½çœ‹åˆ°ä¸€ç¯‡è®²è¿™ä¸ªçš„çŸ¥ä¹Žæ–‡ç« ï¼Œç­”æ¡ˆæ˜¯23

ç¬¬ä¸‰é—®æˆ‘ç”¨çš„æ˜¯gptï¼Œä¼—æ‰€å‘¨çŸ¥gptæ˜¯æ–°æ—¶ä»£éžå¸¸æœ‰æ•ˆçš„æœç´¢å·¥å…·ï¼ˆä¹ï¼‰ï¼Œé‚£ä¹ˆä»–æä¾›çš„ç­”æ¡ˆä¹Ÿæ˜¯æ­£ç¡®çš„ï¼š

![Alt text](img/image-1.png)

ç¬¬å››é—®ç›´æŽ¥æœç´¢å¹¶ä¸å®¹æ˜“ï¼Œç”šè‡³è¿˜èƒ½æœåˆ°æŸè€å“¥åœ¨å„å¤§ç™¾åº¦è´´å§è¯¢é—®çš„å¸–å­ï¼Œä½†æ˜¯æ³¨æ„åˆ°è¿™é¦–å…ˆæ˜¯ä¸€ç¯‡è®ºæ–‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åŽ»ä¸“é—¨æœè®ºæ–‡çš„ç½‘é¡µï¼ˆæˆ‘ç”¨çš„æ˜¯è°·æ­Œå­¦æœ¯ï¼‰æœç´¢å…³é”®è¯ï¼Œèƒ½çœ‹åˆ°ä¸€ç¯‡è®²pyç±»åž‹æ£€æŸ¥å›¾çµå®Œå¤‡çš„è®ºæ–‡ï¼Œå°±æ˜¯æˆ‘ä»¬è¦çš„ç­”æ¡ˆã€‚

![Alt text](img/image-2.png)

### æ›´æ·±æ›´æš—

é˜…è¯»é¢˜å¹²èƒ½çŸ¥é“æˆ‘ä»¬éœ€è¦å¾€ä¸‹ç¿»åˆ°åº•æ¥èŽ·å¾—flagï¼Œä½†æ˜¯ç®€å•ç¿»äº†ç¿»ä¼šæ„è¯†åˆ°å‡ ä¹Žæ²¡æ³•ç¿»åˆ°åº•ï¼Œå› æ­¤å¯ä»¥æ‰“å¼€f12é˜…è¯»ç½‘é¡µæºä»£ç æ¥èŽ·å–flagã€‚ç®€å•é¢˜

![Alt text](img/image-3.png)

### æ—…è¡Œç…§ç‰‡ 3.0

ç¤¾å·¥é¢˜ï¼Œæˆ‘å®Œå…¨ä¸ä¼šçš„ç±»åž‹ï¼Œæ‰€ä»¥åªåšäº†ç¬¬ä¸€é—®

å°†å¥–ç‰Œçš„å›¾ç‰‡ä¸¢å…¥æœå›¾å¯ä»¥å¾—åˆ°æ˜¯è¯ºè´å°”ç‰©ç†å­¦å¥–ï¼Œå†æœç´¢äººåçŸ¥æ˜¯ å°æŸ´æ˜Œä¿Š ï¼ŒæŽ¥ä¸‹æ¥å°±æ˜¯åœ¨ç»´åŸºä¸Šç¿»é˜…ä¿¡æ¯æ‰¾åˆ°ç¬¬äºŒå°é—®çš„ç­”æ¡ˆï¼›ç¬¬ä¸€é—®å®žåœ¨æ²¡æ€è·¯ï¼Œå¥½åœ¨å·²çŸ¥æ˜¯ä»Šå¹´æš‘å‡æ‰€ä»¥ç›´æŽ¥ç©·ä¸¾è¿‡åŽ»äº†ï¼ˆ

### èµ›åšäº•å­—æ£‹

æ­£å¸¸æ‰‹æ®µä¸€å®šæ˜¯èµ¢ä¸äº†çš„ï¼Œæ‰€ä»¥è¿™é¢˜æˆ‘ä»¬è¦æ‰“å¼€f12ç ”ç©¶ä¸€ä¸‹jsã€‚æ³¨æ„åˆ°ç‚¹å‡»å·²ç»æœ‰æ£‹å­çš„åœ°æ–¹æ—¶consoleæ ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬æ ¹æ®æŠ¥é”™è·³è½¬åˆ°å¯¹åº”ä½ç½®å¯ä»¥çœ‹åˆ°ä¸‹æ£‹çš„ç›¸å…³ä»£ç ã€‚

![Alt text](img/image-4.png)

![Alt text](img/image-5.png)

ä¸éš¾çŒœå‡º ```await setMove(x,y)``` å°±æ˜¯ä¸‹æ£‹ç›¸å…³æŒ‡ä»¤ï¼Œé‚£ä¸å¦‚å¤åˆ¶å‡ ä»½ä¸€æ¬¡å¤šä¸‹å‡ ä¸ªæ£‹ï¼ˆè¿™é‡Œè¦ç”¨åˆ°google chromeçš„overrideåŠŸèƒ½æ¥è¦†ç›–jsæ–‡ä»¶ï¼‰ï¼š

![Alt text](img/image-6.png)

ç„¶åŽåˆ·æ–°ç½‘é¡µï¼Œé‡æ–°å¼€å±€ï¼Œåœ¨ä»»æ„å¤„ç‚¹ä¸€ä¸‹å°±ä¼šä¸€æ¬¡ä¸‹3ä¸ªæ£‹ï¼Œéžå¸¸é¡ºåˆ©åœ°å–å¾—äº†èƒœåˆ©

å°è¶£äº‹ï¼šflagé‡Œå†™çš„æ˜¯ ```I_can_eat_your_pieces``` ï¼Œä½†æ˜¯æˆ‘åšå®Œäº†ä¹Ÿä¸çŸ¥é“æ€Žä¹ˆåƒå­ï¼ˆ

### å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹

é¢˜å¹²éžå¸¸è´´å¿ƒåœ°æä¾›äº†åŠ ç²—æ–‡æœ¬ï¼Œæœç´¢è°·æ­Œã€ç³»ç»Ÿå‡çº§ã€æˆªå›¾ç­‰å…³é”®è¯å¯ä»¥å‘çŽ°ä¸€ä¸ªæˆªå›¾æ¼æ´žå¯ä»¥è¿˜åŽŸå›¾ç‰‡ä¿¡æ¯ï¼Œè¿›ä¸€æ­¥æœç´¢èƒ½å‘çŽ° [aCropalypse](https://acropalypse.app/) è¿™ä¸ªä¸“é—¨æ¢å¤æ­¤ç±»å›¾ç‰‡ä¿¡æ¯çš„ç½‘ç«™ï¼Œ**è°ƒæ•´é¢„è®¾å›¾ç‰‡å®½åº¦**åŽæŠŠå›¾ç‰‡ä¸¢è¿›åŽ»å°±èƒ½çœ‹åˆ°æ¢å¤çš„ä¿¡æ¯ã€‚

![Alt text](img/image-8.png)

![Alt text](img/image-7.png)

è®¾ç½®å›¾ç‰‡å®½åº¦éžå¸¸é‡è¦ï¼æˆ‘ä¸€å¼€å§‹æ²¡åœ¨æ„è¿™ä¸ªå®½åº¦ç„¶åŽå•¥ä¹Ÿæ²¡æå–å‡ºæ¥ï¼Œè¿˜ä»¥ä¸ºæˆ‘æ€è·¯é”™äº†ï¼ˆæ¼ï¼‰

### ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨

è¿™é¢˜ä¹Ÿæ˜¯è¦ä¿®æ”¹jsæ–‡ä»¶ï¼Œå…ˆctrl+fæœç´¢â€œæ’¤å›žâ€è·³è½¬åˆ°ç›¸å…³ä»£ç å¤„ï¼Œå°±èƒ½çœ‹åˆ°æ¶‰åŠç½‘é¡µæ·»åŠ æ¶ˆæ¯å’Œç‚¹å‡»æ’¤å›žçš„ä»£ç ã€‚æŠŠç‚¹å‡»æ’¤å›žçš„é‚£éƒ¨åˆ†ä»£ç å¤åˆ¶è¿›ç½‘é¡µæ·»åŠ æ¶ˆæ¯é‡Œé¢ï¼ŒåŠ ä¸ªifå°±èƒ½è®©ç½‘é¡µæ˜¾ç¤ºæ¶ˆæ¯åŽè‡ªåŠ¨æ’¤å›žã€‚~~è™½ç„¶è¿™æ ·è§†è§‰æ•ˆæžœä¸Šæ²¡æ’¤å›žï¼Œä½†æ˜¯å®žé™…ä¸Šå·²ç»å‘é€äº†æ’¤å›žçš„ç½‘ç»œè¯·æ±‚æ‰€ä»¥ç®¡ä»–å‘¢~~

![Alt text](img/image-9.png)

### è™«

ä¸€çœ¼sstvï¼Œåœ¨ç½‘ä¸Šä¸‹è½½mmsstvç„¶åŽæŽ¥ä¸ªè™šæ‹Ÿå£°å¡æŠŠå¤–æ”¾å£°éŸ³æŽ¥å›žåŽ»å°±åšå‡ºæ¥äº†

ccbc12ä¹Ÿæœ‰ä¸ª[sstvé¢˜](https://archive.cipherpuzzles.com/index.html#/problem?c=ccbc12/problems/e/p2021)ï¼Œ~~æ‰€ä»¥ä½ ä»¬åˆ°åº•æ˜¯ctfæ¯”èµ›è¿˜æ˜¯puzzlehuntæ¯”èµ›~~

è¿™å°±æ˜¯puzzlehuntç»™æˆ‘çš„è‡ªä¿¡.jpg

![Alt text](img/image-10.png)

### æƒœå­—å¦‚é‡‘ 2.0

æ‹¿åˆ°ä»£ç å¤„ç†å®Œå‡ ä¸ªassertåŽä¼šå‘çŽ°è¿™é¢˜çš„æ ¸å¿ƒåœ¨```get_cod_dict()```ä¸­ï¼Œ```cod_dict```çš„æ¯ä¸€é¡¹éƒ½åªæœ‰23é•¿åº¦ï¼Œè€Œ```check_equals()```å‘Šè¯‰æˆ‘ä»¬æœ¬åº”è¯¥æ˜¯æ¯ä¸€é¡¹æœ‰24é•¿åº¦ã€‚ä¸éš¾å‘çŽ°æ¯ä¸€é¡¹éƒ½æ°å¥½åˆ åŽ»äº†ä¸€ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬ä¸å¦¨è¯•è¯•åœ¨æœ€å‰é¢å’Œæœ€åŽé¢åŠ å…¥ä¸€ä¸ªæ— å…³å­—ç¬¦ï¼ˆè¿™é‡Œç”¨@è¡¨ç¤ºï¼‰çœ‹çœ‹å¾—åˆ°äº†ä»€ä¹ˆè¾“å‡ºï¼ˆå½“ç„¶ï¼Œè¿è¡Œç¨‹åºå‰å…ˆæŠŠæœ€åŽçš„ä¸¤ä¸ª```check_equals```åˆ äº†ï¼‰ï¼š

![Alt text](img/image.png)

![Alt text](img/image-11.png)

å› ä¸º```cod_dict```ä¸­æ¯ä¸€é¡¹éƒ½åªåˆ åŽ»äº†ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æœ€ç»ˆçš„flagæ¯ä¸ªä½ç½®çš„å­—ç¬¦å¿…å®šåœ¨ä»¥ä¸Šä¸¤ç§æƒ…å†µä¹‹ä¸€ï¼Œæˆ–è€…æ˜¯eã€‚ä½œä¸ºä¸€ä¸ªæ‡’å¾—å†™ä»£ç çš„äººï¼Œæˆ‘å¼€å§‹æ‰‹åŠ¨æ‹–@æ¡æ¥å‡‘flagã€‚@éƒ½åœ¨å·¦è¾¹çš„æ—¶å€™```ftag{ng@-v}-ealovmrai-ghm-@n5war-ehdht?7```æœ‰éžå¸¸æ˜Žæ˜¾çš„ç‰¹å¾ï¼Œå¼€å¤´æœ‰ä¸ªtä¸å¤ªå¯¹ï¼Œæ‰€ä»¥æŠŠç¬¬äºŒä¸ª@æ‹‰åˆ°æœ€å³è¾¹çœ‹çœ‹ï¼š

![Alt text](img/image-12.png)

çœ‹èµ·æ¥å·²ç»ç¦»æ­£ç¡®ç­”æ¡ˆä¸è¿œäº†ï¼æ­¤æ—¶æˆ‘ä»¬å†å¯¹ç…§ä¸€ä¸‹â€œå¯èƒ½å‡ºçŽ°çš„å­—ç¬¦åˆ—è¡¨â€ï¼š

![Alt text](img/image-13.png)

æ­¤æ—¶flagåŸºæœ¬ä¸Šå·²ç»èƒ½çˆ†äº†ï¼Œå¤§æ¦‚çŒœä¸€çŒœå°±æ˜¯you-ve-recovered-the-answer-rightï¼Œç¬¦åˆé¢˜æ„ä¸”éƒ½åœ¨â€œå¯èƒ½å‡ºçŽ°çš„å­—ç¬¦åˆ—è¡¨â€é‡Œï¼Œç­”æ¡ˆæ­£ç¡®ã€‚

### ðŸª é«˜é¢‘çŽ‡æ˜Ÿçƒ

è¿™é¢˜ä¸€æ¥å…ˆæ‹ä¸€ä¸ªasciinemaåˆ°æˆ‘è„¸ä¸Šï¼Œæˆ‘æ£é¼“äº†åŠå¤©å‘çŽ°windowså¥½åƒç”¨ä¸äº†asciinemaï¼ˆã€‚

æ€Žä¹ˆåŠžå‘¢ï¼Œåªèƒ½ç¡¬ç€å¤´çš®æ‰“å¼€recæ–‡ä»¶äº†ã€‚æ‰“å¼€ä¸€çœ‹è¿™ä¸ªæ–‡ä»¶æ„å¤–åœ°å¾ˆå¯è¯»ï¼Œç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªå­—å…¸è¡¨ç¤ºæ–‡ä»¶ä¿¡æ¯ï¼ŒåŽé¢è‹¥å¹²è¡Œæ¯ä¸€è¡Œéƒ½æ˜¯ä¸‰ä¸ªæ•°æ®ï¼Œå‰ä¸¤ä¸ªä¸çŸ¥é“ï¼Œç¬¬ä¸‰ä¸ªæ˜¯è¦æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„ä¸œè¥¿ã€‚é‚£å°±ç®€å•äº†ï¼Œå†™ä¸€ä¸ªç¨‹åºè¯»å–æ¯ä¸€è¡Œçš„åˆ—è¡¨ç¬¬ä¸‰é¡¹æ‹¼èµ·æ¥ç›´æŽ¥å†™è¿›ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åŽæ‰“å¼€æ£€æŸ¥ä¸€ä¸‹ã€‚æ‰“å¼€å¥½åƒæœ‰ä¸€äº›ä¹±ç ï¼Œåº”è¯¥æ˜¯recæ–‡ä»¶çš„æ ¼å¼éƒ¨åˆ†ï¼Œç”¨è®°äº‹æœ¬è‡ªå¸¦çš„æŸ¥æ‰¾æ›¿æ¢åŠŸèƒ½åˆ ä¸€ä¸‹å°±è¡Œã€‚è¿™æ ·å½“ç„¶æ²¡æ³•ç”¨sha256æ ¡éªŒäº†ï¼Œä¸è¿‡å¹¸è¿çš„æ˜¯å¾—åˆ°çš„jsæ–‡ä»¶è·‘å‡ºäº†flagã€‚

â†“ç”¨è®°äº‹æœ¬æ›¿æ¢å¯¼è‡´ä»£ç é‡Œæœ‰ç©ºè¡Œ

![Alt text](img/image-14.png)

### ðŸª ä½Žå¸¦å®½æ˜Ÿçƒ

ç¬¬ä¸€é—®ç½‘ä¸Šéšä¾¿æœä¸€ä¸ªpngåŽ‹ç¼©ç½‘ç«™å°±èƒ½è¿‡ï¼Œé™åˆ¶ç»™çš„å¾ˆå®½ã€‚

ç¬¬äºŒé—®å°è¯•äº†å¾ˆå¤šç§æ–‡ä»¶æ ¼å¼ï¼ŒåŒ…æ‹¬å†™äº†ä¸ª200KBçš„svgï¼Œä¸è¿‡æœ€åŽä»¥å¤±è´¥å‘Šç»ˆã€‚ï¼ˆ50KBåˆ°åº•æ˜¯ä»€ä¹ˆç¥žç§˜ä¸œè¥¿ï¼‰

### å¼‚æ˜Ÿæ­§é€”

~~æ€Žä¹ˆctfè¿˜èƒ½å¡žMindustryé¢˜ï¼Œä¸‹æ¬¡å°±è¦å¾€puzzlehuntå¡žshapezé¢˜äº†~~

æŒ‰ç…§æŒ‡ç¤ºä¸‹è½½Mindustryå¹¶æ‰“å¼€åœ°å›¾ï¼Œè·‘åˆ°æŒ‰é’®æ—è¾¹æ™ƒæ‚ èƒ½å‘çŽ°ä¸€ä¸ªå¾®åž‹å¤„ç†å™¨ï¼Œç‚¹äº†ä¹‹åŽä¼šå‡ºçŽ°ä¸€å †ç´«è‰²è±å½¢å’Œä¸€ä¸ªç¼–è¾‘æŒ‰é’®ã€‚

![Alt text](img/image-15.png)

ç‚¹å¼€ç¼–è¾‘çª—å£å°±èƒ½çœ‹åˆ°ä»£ç ï¼ŒäºŽæ˜¯çŸ¥é“äº†è¿™é¢˜æ˜¯é˜…è¯»ä»£ç ç„¶åŽæ›´æ”¹å¼€å…³æ»¡è¶³æ¡ä»¶ã€‚

ç¬¬ä¸€é¢˜ç†Ÿæ‚‰ç¼–ç¨‹è¯­è¨€ï¼Œç®€å•é¢˜ï¼Œè¿™äº›jumpæ¡ä»¶ä¸€ä¸ªéƒ½ä¸èƒ½æ»¡è¶³æ‰€ä»¥åç€ç‚¹å°±è¡Œ

![Alt text](img/image-16.png)

ç¬¬äºŒé¢˜æ˜¯ä¸€ä¸ªæ•°å­¦é¢˜ï¼Œç”¨æŒ‰é’®è¾“å…¥ä¸€ä¸ªäºŒè¿›åˆ¶æ•°ï¼Œè¦æ±‚```sw1==1```ï¼Œ```sw6==1```ï¼Œæ•´ä¸ªæ•°æ˜¯ä¸€ä¸ªå¹³æ–¹æ•°ï¼Œé€ä¸ªå°è¯•å¾—ç­”æ¡ˆæ˜¯14^2

![Alt text](img/image-17.png)

ç¬¬å››é¢˜æ˜¯ä¸€ä¸ªç”¨æœºæ¢°é€ çš„é—¨ç”µè·¯ï¼Œæ‘¸å‡ ä¸‹è§‚å¯ŸçŠ¶æ€å°±èƒ½æŠŠæ¯ä¸ªéƒ¨åˆ†çš„ä½œç”¨æ‘¸å‡ºæ¥ï¼Œç„¶åŽå€’æŽ¨å³å¯

![Alt text](img/image-18.png)

ç¬¬ä¸‰é¢˜ä¹Ÿæ˜¯æœºæ¢°é¢˜ï¼Œè€Œä¸”å¾ˆå®¹æ˜“ç‚¸ï¼ˆï¼ï¼‰ï¼Œæžçš„æˆ‘é‡æ–°åŠ è½½å­˜æ¡£æžäº†å¾ˆå¤šæ¬¡ã€‚

å…ˆçœ‹åˆ°```nsw3```å¯ä»¥å…³é—­ååº”å †ï¼Œå…ˆæŠŠ```sw3```æ‰“å¼€ä»¥æ–¹ä¾¿åŽç»­æ“ä½œã€‚

![Alt text](img/image-19.png)

```sw1```æŽ§åˆ¶ç²‰è‰²åŽŸæ–™è¿›å…¥ï¼Œ```sw2```æŽ§åˆ¶è“è‰²åŽŸæ–™ä¸è¿›å…¥ï¼Œ```sw5```å¼€å¯æ··åˆå™¨ï¼Œ```sw6```å¼€å¯æŠ½æ°´æœºï¼Œè¿™äº›åˆ†åˆ«è°ƒæ•´å¼€å…³ã€‚```sw8```å¦‚æžœå’Œ```sw9```ï¼ˆç¬¬äºŒé¢˜çš„æœ€åŽä¸€ä½ï¼‰ä¸ä¸€æ ·ä¼šå¼ºåˆ¶å¼€å¯ååº”å †å¹¶ä½¿å…¶çˆ†ç‚¸ï¼Œä¸èƒ½åŠ¨ã€‚

```sw7```ä¼šæ‰“å¼€ä¸¤ä¸ªmeltdownï¼Œç–‘ä¼¼ä¼šä½¿æŠ½æ°´æœºç”µåŠ›ä¸è¶³ã€‚

![Alt text](img/image-20.png)

```sw4```ä¼šä½¿å†·å´æ¶²æ³„éœ²ï¼Œä¸èƒ½å¼€ã€‚

![Alt text](img/image-21.png)

è°ƒæ•´å®ŒåŽå…³é—­```sw3```ï¼Œä¸€åˆ‡éƒ½è¿è¡Œæ­£å¸¸ï¼Œç­”æ¡ˆæ­£ç¡®ã€‚

### å° Z çš„è°œé¢˜

é˜…è¯»ç¨‹åºçŸ¥é“è¿™é¢˜å®žé™…ä¸Šæ˜¯è¦æŠŠ16ä¸ªé•¿æ–¹ä½“ç§¯æœ¨ï¼ˆå½¢çŠ¶å’Œæ•°é‡è§ä»£ç ï¼‰å¡žè¿›ä¸€ä¸ª5*5*5çš„ç®±å­ï¼Œè€Œä¸”ä½“ç§¯åˆšå¥½ç›¸ç­‰ï¼Œæœ€åŽæŒ‰ä¸€ä¸ªç¥žç§˜å…¬å¼è®¡ç®—```score```ç„¶åŽåˆ¤å®šåšå‡ºäº†ç¬¬å‡ å°é—®ã€‚æˆ‘åˆšæ‹¿åˆ°è¿™é¢˜çš„æ—¶å€™å…ˆæ‰‹è·‘äº†ä¸€ä¸ªè§£æ³•å‡ºæ¥ï¼Œ144åˆ†ï¼ŒæŠ¢åˆ°äº†ç¬¬ä¸€é—®çš„é¦–æ€ã€‚

![Alt text](img/10890e926b17912b3a9dfca2e7cda297_720.png)

å½“æˆ‘çŸ¥é“è¿™ä¸ªè§£æ³•144åˆ†çš„æ—¶å€™æˆ‘å°±æ„è¯†åˆ°ä¸å¯¹åŠ²ï¼Œç¬¬äºŒé—®è¦136åˆ†ä»¥ä¸‹ï¼Œç¬¬ä¸‰é—®è¦157åˆ†ä»¥ä¸Šï¼Œçœ‹èµ·æ¥éžå¸¸æžé™ï¼Œæ€Žä¹ˆçœ‹éƒ½ä¸åƒæ˜¯æˆ‘å†æ‰‹è·‘ä¸€ä¸ªè§£å°±èƒ½è·‘å‡ºæ¥çš„ï¼Œæ‰€ä»¥æˆ‘å½“æ—¶æŠŠè¿™é¢˜ä¸¢äº†åšåˆ«çš„é¢˜åŽ»äº†ã€‚

ç„¶åŽæˆ‘çªç„¶æƒ³åˆ°ï¼šè¯¶æ‹¼å›¾ä¸æ˜¯NPé—®é¢˜å—ï¼Œæˆ‘ä¸ºå•¥ä¸å†™ä¸ªsat-solveræš´åŠ›è·‘å‘¢ï¼Ÿä¹‹å‰æœ‰æ®µæ—¶é—´æˆ‘é—²ç€æ²¡äº‹åœ¨ç ”ç©¶sat-solverï¼Œé¡ºä¾¿å¸®æœ‹å‹çš„æ–°æ¸¸æˆ[808s&Genetics](https://store.steampowered.com/app/2550630/808sGenetics/)å†™äº†ä¸ªè§£é¢˜å™¨å’Œå‡ºé¢˜å™¨ï¼Œæ‰€ä»¥æœ‰ä¸€ç‚¹å†™solverçš„ç»éªŒã€‚äºŽæ˜¯æˆ‘åŠ¨æ‰‹å†™äº†ä¸ªsolverï¼Œå› ä¸ºåˆ†æ•°ä¸å¥½é‡åŒ–ä¸ºè§„åˆ™ï¼Œæ‰€ä»¥æˆ‘é‡‡å–äº†è·‘å‡ºè§£åŽæ£€æŸ¥scoreï¼Œåˆ é™¤è¿™ä¸ªè§£å†é‡æ–°è·‘çš„æ–¹æ³•ã€‚å®žé™…å†™å®ŒåŽ5åˆ†é’Ÿä¸åˆ°å°±æŠŠç¬¬äºŒé—®å’Œç¬¬ä¸‰é—®éƒ½åšå‡ºæ¥äº†ï¼Œsat-solverçš„èƒ½åŠ›åˆä¸€æ¬¡è¶…å‡ºäº†æˆ‘çš„æƒ³è±¡ã€‚~~ç—›å¤±ä¸€ä¸ªå¤§é¢˜é¦–æ€~~

solverä»£ç ï¼ˆå†™çš„æŒºçƒ‚çš„ï¼‰

```
from z3 import *
import itertools
s=Solver()
a=[[Int(i*6+j) for j in range(6)] for i in range(16)]
b=[(1,1,3),(1,1,3),(1,1,3),(1,2,2),(1,2,2),(1,2,2),(1,2,2),(1,2,4),(1,2,4),(1,4,4),(1,4,4),(2,2,2),(2,2,2),(2,2,3),(2,2,3),(2,2,3)]
for i in range(16):
    for j in range(6):
        s.add(a[i][j]>=0)
        s.add(a[i][j]<=5)
    s.add(Or(Or(And(And(a[i][4]-a[i][1]==b[i][2],a[i][5]-a[i][2]==b[i][0]),a[i][3]-a[i][0]==b[i][1]),And(And(a[i][4]-a[i][1]==b[i][2],a[i][5]-a[i][2]==b[i][1]),a[i][3]-a[i][0]==b[i][0])),Or(Or(And(And(a[i][4]-a[i][1]==b[i][1],a[i][5]-a[i][2]==b[i][0]),a[i][3]-a[i][0]==b[i][2]),And(And(a[i][4]-a[i][1]==b[i][1],a[i][5]-a[i][2]==b[i][2]),a[i][3]-a[i][0]==b[i][0])),Or(And(And(a[i][4]-a[i][1]==b[i][0],a[i][5]-a[i][2]==b[i][2]),a[i][3]-a[i][0]==b[i][1]),And(And(a[i][4]-a[i][1]==b[i][0],a[i][5]-a[i][2]==b[i][1]),a[i][3]-a[i][0]==b[i][2])))))
for i in range(16):
    for j in range(i+1,16):
        s.add(Or(Or(a[i][2]>=a[j][5],a[j][2]>=a[i][5]),Or(Or(a[i][1]>=a[j][4],a[j][1]>=a[i][4]),Or(a[i][0]>=a[j][3],a[j][0]>=a[i][3]))))
while s.check()==sat:
    x=s.model()
    xx=[]
    for i in range(16):
        xx.append([[x[a[i][0]],x[a[i][3]],-1],[x[a[i][1]],x[a[i][4]],-1],[x[a[i][2]],x[a[i][5]],-1]])
    xxx=[[[int(str(xx[i][j][k])) for k in range(3)] for j in range(3)] for i in range(16)]
    xx=sorted(xxx)
    score=len(set((x, y, z) for i in range(16) for x, y, z in itertools.product(*xxx[i])))
    #print(xxx)
    print(score)
    if score<=156:
        q=True
        for i in range(16):
            for j in range(6):
                t=int(str(x[a[i][j]]))
                q=And(q,a[i][j]==t)
        s.add(Not(q))
    else:
        print(xx)
        break
```

å½“æˆ‘æŠŠè¿™é¢˜åšå®Œæ‹¿åˆ°flagçš„æ—¶å€™ï¼Œå‘çŽ°flagä¸Šåˆ†åˆ«å†™ç€googleã€dfsã€knuthsï¼Œæœ‰è¶£çš„æ˜¯åšè¿™é¢˜æˆ‘ä¸€ä¸ªéƒ½æ²¡ç”¨ï¼Œä¹ã€‚

### ä¸å¯åŠ å¯†çš„å¼‚ä¸–ç•Œ 2

è¯»äº†åŠå¤©ä»£ç ç„¶åŽè§£äº†åŠå¤©é«˜ä»£é¢˜ï¼Œ~~å¤§ä¸€æ‘¸é±¼çš„æ€»æ˜¯è¦è¿˜çš„.jpg~~

```msg```å’Œ```flag```æ˜¯128\*1å‘é‡ï¼Œ```key```æ˜¯æ»¡ç§©çš„128\*128çŸ©é˜µï¼Œå¯¹æ¯ä¸€ä¸ªè¾“å…¥```msg```ä¼šè¿”å›ž```key*(msg^flag)```ï¼Œè€Œ```flag```çš„æ¯ä¸ªå­—ç¬¦éƒ½æ˜¯```printable```çš„ï¼Œæ‰€ä»¥éƒ½<128ï¼Œå› æ­¤è®©```msg```ä¸­æŸä¸€é¡¹+128å°±èƒ½å‡ä¸€ä¸‹èŽ·å¾—keyçš„ä¸€ä¸ªåˆ—å‘é‡ã€‚

è¿™é¢˜è¿˜æœ‰ä¸€ä¸ªå‘ç‚¹åœ¨äºŽ0å’Œ256éƒ½ä¼šè¿”å›žä¸º0ï¼Œæ‰€ä»¥è¦å¤šå¥—å‡ ä¸ª```msg```æ¥ç¡®å®šåˆ°åº•æ˜¯0è¿˜æ˜¯256ï¼Œæˆ‘åªå¥—äº†ä¸¤å±‚æ‰€ä»¥ä¾ç„¶ä¸èƒ½ä¿è¯å”¯ä¸€ç¡®å®šï¼Œä½†æ˜¯åæ­£åªè¦æ‹¿åˆ°```flag```å°±è¡Œï¼Œå¤§ä¸äº†å¤šè·‘å‡ éï¼ˆ

ç¬¬äºŒé—®è¦æ±‚```key-I```çš„é›¶å‘é‡ï¼Œç®€å•é«˜æ–¯æ¶ˆå…ƒç„¶åŽéšä¾¿ä»£ä¸ªå€¼å°±è¡Œ

æˆ‘æœ¬ä»¥ä¸ºç¬¬ä¸‰é—®ä¹Ÿæ˜¯éšæ‰‹åšï¼Œç›´åˆ°æˆ‘å†ä¸€æ¬¡åŠ¨æ‰‹å†™z3-solverç„¶åŽå‘çŽ°solverç›´æŽ¥åŽŸåœ°å®•æœº ~~ï¼ˆæˆ‘è‡³ä»Šä»æœªå¾—çŸ¥åˆ°åº•æ˜¯çœŸè·‘ä¸åŠ¨è¿˜æ˜¯ä»£ç å†™é”™äº†ï¼‰~~ï¼Œéšæœºé€‰åªæœ‰0.5^64çš„æ¦‚çŽ‡æˆ‘è¿˜æ˜¯è·‘äº†ç®—äº†ï¼ˆ

### æ€»ç»“

![Alt text](img/image-25.png)

0åŸºç¡€ï¼ˆï¼Ÿï¼‰èŒæ–°çš„ç¬¬ä¸€æ¬¡ctfï¼Œåšäº†å¾ˆå¤šæœç´¢é¢˜ï¼ˆgeneralï¼‰ï¼Œä¸€äº›ç®€å•webé¢˜ï¼Œä¸€äº›æ•°å­¦é¢˜å’Œä¸€ä¸ªMindustryé¢˜ï¼ˆ

æ€»çš„æ¥è¯´è¿™æ¬¡ä½“éªŒè¿˜æ˜¯æ¯”è¾ƒå¥‡æ€ªçš„ï¼Œç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯â€œè¿™ä¹Ÿæ˜¯ctfï¼Ÿâ€ä¹‹ç±»çš„ï¼Œä¸¾å‡ ä¸ªä¾‹å­å°±æ¯”å¦‚è™«ï¼Œå¼‚æ˜Ÿæ­§é€”å’Œå°zçš„è°œé¢˜ï¼Œæ„Ÿè§‰æ›´åƒæ˜¯ä¼šå‡ºçŽ°åœ¨puzzlehuntå’Œacmé‡Œçš„é¢˜ç›®ã€‚ä¸ç®¡æ€Žä¹ˆæ ·ï¼Œè¿™æ¬¡æ¯”èµ›è®©æˆ‘çŸ¥é“äº†ctfå¤§æ¦‚ä¼šè€ƒäº›ä»€ä¹ˆï¼Œä¹‹åŽä¼°è®¡ä¹Ÿè¦å¾€webå’Œé€†å‘è¿™äº›æ–¹å‘ç ”ç©¶ä¸€ä¸‹ï¼Œæ‰©å……è‡ªå·±çš„çŸ¥è¯†é¢ã€‚ç„¶åŽæ‹¿ç¾¤å‹çš„ä¸€å¥è¯æ”¶å°¾ï¼š

![Alt text](img/image-24.png)