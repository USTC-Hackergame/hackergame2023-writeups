### 0x0 å‰è¨€

æœ¬æ–‡åŒæ—¶å‘å¸ƒåœ¨åšå®¢ [è®°å½•Hackergame 2023å‚ä¸ç»å† - æ˜Ÿ (hoshi.tech)](https://blog.hoshi.tech/archives/161/) ï¼Œåç»­å¦‚æœ‰é”™æ¼ä¿®å¤ç­‰ä¼šæ›´æ–°è‡³åšå®¢ï¼Œæ¬¢è¿`IP+1`ã€‚

è¿™æ¬¡`HG`åˆšå¥½èµ¶ä¸Šå…¬å…±å‡æœŸï¼Œæœ‰æ—¶é—´ç ”ç©¶ï¼Œæ¯”å»å¹´è¦å¥½å¤šäº†ï¼Œä½†ä¹Ÿå‘ç°åŸæ¥`HG`è¿™ä¹ˆå·ã€‚å‡Œæ™¨3,4,5ç‚¹éƒ½æœ‰äººæäº¤`flag`ï¼Œéº»äº†ã€‚



## 0x1 é¢˜ç›®

#### Hackergame å¯åŠ¨

> å¤§å£°å–Šå‡º Hackergame å¯åŠ¨ï¼Œå¼€å§‹ä»Šå¹´çš„å†’é™©ï¼

å¥½æ´»ç­¾åˆ°ï¼ŒHackergameï¼Œå¯åŠ¨ï¼è·Ÿå†å¹´è§£é¢˜æ€è·¯ä¸€è‡´ï¼Œæäº¤åä¿®æ”¹URLä¸­çš„`?similarity=100`å³å¯ã€‚

<img src="./img/HG_start.png" alt="HG_start" style="zoom:80%;" />

`flag{wE1CoMe-TO-hACkergAme-@nD-3nJOY-hAcKIN9-zoZ3}`

#### çŒ«å’ªå°æµ‹

> æ³¨æ„çœ‹ï¼Œè¿™åªå¯çˆ±çš„æ©™çŒ«çŒ«å«å°å–µã€‚
>
> åªè¦æœ‰é˜³å…‰çš„åœ°æ–¹å°±èƒ½è§åˆ°å®ƒçš„èº«å½±ï¼Œåªè¦æœ‰é±¼å¹²çš„åœ°æ–¹å°±èƒ½å¬åˆ°å®ƒçš„å–µå£°ã€‚ä½†ä»Šå¤©çš„å°å–µæœ‰äº›ä¸åŒï¼Œå®ƒçš„çœ¼ç¥å……æ»¡äº†ç´§å¼ ä¸æœŸå¾…ï¼Œå› ä¸ºä¸€å¹´ä¸€åº¦çš„é£äº‘é™…ä¼šï¼Œå¤§å¸ˆå–µä¸»åŠçš„å…¨æ ¡çŒ«å’ªå°æµ‹é©¬ä¸Šå°±è¦å¼€å§‹äº†ã€‚
>
> ã€Œåœ¨ç§‘å¤§ï¼Œå³ä½¿èº«ä¸ºçŒ«å’ªï¼Œä¹Ÿè¦å…¼å¤‡å……åˆ†çš„ç§‘å¤§å¸¸è¯†ã€æ‰å®çš„æ•°ç†åŸºç¡€ã€ä»¥åŠç‹¬ç«‹çš„ç§‘ç ”èƒ½åŠ›ã€å¤§å¸ˆå–µè¹²ååœ¨ä¸»å¸­å°ä¸Šï¼Œç›®å…‰ç‚¯ç‚¯ã€‚
>
> å°å–µä¹–å·§åœ°ååœ¨è¯¾æ¡Œå‰ï¼Œçˆªå­ç´§æŒ‰ç€ç”¨æ¥ç­”é¢˜çš„é¼ æ ‡ï¼Œä¼¼ä¹ä¸€æ¾å¼€é¼ æ ‡å°±ä¼šè‡ªå·±æºœèµ°ä¸€æ ·ã€‚
>
> ä¸å¾—ä¸æ‰¿è®¤ï¼Œè¿™åœºå°æµ‹å¹¶ä¸å®¹æ˜“ã€‚
>
> ã€Œç”Ÿè€Œä¸ºçŒ«ï¼Œæˆ‘å¾ˆæŠ±æ­‰ã€
>
> åæ’ä¼ æ¥äº†ä¸€å£°æ²®ä¸§è€Œè¿‘ä¹ç»æœ›çš„å‘œå’½ï¼Œåº”è¯¥æ˜¯ä»Šå¹´åˆšå…¥æ ¡çš„å°‘å¹´å–µã€‚æœ¬å°±æœ‰ç€æ¯”ä¼—å–µæ›´å°çš„å¹´é¾„ï¼Œå…¶å½“å¹´è¶³å¯å¼•ä»¥ä¸ºå‚²çš„å¤©èµ‹åœ¨ç§‘å¤§é‡Œå´ä¹Ÿç®—ä¸ä¸Šä»€ä¹ˆï¼Œäºæ˜¯æ¯æ¬¡æµ‹éªŒéƒ½åªèƒ½ä½å±…æœ«æµã€‚
>
> å°å–µè¿˜æ²¡æ¥å¾—åŠå›å¤´ï¼Œå¤§å¸ˆå–µã€Œå™Œã€åœ°ä¸€ä¸‹ä»è®²å°ä¸Šè…¾è·ƒè€Œä¸‹ï¼Œæ‰‘åˆ°åæ’é‚£åçŒ«å’ªçš„èº«å‰ï¼Œç”¨èˆŒå¤´ç»†ç»†æ¢³ç†è¿™åçŒ«å’ªçš„åé¢ˆä¸Šçš„ç»’æ¯›ã€‚
>
> ã€Œä¸å¯ä»¥è¿™æ ·è¯´å“¦ï¼Œé™å¿ƒåŠªåŠ›ä½ ä¹Ÿå¯ä»¥åšå‡ºæ¥çš„å–µ~ã€
>
> å•Šï¼Œå¤§å¸ˆå–µé‚£ä¸€å¦‚æ—¢å¾€çš„æ¸©æŸ”ã€‚
>
> å°‘å¹´å–µéå¸¸æ„ŸåŠ¨ã€‚ã€Œå—¯å—¯æˆ‘æ˜ç™½äº†ã€‚ãã‚Œãªã‚‰åˆ¥ã®è¨€ã„æ–¹ã‚’ã—ã‚ˆã†ï¼šçŒ«ã¨ã—ã¦ç”Ÿã¾ã‚Œã¦ã€ã™ã¿ã¾ã›ã‚“ã€
>
> ã€Œç»™æˆ‘å¥½å¥½åšé¢˜ï¼ˆæ•²ï¼‰ï¼Œä¸æ˜¯è¦ä½ æ¢ä¸€ç§è¯­è¨€å†è¯´ä¸€éå•Šï¼ˆkusaï¼‰ã€
>
> ã€Œä¸æ„§æ˜¯å¤§å¸ˆå–µã€ï¼Œå°å–µé’¦ä½©åœ°æœ›ç€å¤§å¸ˆå–µçš„èº«å½±ã€‚
>
> ã€Œè¿™ç§è¯´è¯è¿˜èƒ½å¸¦æ‹¬å·çš„æŠ€å·§æˆ‘ä¹Ÿæƒ³å­¦ï¼ã€
>
> æç¤ºï¼š**è§£å‡ºè°œé¢˜ä¸éœ€è¦æ˜¯ç§‘å¤§åœ¨æ ¡çŒ«å’ª**ã€‚è§£é¢˜é‡åˆ°å›°éš¾ï¼Ÿä½ å¯ä»¥å‚è€ƒä»¥ä¸‹é¢˜è§£ï¼š
>
> - [2018 å¹´çŒ«å’ªé—®ç­”é¢˜è§£](https://github.com/ustclug/hackergame2018-writeups/blob/master/official/ustcquiz/README.md)
> - [2020 å¹´çŒ«å’ªé—®ç­”++ é¢˜è§£](https://github.com/USTC-Hackergame/hackergame2020-writeups/blob/master/official/çŒ«å’ªé—®ç­”++/README.md)
> - [2021 å¹´çŒ«å’ªé—®ç­” Pro Max é¢˜è§£](https://github.com/USTC-Hackergame/hackergame2021-writeups/blob/master/official/çŒ«å’ªé—®ç­” Pro Max/README.md)
> - [2022 å¹´çŒ«å’ªé—®ç­”å–µé¢˜è§£](https://github.com/USTC-Hackergame/hackergame2022-writeups/blob/master/official/çŒ«å’ªé—®ç­”å–µ/README.md)



å‚è€ƒå†å¹´é¢˜ç›®ï¼Œè€ƒå¯Ÿä¿¡æ¯æœç´¢èƒ½åŠ›ã€‚æ„Ÿè§‰ä»Šå¹´é¢˜ç›®æ¯”å»å¹´è¦ç®€å•äº›ã€‚

> æƒ³è¦å€Ÿé˜…ä¸–ç•Œå›¾ä¹¦å‡ºç‰ˆå…¬å¸å‡ºç‰ˆçš„ã€ŠA Classical Introduction To Modern Number Theory 2nd ed.ã€‹ï¼Œåº”å½“å‰å¾€ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦è¥¿åŒºå›¾ä¹¦é¦†çš„å“ªä¸€å±‚ï¼Ÿ

Googleæœç´¢`ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ "è¥¿åŒºå›¾ä¹¦é¦†"`å¾—åˆ°ä¸€ç¯‡è¥¿åŒºå›¾ä¹¦é¦†ç®€ä»‹ï¼Œå¯ä»¥çœ‹åˆ°å¤–æ–‡ä¹¦åº“ä½äº12æ¥¼ã€‚

> ä»Šå¹´ arXiv ç½‘ç«™çš„å¤©ä½“ç‰©ç†ç‰ˆå—ä¸Šæœ‰äººå‘è¡¨äº†ä¸€ç¯‡å…³äºã€Œå¯è§‚æµ‹å®‡å®™ä¸­çš„é¸¡çš„å¯†åº¦ä¸Šé™ã€çš„è®ºæ–‡ï¼Œè¯·é—®è®ºæ–‡ä¸­ä½œè€…è®¡ç®—å‡ºçš„é¸¡å¯†åº¦å‡½æ•°çš„ä¸Šé™ä¸º 10 çš„å¤šå°‘æ¬¡æ–¹æ¯ç«‹æ–¹ç§’å·®è·ï¼Ÿ

Google `arXiv  å¯è§‚æµ‹å®‡å®™ä¸­çš„é¸¡çš„å¯†åº¦ä¸Šé™` ä¸€ç¯‡çŸ¥ä¹é—®é¢˜`ä½ è§è¿‡å“ªäº›æå“è®ºæ–‡ï¼Ÿ`çš„å›ç­”ï¼Œå…¶ä¸­å¯çœ‹åˆ°ç­”æ¡ˆä¸º23ã€‚

> ä¸ºäº†æ”¯æŒ TCP BBR æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œåœ¨ç¼–è¯‘ Linux å†…æ ¸æ—¶åº”è¯¥é…ç½®å¥½å“ªä¸€æ¡å†…æ ¸é€‰é¡¹ï¼Ÿ

Google `linux ç¼–è¯‘ bbr config`æŸ¥çœ‹å„è·¯å¤§ç¥çš„ç¼–è¯‘æ•™ç¨‹ï¼Œå¯å¾—ç­”æ¡ˆä¸º`CONFIG_TCP_CONG_BBR`ã€‚

> ğŸ¥’ğŸ¥’ğŸ¥’ï¼šã€Œæˆ‘â€¦â€¦ä»æ²¡è§‰å¾—å†™ç±»å‹æ ‡æ³¨æœ‰æ„æ€è¿‡ã€ã€‚åœ¨ä¸€ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…ç»™å‡ºäº†èƒ½å¤Ÿè®© Python çš„ç±»å‹æ£€æŸ¥å™¨ MyPY mypy é™·å…¥æ­»å¾ªç¯çš„ä»£ç ï¼Œå¹¶è¯æ˜ Python çš„ç±»å‹æ£€æŸ¥å’Œåœæœºé—®é¢˜ä¸€æ ·å›°éš¾ã€‚è¯·é—®è¿™ç¯‡è®ºæ–‡å‘è¡¨åœ¨ä»Šå¹´çš„å“ªä¸ªå­¦æœ¯ä¼šè®®ä¸Šï¼Ÿ

Googleæœç´¢`Python mypy infinite loop pdf`å¯å¾—ä¸€ç¯‡è®ºæ–‡åä¸º`Python Type Hints Are Turing Complete`ï¼Œå…¶ä¸­è§’æ ‡Logoä¸º`ECOOP 2023`ï¼Œ`ECOOP`å³ä¸ºç­”æ¡ˆã€‚


flag1ï¼š`flag{W3lc0m3-to-4tTENd-7hE-neko-3Xam-Zoz3}`

flag2ï¼š`flag{r3Al-m4s73r-oF-the-NeK0-exaM-1n-uStc}`

#### æ›´æ·±æ›´æš—

> å° E æ­£åœ¨æ”¶çœ‹ç”µè§†æ–°é—»ã€‚
>
> ã€Œè¯¶ï¼Œä½ çŸ¥é“å—ï¼Œã€æ³°å¦ã€å·æ½œæ°´è‰‡å¤±äº‹äº†ï¼ã€å° E å¯¹æ—è¾¹çš„å° C è¯´ã€‚
>
> å° C å‡‘è¿‘ç”µè§†æœºï¼Œçœ‹äº†ä¸€çœ¼æ–°é—»é‡Œçš„ç”»é¢ã€‚
>
> ã€Œæ˜¯æˆ‘çœ¼èŠ±äº†å—ï¼Ÿæˆ‘åˆšåˆšæœ‰ä¸€ç¬é—´å¥½åƒåœ¨æ®‹éª¸ä¸Šçœ‹åˆ°äº†ä¸€ä¸ª flagï¼Ÿã€å° C æƒŠè®¶åœ°è¯´ã€‚
>
> ã€Œç© CTF ç©çš„ã€‚ã€å° E å¯¹æ­¤ä¸ä»¥ä¸ºç„¶ï¼Œã€Œä¸€å®šæ˜¯ä½ çœ‹é”™äº†ã€‚ã€
>
> å° C å´ååˆ†ç›¸ä¿¡è‡ªå·±æ²¡æœ‰çœ‹é”™ã€‚

æ‰“å¼€F12ï¼ŒæŸ¥çœ‹`main.js`ï¼Œå¯ä»¥çœ‹åˆ°Flagç®—æ³•æ˜æ™ƒæ™ƒçš„å†™åœ¨å…¶ä¸­ã€‚
```js
let token = params.get('token') || localStorage.getItem('token');

async function getFlag(token) {
    // Generate the flag based on user's token
    let hash = CryptoJS.SHA256(`dEEper_@nd_d@rKer_${token}`).toString();
    return `flag{T1t@n_${hash.slice(0, 32)}}`;
}
```
åœ¨æ§åˆ¶å°ä¸­æ‰§è¡Œ
```js
let hash = CryptoJS.SHA256(`dEEper_@nd_d@rKer_${localStorage.getItem('token')}`).toString();
console.log(`flag{T1t@n_${hash.slice(0, 32)}}`);
```
å³å¯è·å¾—ç»“æœã€‚

`flag{T1t@n_xxxxxxxxxx}`

#### æ—…è¡Œç…§ç‰‡ 3.0

> ä½ çš„å­¦é•¿å»ç•™å­¦äº†ï¼Œè¿™ä¸€èµ°çŸ­æ—¶é—´å†…æ€•æ˜¯å›ä¸æ¥äº†ã€‚äºæ˜¯ï¼Œä½ åœ¨ä»Šå¹´æš‘å‡æ¥äº†ä¸€åœºè®¡åˆ’å·²ä¹…çš„æ—…è¡Œï¼Œå¹¶é¡ºè·¯æ¢æœ›äº†è¿™ä½ä¹…åˆ«çš„å­¦é•¿ã€‚ç¿»é˜…å½“å¤©æ‹ä¸‹çš„ç…§ç‰‡ï¼Œç§ç§å›å¿†å’Œæ„Ÿæ…¨æ²¹ç„¶è€Œç”Ÿã€‚
>
> è¯·è§‚å¯Ÿç…§ç‰‡å¹¶ç»“åˆæ‰€æœ‰æ–‡å­—å†…å®¹ï¼Œæ­£ç¡®å›ç­”é¢˜ç›®ä»¥è·å– flagã€‚

çº¿ç´¢ï¼š
1. Googleè¯†å›¾è¿™æšå¥–ç‰Œå¯çŸ¥å…¶ä¸º`è¯ºè´å°”ç‰©ç†/åŒ–å­¦å¥–å¥–ç‰Œ`ã€‚
2. å›¾äºŒé¤ç‰Œä¸Šå†™ç€`ã‚‰ãƒ¼ã‚ã‚“ ä¸€ä¿¡`ï¼Œæœç´¢å¯ä»¥å‘ç°å…¨æ—¥åªæœ‰ä¸€å®¶åº—ï¼Œé™„è¿‘å¤§å­¦ä¸º`ä¸œäº¬å¤§å­¦`ã€‚
3. å›¾äºŒç…§ç‰‡ä¸­å­¦é•¿æˆ´ç€çš„èº«ä»½ç‰Œç»³ä¸Šå†™ç€`STATPHYS28`ï¼Œè°·æ­Œæœç´¢å¯çŸ¥æ—¥æœŸä¸º`2023å¹´8æœˆ7æ—¥`è‡³`2023å¹´8æœˆ11æ—¥`ä¹‹é—´ã€‚
4. æ®æè¿°å¯å›¾ä¸‰ä¸ºåšç‰©é¦†å‰æ‹æ‘„ã€‚Googleè¯†å›¾å›¾ä¸‰å¾—çŸ¥è¿™æ˜¯`ä¸Šé‡å…¬å›­`ï¼Œåšç‰©é¦†ä¸º`ä¸œäº¬å›½ç«‹åšç‰©é¦†`ã€‚![Google_image](./img/Google_image.png)
	1. ~~Googleæœç´¢`tokyo national museum 2023 08 07`å¯ä»¥æ‰¾åˆ°åšç‰©é¦†å®˜æ–¹çš„æ´»åŠ¨æ’æœŸç½‘ç«™[TOKYO NATIONAL MUSEUM - Exhibitions and Events What's on today: August 7, 2023 (Mon) (tnm.jp)](https://www.tnm.jp/modules/r_calender/index.php?date=2023-08-07)ã€‚~~
	2. ~~å‘ç°åœ¨è¿™æœŸé—´çš„ç‰¹åˆ«æ´»åŠ¨æ˜¯`å¤ä»£ãƒ¡ã‚­ã‚·ã‚³å±• - Ancient Mexico: Maya, Aztec, and Teotihuacan`ã€‚æ´»åŠ¨ç½‘ç«™ä¸º[ç‰¹åˆ¥å±•ã€Œå¤ä»£ãƒ¡ã‚­ã‚·ã‚³ã€ å…¬å¼ã‚µã‚¤ãƒˆ (exhibit.jp)](https://mexico2023.exhibit.jp/)~~
	3. ~~8æœˆ7æ—¥è¿™å¤©è¿˜æ˜¯å„¿ç«¥èŠ‚æ´»åŠ¨ã€‚`å¤ä»£ãƒ¡ã‚­ã‚·ã‚³å±• ã€Œã“ã©ã‚‚ã®æ—¥ã€`ã€‚[ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆæ±äº¬ä¼šå ´ï¼‰/ ç‰¹åˆ¥å±• å¤ä»£ãƒ¡ã‚­ã‚·ã‚³ (exhibit.jp)](https://mexico2023.exhibit.jp/program-event/)~~
	4. ~~å®˜æ–¹ç½‘ç«™å¯ä»¥çœ‹åˆ°ä¸œäº¬ä¼šåœºå¤§å­¦ç”Ÿç¥¨ä»·ä¸º`1400`æ—¥å…ƒã€‚[ãƒã‚±ãƒƒãƒˆï¼ˆæ±äº¬ä¼šå ´ï¼‰ / ç‰¹åˆ¥å±• å¤ä»£ãƒ¡ã‚­ã‚·ã‚³ (exhibit.jp)](https://mexico2023.exhibit.jp/tickets) æˆ– [TOKYO NATIONAL MUSEUM - Exhibitions and Events Regular Exhibitions Japanese Archaeology and Special Exhibition (Heiseikan) Ancient Mexico: Maya, Aztec, and Teotihuacan (tnm.jp)](https://www.tnm.jp/modules/r_free_page/index.php?id=2565&lang=en)~~
5. Googleåœ°å›¾ä¸ŠæŸ¥çœ‹åšç‰©é¦†é™„è¿‘å¤§å­¦å¯ä»¥æ‰¾åˆ°`ä¸œäº¬è‰ºæœ¯å¤§å­¦`ï¼Œ`ä¸œäº¬å¤§å­¦`ã€‚è·ç¦»æ‹‰é¢é¦†æœ€è¿‘çš„å¤§å­¦æ¨æµ‹ä¸º`ä¸œäº¬å¤§å­¦`ã€‚



##### é¢˜ç›® 1-2

> ä½ è¿˜è®°å¾—ä¸å­¦é•¿è§é¢è¿™å¤©æ˜¯å“ªä¸€å¤©å—ï¼Ÿï¼ˆæ ¼å¼ï¼šyyyy-mm-ddï¼‰

çº¿ç´¢3ã€‚ç­”æ¡ˆèŒƒå›´ä¸º`2023-08-07`è‡³`2023-08-11`ï¼Œç©·ä¸¾å¾—åˆ°`2023-08-10`ã€‚

> åœ¨å­¦æ ¡è¯¥å±•å…å±•ç¤ºçš„æ‰€æœ‰åŒç§é‡‘è‰²å¥–ç‰Œçš„å¾—ä¸»ä¸­ï¼Œå‡ºç”Ÿæœ€æ™šè€…è·å¥–æ—¶æ‰€åœ¨çš„ç ”ç©¶æ‰€ç¼©å†™æ˜¯ä»€ä¹ˆï¼Ÿ

çº¿ç´¢1, 2, 5ã€‚

Googleæœç´¢`tokyo university nobel prize`å¯ä»¥æ‰¾åˆ°ä¸œäº¬å¤§å­¦å®˜æ–¹å…³äºæ ¡å†…è¯ºè´å°”å¥–çš„ä»‹ç»ã€‚[UTokyo and the Nobel Prize: A Look Back at the Achievements of Our Alumni Nobel Laureates, in their Own Words | The University of Tokyo (u-tokyo.ac.jp)](https://www.u-tokyo.ac.jp/en/whyutokyo/indpt_utokyo_nobel_017.html)

è¸©å‘æ‰¾åˆ°è¯ºè´å°”ç‰©ç†/åŒ–å­¦å¥–å¾—ä¸»ä¸­å‡ºç”Ÿæœ€æ™šçš„æ˜¯`Ei-ichi Negishi æ ¹å²¸è‹±ä¸€`ã€‚ç»“æœä¸å¯¹ï¼Œé¢˜ç›®è¦æ±‚çš„æ˜¯`è¯¥å±•å…å±•ç¤ºçš„`ã€‚

é‡æ–°æœç´¢å…³é”®è¯`university of tokyo nobel prize exhibits`æ‰¾åˆ°[Nobel Prize (u-tokyo.ac.jp)](https://www.s.u-tokyo.ac.jp/en/gallery/nobelprize/)ã€‚å…¶ä¸­å¯çœ‹åˆ°å‡ºç”Ÿæœ€æ™šçš„æ˜¯`Takaaki Kajita æ¢¶ç”°éš†ç« `ã€‚

æè¿°ä¸­æåˆ°ä»–æ‰€å±`Institute for Cosmic Radiation Research at the University of Tokyo`ã€‚Googleæœç´¢å¯å¾—ç­”æ¡ˆä¸º`ICRR`



` flag{how_I_wi5h_i_COulD_w1N_A_Nobe1_pri23_80459bbac7}`



##### é¢˜ç›® 3-4

> å¸ç¯·ä¸­æ´»åŠ¨æ‹›å‹Ÿå¿—æ„¿è€…æ—¶ç”¨äºæ”¶é›†æŠ¥åä¿¡æ¯çš„åœ¨çº¿é—®å·çš„ç¼–å·ï¼ˆä»¥å­—æ¯ S å¼€å¤´åæ¥æ•°å­—ï¼‰æ˜¯å¤šå°‘ï¼Ÿ

è¸©å®Œçº¿ç´¢4é‡Œçš„å‘ï¼Œè§£å®Œé¢˜ç›®1-2ï¼Œæ¨ç‰¹æœç´¢`ä¸Šé‡å…¬åœ’ until:2023-08-11 since:2023-08-07`ã€‚å†åŠ ä¸Šé¢˜ç›®1ç©·å°½å‡ºçš„æ—¥æœŸæ—¥æœŸ8æœˆ10æ—¥ã€‚ç€é‡æŸ¥çœ‹å½“å¤©çš„æ¨æ–‡ï¼Œå¯ä»¥çœ‹åˆ°å½“å¤©çš„æ´»åŠ¨æ˜¯æ¢…é…’ç¥­[ X ä¸Šçš„ ã„ã¡ã”å¤§ç¦ï¼šâ€œä¸Šé‡å…¬åœ’ã®æ¢…é…’ç¥­ã‚Š](https://twitter.com/Daifukuchan_795/status/1689632319265816576)ã€‚![x_advance_search](./img/x_advance_search.png)

Googleæœç´¢`ä¸Šé‡å…¬åœ’ã®æ¢…é…’ç¥­ã‚Š`æ‰¾åˆ°å®˜æ–¹ç½‘ç«™è¯´æ˜[å…¨å›½æ¢…é…’ã¾ã¤ã‚Šinæ±äº¬2023ï½œå…¨å›½æ¢…é…’ã¾ã¤ã‚Š (umeshu-matsuri.jp)](https://umeshu-matsuri.jp/tokyo_ueno/)ã€‚

ä¸‹æ»‘åˆ°`ä¼šå ´æƒ…å ±`å¯ä»¥çœ‹åˆ°æ‹›å‹Ÿå·¥ä½œäººå‘˜çš„é“¾æ¥[ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢STAFFå¤§å‹Ÿé›†ï¼ï¼ç¬¬ï¼–å›ã€Œå…¨å›½æ¢…é…’ã¾ã¤ã‚Šinæ±äº¬2023ã€ï½œå…¨å›½æ¢…é…’ã¾ã¤ã‚Š (umeshu-matsuri.jp)](https://umeshu-matsuri.jp/tokyo_staff/)ã€‚

å…¶ä¸­å°±æœ‰å‹Ÿé›†è¡¨å•åœ°å€ï¼š[https://ws.formzu.net/fgen/S495584522/](https://ws.formzu.net/fgen/S495584522/)ã€‚æ‰€ä»¥ç­”æ¡ˆæ˜¯`S495584522`ã€‚

> å­¦é•¿è´­ä¹°è‡ªå·±çš„åšç‰©é¦†é—¨ç¥¨æ—¶ï¼ŒèŠ±è´¹äº†å¤šå°‘æ—¥å…ƒï¼Ÿ

çº¿ç´¢4è¸©å‘å‡ ä¸ªè¯•äº†éƒ½é”™è¯¯ï¼Œçªå‘å¥‡æƒ³å¡«äº†ä¸ª`0`å…ƒæ­£ç¡®äº†ã€‚ç„¶åæ‰¾äº†ä¸‹æ˜¯ä¸œäº¬å¤§å­¦å­¦ç”Ÿå‚åŠ å¸¸è§„å±•è§ˆæ— é™æ¬¡å…è´¹ï¼Œ[å›½ç«‹åšç‰©é¤¨ãƒ»ç¾è¡“é¤¨ã®åˆ©ç”¨ | æ±äº¬å¤§å­¦ (u-tokyo.ac.jp)](https://www.u-tokyo.ac.jp/ja/students/facility/h17.html)ã€‚

` flag{PluM_w1NE_1S_rEa1LY_EXpen5iVE_1680fe1496}`



##### é¢˜ç›® 5-6

> å­¦é•¿å½“å¤©æ™šä¸Šéœ€è¦åœ¨å“ªæ ‹æ ‡å¿—æ€§å»ºç­‘ç‰©çš„é™„è¿‘é›†åˆå‘¢ï¼Ÿï¼ˆè¯·ç”¨ç®€ä½“ä¸­æ–‡å›ç­”ï¼Œå››ä¸ªæ±‰å­—ï¼‰

è¸©[ä¹—èˆ¹å ´æ‰€ | æ±äº¬ãƒ»æ¨ªæµœã®è²¸åˆ‡ã‚¯ãƒ«ãƒ¼ã‚ºå°‚é–€ ãƒªãƒ¥ã‚¯ã‚¹ã‚¯ãƒ«ãƒ¼ã‚º (charter-cruiser.com)](https://www.charter-cruiser.com/boarding_area/#bdspot_591)

[ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ãƒ–ãƒªãƒƒã‚¸ | æ±äº¬ãƒ»æ¨ªæµœã®è²¸åˆ‡ã‚¯ãƒ«ãƒ¼ã‚ºå°‚é–€ ãƒªãƒ¥ã‚¯ã‚¹ã‚¯ãƒ«ãƒ¼ã‚º (charter-cruiser.com)](https://www.charter-cruiser.com/tokyo_cruise/29/)

è¿™é¢˜å„ç§å…³é”®è¯æœäº†å¿«ä¸€å¤©ï¼Œè¿˜æ˜¯æ²¡è§£å‡ºæ¥...

ä½†æˆ‘çŸ¥é“äº†èˆ¹æ¸¸ä¸œäº¬çš„æ–¹å¼ï¼Œå®¶äººä»¬ç§ç§ï¼š

- æœ‰ç°ä»£åŒ–ä¹˜èˆ¹ä½“éªŒçš„`TOKYO CRUISE`ï¼Œæµ…è‰ç å¤´ã€å¤©ç‹æ´²ç­‰å‡ºå‘ã€‚
- æœ‰é¤é¥®ä½“éªŒçš„æ™´æµ·å±‹å±‹å½¢èˆ¹ï¼Œå¾å¦»æ¡¥å‡ºå‘ã€‚
- æœ‰æ€€æ—§ä½“éªŒçš„æ±Ÿæˆ·å‰æ±½èˆ¹ï¼Œå“å·èˆ¹æ¸…å‡ºå‘ã€‚
- æœ‰å¤æ—¥ç¥­ä½“éªŒçš„ä¸œäº¬æ¹¾çº³å‡‰èˆ¹ï¼Œç«¹èŠç å¤´å‡ºå‘ã€‚
- æœ‰å…¬äº¤è½¦ä½“éªŒçš„`SKY Duck`å°åœºæˆ–æ™´ç©ºå¡”å‡ºå‘ã€‚
- æœ‰å…¬å›­ä½“éªŒçš„`TOKYO WATER TAXI`ï¼Œéšå¿ƒå‡ºå‘ã€‚

åæ¥æœ‰æƒ³åˆ°å¯èƒ½å’Œ`å­¦æœ¯ä¹‹æ—…`æœ‰å…³ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸œå¤§æœ‰å“ªäº›æ´»åŠ¨ï¼Œæš‚æ—¶å¼ƒäº†ã€‚



> è¿›ç«™æ—¶ï¼Œä½ åœ¨ JR ä¸Šé‡ç«™ä¸­å¤®æ£€ç¥¨å£å¤–çœ‹åˆ°ã€Œãƒœã‚¿ãƒ³ï¼†ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹ã€æ´»åŠ¨æ­£åœ¨é”€å”®åŠ¨ç‰©å‘¨è¾¹å•†å“ï¼Œè¯¥æ´»åŠ¨å¼ è´´çš„ç²‰è‰²èƒŒæ™¯æµ·æŠ¥ä¸Šæ˜¯ä»€ä¹ˆåŠ¨ç‰©ï¼ˆè®°ä½œ Aï¼Œä¸¤ä¸ªæ±‰å­—ï¼‰ï¼Ÿ åœ¨å‡ºç«™å¤„é™„è¿‘å»ºç­‘çš„å±‹é¡¶å¹¿å‘Šç‰Œä¸Šï¼Œæ¯å°æ—¶éƒ½ä¼šé¡½çš®å‡ºç°çš„é‚£åª 3D åŠ¨ç‰©æ˜¯ä»€ä¹ˆå“ç§ï¼Ÿï¼ˆè®°ä½œ Bï¼Œä¸‰ä¸ªæ±‰å­—ï¼‰ï¼Ÿï¼ˆæ ¼å¼ï¼šA-Bï¼‰

A: æ¨ç‰¹æœç´¢`ãƒœã‚¿ãƒ³ã‚¢ãƒ³ãƒ‰ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹`èƒ½æ‰¾åˆ°æ´»åŠ¨æµ·æŠ¥[(https://twitter.com/panda_life/status/1688436626895331328](https://twitter.com/panda_life/status/1688436626895331328)ã€‚åŠ¨ç‰©æ˜¯`ç†ŠçŒ«`ã€‚

B: Googleæœç´¢`JR ä¸Šé‡é§… `ã€‚ç¿»äº†ç¿»ç”¨æˆ·ç…§ç‰‡ï¼Œæ²¡æœ‰æ‰¾åˆ°å¹¿å‘Šç‰Œã€‚ç„¶åä»`æ­£é¢å£`è¿›è¡—æ™¯åœ°å›¾ï¼Œä¸€è·¯æ‰¾åˆ°`åºƒå°è·¯å£`ï¼Œå‘ç°è¿™é‡Œæ˜¯å¤šæ•°ç”¨æˆ·æ‹ç…§çš„å‡ºå…¥å£ã€‚å››å‘¨è§‚å¯Ÿäº†ä¸‹çœ‹åˆ°å‡ºå…¥å£æ­£å¯¹é¢æœ‰ä¸ªå°å‹LEDå¹¿å‘Šå±å¹•[ä¸­å¤®é€šã‚Š - Google åœ°å›¾](https://www.google.com/maps/@35.7115185,139.7754721,3a,56.1y,181.56h,117.49t/data=!3m9!1e1!3m7!1s1DUoglDttgi0ywl7eScVgQ!2e0!7i16384!8i8192!9m2!1b1!2i27?entry=ttu)ï¼Œä¸Šé¢å†™ç€`NAGATA`ã€‚![station_nagata_ad](./img/station_nagata_ad.png)

Googleå›¾ç‰‡æœç´¢å…³é”®è¯`ä¸Šé‡é§… NAGATA`ï¼Œç¬¬ä¸€ä¸ªç»“æœå°±æ˜¯[4æœˆ, 2022 - é•·ç”°åºƒå‘Š | LED COMMUNITY VISION (nagata-lcv.com)](https://nagata-lcv.com/2022/04/)ã€‚

è¿›å…¥æ–‡ç« [JRä¸Šé‡é§…åºƒå°è·¯å£å‰ã‚¹ãƒãƒ¼ãƒ„ã‚¸ãƒ¥ã‚¨ãƒ³å±‹ä¸Š - é•·ç”°åºƒå‘Š | LED COMMUNITY VISION (nagata-lcv.com)](https://nagata-lcv.com/jrä¸Šé‡é§…åºƒå°è·¯å£å‰ã‚¹ãƒãƒ¼ãƒ„ã‚¸ãƒ¥ã‚¨ãƒ³å±‹ä¸Š/)ï¼Œä¸‹ç¿»å†…å®¹éƒ¨åˆ†æœ‰ä¸ªYouTubeè§†é¢‘3DçŒ«å¤´é¹°å±•ç¤ºã€‚

çŒœæµ‹çŒ«å¤´é¹°å¯èƒ½å°±æ˜¯ä»–ä»¬å®¶å¹¿å‘Šå±çš„å›ºå®šå±•ç¤ºå†…å®¹äº†ã€‚

`ç†ŠçŒ«-çŒ«å¤´é¹°` çŒœå¯¹ä¸€åŠã€‚



#### èµ›åšäº•å­—æ£‹

> é‚£ä¸€å¹´çš„äººæœºå¤§æˆ˜ï¼Œæ˜¯ AlphaGo å¯¹é˜µæŸ¯æ´ï¼Œæœ€ç»ˆæ¯”åˆ† 3-0ã€‚å½“æ—¶æˆ‘çœ‹è§æŸ¯æ´é¢“ååœ¨æ¤…å­ä¸Šæ³£ä¸æˆå£°ï¼Œè¿™ä¸ªç”»é¢æˆ‘æ°¸ç”Ÿéš¾å¿˜ã€‚é‚£ä¸€åˆ»æˆ‘åœ¨æƒ³ï¼Œå¦‚æœæˆ‘èƒ½æˆä¸ºä¸€åæ£‹æ‰‹ï¼Œæˆ‘ä¸€å®šè¦èµ¢ä¸‹äººå·¥æ™ºèƒ½ã€‚å¦‚ä»Š AI å°±åœ¨çœ¼å‰ï¼Œæˆ‘å¿…é¡»è€ƒè™‘è¿™ä¼šä¸ä¼šæ˜¯æˆ‘æ­¤ç”Ÿä»…æœ‰çš„æœºä¼šã€‚é‡é“¸äººç±»å›´æ£‹è£å…‰ï¼Œæˆ‘è¾ˆä¹‰ä¸å®¹è¾ï¼
>
> â€¦â€¦
>
> ä½†æ˜¯å›´æ£‹å®åœ¨å¤ªéš¾äº†ï¼Œä½ å†³å®šå…ˆä»äº•å­—æ£‹å¼€å§‹ç»ƒä¹ ã€‚

F12çœ‹`script.js`å’Œæäº¤çš„æ•°æ®ï¼Œå¯å¾—çŸ¥æäº¤æ ¼å¼`{"x": "0","y": "0"}`ã€‚

é¦–å…ˆè¯•äº†è¯•æäº¤è¿‡ç•Œæ•°å€¼ï¼Œå‘ç°æ²¡ååº”ï¼Œç„¶åå°è¯•æŠŠ`x`æ”¹æˆ`0,1,2`è¿ç»­æäº¤å‘ç°æˆäº†ã€‚é‚£è¿™é¢˜å°±æ˜¯åªåšäº†å‰ç«¯æ ¡éªŒï¼Œæ²¡åšåç«¯æ ¡éªŒï¼ŒæŠŠå¯¹æ‰‹æ£‹å­è¦†ç›–äº†ã€‚



`flag{I_can_eat_your_pieces_707465548e}`

#### å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹

> ï¼ˆä»¥ä¸‹å†…å®¹ç”± GPT è¾…åŠ©ç¼–å†™ï¼Œå¦‚æœ‰é›·åŒçº¯å±å·§åˆï¼‰
>
> æ™´ç©ºä¸‡é‡Œçš„å‡æœŸç»ˆäºæ‹äº†æ‹ç¿…è†€é£æ¥äº†ã€‚å¯¹äºä¸€å¿ƒæƒ³æ‰”æ‰æ•™æã€ç ¸æ‰é—¹é’Ÿã€è·ƒå‘ä¸–ç•Œçš„ L åŒå­¦æ¥è¯´ï¼ŒæœŸå¾…äº†æ•´æ•´ä¸‰å¹´çš„è·¨å›½æ—…æ¸¸å¤§ä¸šç»ˆäºæ˜¯æ—¶å€™å¯åŠ¨äº†ï¼Œè¿˜èƒ½å·§å¦™åœ°é¡ºå¸¦ç€åšä¸ªç¾æ»¡çš„è€å‹è®°ã€‚
>
> å¯æ˜¯ï¼Œå“å“Ÿå–‚ï¼Œä»–åˆšè¸©ä¸Šæ³¢å…‰ç²¼ç²¼çš„é‡‘æ²™æµ·æ»©ï¼Œé‚£ä»–æœ€ç–¼çˆ±çš„åä¸ºæ‰‹æœºå°±è·Ÿç€æµ·é£ä¸€èµ·å»çº¦ä¼šäº†å¤§æµ·ï¼Œè¿ä»–çš„é’±åŒ…ä¹Ÿåœ¨è¿™åœºæœªçŸ¥æ¢ç´¢ä¹‹æ—…ä¸­ç¥ç§˜å¤±è¸ªã€‚
>
> ã€Œè¿™ä¸ªåœ°æ–¹æ€ä¹ˆè¿ä¸ªåä¸ºæ‰‹æœºéƒ½ä¸å–ã€‚è‹¥æ˜¯ä¹°ä¸ªè‹¹æœæ‰‹æœºï¼Œå¿ƒç–¼çš„æ˜¯å®ƒè¿ä¸ªå®ä½“ SIM å¡æ§½éƒ½è—èµ·æ¥äº†ï¼Œå›å›½è‚¯å®šæˆäº†ä¸ªå¤§æ‘†è®¾ã€‚ä¸å¦‚æ¥ä¸ª**è°·æ­Œçš„ã€äº²å„¿å­ã€**ï¼Ÿã€L åŒå­¦è¸Œèº‡æ»¡å¿—åœ°å˜€å’•é“ã€‚
>
> é‚£æ—¶ï¼Œåƒæ˜¯ä¸Šå¤©çš„å®‰æ’ï¼Œã€Œå’±è¿™å„¿æ­£å¥½æœ‰ä¸ª**è°·æ­Œã€äº²å„¿å­ã€**çš„è€æ‰‹æœºï¼Œä½ æ‹¿å»é€é¥å§ã€ã€‚
>
> L åŒå­¦æ»¡çœ¼æ˜Ÿå…‰åœ°æ¥è¿‡ï¼Œ**è¿ç³»ç»Ÿéƒ½æ²¡å¿ƒæ€å‡çº§**ï¼Œå°±å¼€å§‹ç–¯ç‹‚å®‰è£…é‚£ä¸ªä¹…é—»å¤§åçš„ GPT ç¨‹åºï¼Œç”šè‡³é›€è·ƒåœ°åœ¨ç¾¤é‡Œæ™’å‡ºä¸€å¼ è·Ÿ GPT å¯¹è¯çš„ç²¾å½©**æˆªå›¾**ï¼Œä¸€æ—¶é—´æˆä¸ºäº†ç¾¤é‡Œçš„ç„¦ç‚¹äººç‰©ã€‚

æå–é¢˜ç›®çš„åŠ ç²—éƒ¨åˆ†ä¿¡æ¯ï¼ŒGoogleæœç´¢`pixel æˆªå›¾ æ¼æ´`å¾—åˆ°æœ¬é¢˜åˆ©ç”¨æ¼æ´ä¸º`Acropalypse`ã€‚

GitHubèƒ½æ‰¾åˆ°ä¸ªå·¥å…·[GitHub - frankthetank-music/Acropalypse-Multi-Tool: Easily detect and restore Acropalypse vulnerable PNG and GIF files with simple Python GUI.](https://github.com/frankthetank-music/Acropalypse-Multi-Tool)ã€‚

è·‘èµ·æ¥é€‰`Restoring Tool`ï¼Œä¸¢å›¾ç‰‡è¿›å»é€‰`Pixel`æ‰‹æœºè¿è¡Œå³å¯å‡ºç»“æœã€‚

<img src="./img/screenshot_restored.png" alt="screenshot_restored" style="zoom:50%;" />

`flag{sh1nj1ru_k0k0r0_4nata_m4h0}`

ã€Œ*ä¿¡ã˜ã‚‹å¿ƒãŒã‚ãªãŸã®é­”æ³•ã‚ˆ*ã€



#### ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨

> æ¯å¹´æ¯”èµ›ï¼Œç»„å§”ä¼šçš„ä¸€é¡¹é‡è¦å·¥ä½œå°±æ˜¯æ—¶åˆ»ç›¯ç€ç¾¤ï¼Œå¹¶ä¸”æ’¤å›å…¶ä¸­æœ‰ flag çš„æ¶ˆæ¯ã€‚ä»Šå¹´å› ä¸ºäººæ‰‹ç´§å¼ ï¼Œç»„å§”ä¼šçš„æŸååŒå­¦å°†è¿™é¡¹å·¥ä½œå¤–åŒ…ç»™äº†ä½ ï¼Œä½ éœ€è¦è¿ç»­å®¡æŸ¥ 1000 æ¡æ¶ˆæ¯ï¼Œå‡†ç¡®æ— è¯¯åœ°æ’¤å›å…¶ä¸­æ‰€æœ‰å« flag çš„æ¶ˆæ¯ï¼Œå¹¶ä¸”ä¸æ’¤å›ä»»ä½•ä¸å« flag çš„æ¶ˆæ¯ã€‚
>
> æœ¬é¢˜ä¸­ï¼Œä½ éœ€è¦æ’¤å›çš„ "flag" çš„æ ¼å¼ä¸º **`hack[...]`**ï¼Œå…¶ä¸­**æ–¹æ‹¬å·**å†…å‡ä¸ºå°å†™è‹±æ–‡å­—æ¯ï¼Œç‚¹å‡»æ¶ˆæ¯å³å¯æ’¤å›ã€‚ä½ éœ€è¦åœ¨ 3 ç§’å†…æ’¤å›æ¶ˆæ¯ï¼Œå¦åˆ™æ’¤å›æ“ä½œå°†å¤±è´¥ã€‚åœ¨å…¨éƒ¨æ¶ˆæ¯æ˜¾ç¤ºå®Œæˆåç­‰å¾…å‡ ç§’ï¼Œå¦‚æœä½ æ’¤å›çš„æ¶ˆæ¯å®Œå…¨æ­£ç¡®ï¼ˆæ’¤å›äº†å…¨éƒ¨éœ€è¦æ’¤å›çš„æ¶ˆæ¯ï¼Œå¹¶ä¸”æœªå°†ä¸éœ€è¦æ’¤å›çš„æ¶ˆæ¯æ’¤å›ï¼‰ï¼Œå°±èƒ½è·å¾—æœ¬é¢˜**çœŸæ­£çš„ flag**ã€‚

F12ï¼Œæ‰‹åŠ¨æ’¤å›å‡ æ¡æ¶ˆæ¯åæŸ¥çœ‹è¯·æ±‚å‘ç°å…±æœ‰3ä¸ªAPI
- `/api/getMessages`åŒ…å«å…¨é‡æ¶ˆæ¯ã€‚
- `/api/deleteMessage`æäº¤æ’¤å›çš„æ¶ˆæ¯IDï¼Œè¿”å›æ’¤å›ç»“æœã€‚
- `/api/getflag`æŒ‰æ—¶é—´å¾ªç¯å®Œå…¨éƒ¨æ¶ˆæ¯åè°ƒç”¨è·å–flagã€‚

è¯·æ±‚ä¸Šæ‰“æ–­ç‚¹èƒ½æº¯æºæ‰¾åˆ°æºç çš„ä½ç½®`QQChat.vue`ã€‚

```js
  created() {
    const urlParams = new URLSearchParams(window.location.search)
    axios
      .get('/api/checkToken', { params: urlParams })
      .then(() => {
        // æ¸…é™¤ URL æ çš„ query
        window.history.replaceState({}, '', '/')
        axios
          .post('/api/getMessages')
          .then((res) => {
            const data = res.data as BackendResponse

            const messages: BackendMessage[] = data.messages
            this.count = messages.length
            for (const message of messages) {
              this.timers.push(
                setTimeout(() => {
                  this.messages.push({
                    name: this.randomString(), // random username
                    message: message.text,
                    type: 'NormalMessage',
                  })
                  this.count = (this.count as number) - 1
                  // wait for DOM render
                  this.$nextTick(() => {
                    // try get fake container element and init onscroll event
                    if (!this.fakeContainerElement) {
                      this.fakeContainerElement = document.querySelector('.fakeqq-container')
                      if (this.fakeContainerElement) {
                        // init onscroll event only once
                        this.fakeContainerElement.onscroll = () => {
                          const offsetHeight = this.fakeContainerElement?.offsetHeight ?? 0
                          const scrollHeight = this.fakeContainerElement?.scrollHeight ?? 0
                          const scrollTop = this.fakeContainerElement?.scrollTop ?? 0
                          if (offsetHeight + scrollTop >= scrollHeight - 10) {
                            this.stopScroll = false
                          } else {
                            this.stopScroll = true
                          }
                        }
                      }
                    }
                    if (!this.stopScroll) {
                      this.currentScrollHeight = this.fakeContainerElement?.scrollHeight ?? 0
                      this.fakeContainerElement?.scrollTo(0, this.currentScrollHeight)
                    }
                  })
                }, message.delay * 1000)
              )
            }

            this.timers.push(
              setTimeout(() => {
                axios
                  .post('/api/getflag')
                  .then((res) => {
                    const data = res.data
                    if (data.success) {
                      alert('æ­å–œä½ ï¼Œflag æ˜¯ï¼š' + data.flag)
                    } else {
                      alert('è·å– flag å¤±è´¥ï¼ŒåŸå› ï¼š' + data.error)
                    }
                  })
                  .catch(() => {
                    alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·åˆ·æ–°é¡µé¢é‡æ–°å¼€å§‹')
                  })
              }, messages[messages.length - 1].delay * 1000 + 5000)
            )
          })
          .catch(() => {
            alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·åˆ·æ–°é¡µé¢é‡æ–°å¼€å§‹')
          })
      })
      .catch(() => {
        window.location.href = '/api/checkToken'
      })
  },
```



æœ‰ä¸¤ä¸ªè§£é¢˜æ€è·¯ï¼Œä¸€æ˜¯hookå‰ç«¯è°ƒç”¨æ’¤å›æ–¹æ³•å®ç°è‡ªåŠ¨æ’¤å›æ¶ˆæ¯ï¼ŒäºŒæ˜¯æ¨¡æ‹Ÿè¯·æ±‚ã€‚

è¿™é‡Œé€‰å–ç¬¬äºŒç§è¾ƒæ˜“å®ç°ï¼Œçœ‹æºç å¯ä»¥å‘ç°å°±æ˜¯ç®€å•çš„æ ¹æ®æœåŠ¡å™¨è¿”å›çš„`delay`å€¼`setTimeout()`å¾ªç¯ã€‚

ç­”æ¡ˆå®ç°ä»£ç ï¼š

```python
import requests
import re
import sys
from threading import Timer

BASE_URL = 'http://202.38.93.111:10021'
COOKIE = ''

headers = {
    'Connection': 'keep-alive',
    'Accept': '*/*',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36 Edg/95.0.1020.30',
    'X-Requested-With': 'XMLHttpRequest',
    'Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8,en-US;q=0.7,zh-TW;q=0.6',
    'Cookie': COOKIE
}


def set_time_out(fn, s, *args, **kwargs):
    t = Timer(s, fn, args=args, kwargs=kwargs)
    t.start()
    return t


def revoke_msg(msg_id, content):
    print(f'revoke msg {msg_id} {content}')
    res = requests.post(f'{BASE_URL}/api/deleteMessage', headers=headers, json={'id': msg_id})
    if '"success":true' not in res.text:
        print(res.text)
        sys.exit(1)


def get_flag():
    print(requests.post(f'{BASE_URL}/api/getflag', headers=headers).text)


msgs = requests.post(f'{BASE_URL}/api/getMessages', headers=headers).json()['messages']

i = 0
for m in msgs:
    regex = r'hack\[[a-z]+\]'
    if re.search(regex, m['text']):
        set_time_out(revoke_msg, m['delay'] + 0.5, i, m['text'])
    i += 1

set_time_out(get_flag, msgs[-1]['delay'] + 5)

```



`flag{Web_pr0gra_mm1ng_f1752a443c_15fun}`


#### è™«

> ã€Œç”Ÿè€Œä¸ºäººï¼Œåº”è¯¥èƒ½å¤Ÿæ¢å°¿å¸ƒã€ç­–åˆ’å…¥ä¾µã€æ€çŒªã€å¼€èˆ¹ã€é€ æˆ¿å­ã€å†™åå››è¡Œè¯—ã€ç®—è´¦ã€å»ºå¢™ã€æ­£éª¨ã€æŠšæ…°ä¸´ç»ˆä¹‹äººã€æ¥å—å‘½ä»¤ã€ä¸‹è¾¾å‘½ä»¤ã€åˆä½œã€ç‹¬è¡Œã€è§£å†³æ–¹ç¨‹å¼ã€åˆ†ææ–°é—®é¢˜ã€æ¸…ç†é©¬ç²ªã€ç¼–ç¨‹ã€çƒ¹é¥ªç¾é£Ÿã€é«˜æ•ˆæˆ˜æ–—ã€è‹±å‹‡ç‰ºç‰²ã€‚ä¸“ä¸šåˆ†å·¥æ˜¯ç»™æ˜†è™«å‡†å¤‡çš„ã€‚ã€â€”ç½—ä¼¯ç‰¹Â·æµ·è±æ©ï¼ˆRobert Heinleinï¼‰
>
> ä½ è§‰å¾—è¿˜æ˜¯å½“æ˜†è™«è½»æ¾ä¸€äº›ã€‚
>
> è¿™æ—¶ï¼Œä½ çœ‹åˆ°ä¸€åªæ˜†è™«è½åœ¨ä½ é¢å‰ï¼Œå‘å‡ºå¥‡æ€ªçš„å«å£°ã€‚ä½ æŠŠè¿™æ®µå£°éŸ³å½•åˆ¶äº†ä¸‹æ¥ï¼šè¿™å¬èµ·æ¥åƒæ˜¯ä¸€ç§**é€šè¿‡æ— çº¿ä¿¡é“ä¼ è¾“å›¾ç‰‡çš„æ–¹å¼**ï¼Œå¦‚æœç²¾é€šæ­¤é“ï¼Œæˆ–è®¸å°±å¯ä»¥æ¥æ”¶æ¥è‡ªå›½é™…ç©ºé—´ç«™ï¼ˆISSï¼‰çš„å›¾ç‰‡äº†ã€‚
>
> **[æ‰“å¼€/ä¸‹è½½é¢˜ç›®](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/official/è™«/files/insect.wav)**

æ ¹æ®é¢˜å¹²å…³é”®è¯æœç´¢`æ— çº¿ç”µä¼ è¾“å›¾ç‰‡ å›½é™…ç©ºé—´ç«™`å¯ä»¥æ‰¾åˆ°å¾ˆå¤šæ¥å—ç©ºé—´ç«™å›¾ç‰‡`SSTV`ä¿¡å·ç›¸å…³æ–‡ç« ã€‚å¾—åˆ°å…³é”®è¯`SSTV`ã€‚

ç»§ç»­æœç´¢`sstv audio decoder`æ‰¾åˆ°[GitHub - colaclanth/sstv: SSTV Decoder](https://github.com/colaclanth/sstv)ã€‚

`sstv -d insect.wav -o result.png`å³å¯è§£å‡ºã€‚

![insect-result](./img/insect-result.png)

`flag{SSssTV_y0u_W4NNa_HaV3_4_trY}`

#### Git? Git!

> ã€Œå¹¸äºæˆ‘å‘ç°äº†â€¦â€¦ã€é©¬è€å¸ˆé•¿åäº†ä¸€å£æ°”ã€‚
>
> ã€Œé©¬è€å¸ˆï¼Œå‘ç”Ÿç”šä¹ˆäº‹äº†ï¼Ÿã€é©¬è€å¸ˆçš„ä¸€ä½è‹±å›½ç ”ç©¶ç”Ÿé—®ã€‚
>
> ã€Œåˆšåˆšä¸€ä¸å°å¿ƒï¼ŒæŠŠ flag æäº¤åˆ°æœ¬åœ°ä»“åº“é‡Œäº†ã€‚ã€é©¬è€å¸ˆå›ç­”ï¼Œã€Œè¿˜å¥½æˆ‘å‘ç°äº†ï¼Œæ’¤é”€äº†è¿™æ¬¡æäº¤ï¼Œä¸ç„¶å°±æƒ¨äº†â€¦â€¦ã€
>
> ã€Œè¿™æ ·å•Šï¼Œé‚£å¤ªå¥½äº†ã€‚ã€ç ”ç©¶ç”Ÿè¯´ã€‚
>
> é©¬è€å¸ˆæ²¡æƒ³åˆ°çš„æ˜¯ï¼Œè¿™ä½å¹´è½»äººä¸è®²æ­¦å¾·ï¼Œå·å·æŠŠä»–çš„æœ¬åœ°ä»“åº“æ‹·è´åˆ°äº†è‡ªå·±çš„ç”µè„‘ä¸Šï¼Œç„¶åå¸¦å‡ºäº†å®éªŒå®¤ï¼Œæƒ³è¦ä¸€æ¢ç©¶ç«Ÿâ€¦â€¦
>
> **[æ‰“å¼€/ä¸‹è½½é¢˜ç›®](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/official/Git Git!/files/ML-Course-Notes.zip)**

çœ‹é¢˜ç›®è€ƒå¯Ÿçš„æ˜¯Gitä¿¡æ¯æ³„éœ²ï¼ŒGoogleæœç´¢`git æ³„éœ²`å‡ºæ¥è®¸å¤šç»“æœï¼Œå…¶ä¸­[ä»gitåŸç†è§’åº¦æµ…è°ˆ.gitæ³„éœ²åˆ©ç”¨åŸç†-å®‰å…¨å®¢](https://www.anquanke.com/post/id/236487)è¿™è¾¹è®²è§£çš„æ¯”è¾ƒç»†è‡´ã€‚

ä¸”æ–‡ä¸­æåˆ°äº†ä¸¤ä¸ªè½®å­ï¼Œæµ‹è¯•[GitHub - gakki429/Git_Extract: æå–è¿œç¨‹ git æ³„éœ²æˆ–æœ¬åœ° git çš„å·¥å…·](https://github.com/gakki429/Git_Extract)å¯ä»¥ç›´æ¥å®Œæˆè¿˜åŸã€‚

å…‹éš†åç›´æ¥è¿è¡Œ`python2 git_extract.py ../ML-Course-Notes/.git`ï¼Œå¯ä»¥å‘ç°æ ¹ç›®å½•å¤šäº†ä¸¤ä¸ªå“ˆå¸Œç»“å°¾çš„READMEæ–‡ä»¶ã€‚

éƒ½ä¸¢è¿›Diffå·¥å…·é‡ŒæŸ¥çœ‹å·®å¼‚å³å¯å¾—åˆ°flagã€‚

![git_diff](./img/git_diff.png)

`flag{TheRe5_@lwAy5_a_R3GreT_pi1l_1n_G1t}`


#### JSON âŠ‚ YAML?

> ä½ çŸ¥é“å—ï¼ŸHackergame å‡ºé¢˜æ—¶ï¼Œæ¯é“é¢˜éƒ½éœ€è¦å‡ºé¢˜äººç”¨ YAML æ ¼å¼å†™ä¸‹é¢˜ç›®çš„å…³é”®ä¿¡æ¯ã€‚ç„¶è€Œï¼Œæ¯å¹´æ€»æœ‰ä¸€äº›å‡ºé¢˜äººåœ¨ç¼–å†™ YAML æ–‡ä»¶æ—¶è¢«å¤æ‚çš„è¯­æ³•è§„åˆ™å¼„å¾—å¤´ç–¼ä¸å·²ã€‚
>
> è¿™å¤©å° Z åˆæ‰¾åˆ°å° W è¯´ï¼šã€Œæˆ‘æ˜¨å¤©å†™ YAML æ—¶ï¼ŒåˆèŠ±äº†åŠå¤©ç ”ç©¶ YAML çš„è§„èŒƒï¼ŒYAML å¥½éš¾å•Šï¼ã€
>
> å° W æƒŠè®¶é“ï¼šã€Œæ€ä¹ˆä¼šæœ‰äººä¸ä¼šå†™ YAML å‘¢ï¼Ÿåªè¦ä½ ä¼šå†™ JSON å°±ä¼šå†™ YAML å‘€ï¼Œå› ä¸ºä»»ä½•åˆæ³•çš„ JSON æœ¬èº«å°±æ˜¯åˆæ³•çš„ YAMLã€‚ã€
>
> å° Z å¬é—»è¿™ç•ªè¨€è®ºåå½“åœºè¡¨ç¤ºæ€€ç–‘ï¼Œç«‹åˆ»è¯´å‡ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒJSON å’Œ YAML è§£æå‡ºçš„å«ä¹‰å­˜åœ¨å·®å¼‚ã€‚å° W ç ”ç©¶äº†ä¸€ç•ªæ‰å‘ç°ï¼Œè¿™æ˜¯å› ä¸ºå¾ˆå¤šä¸»æµçš„ YAML åº“ä»ç„¶æ˜¯ YAML 1.1 çš„ï¼Œå®ƒæ²¡æœ‰è¿™ä¸ªæ€§è´¨ã€‚ä»–ä¸å¾—ä¸æ‰¿è®¤ï¼šã€Œå¥½å§ï¼Œè¿™ä¸ªæ€§è´¨åªé€‚ç”¨äº YAML 1.2ã€‚ã€
>
> å° Z ç¬‘äº†ï¼šã€Œåˆ«æ YAML 1.2 äº†ï¼Œå®ƒé‡åˆ°åˆæ³•çš„ JSON éƒ½æœ‰å¯èƒ½æŠ¥é”™ã€‚ã€
>
> **[ä¸‹è½½é¢˜ç›®æºä»£ç ](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/official/JSON%20%E2%8A%82%20YAML/files/yaml_vs_json.py)**
>
> ä½ å¯ä»¥é€šè¿‡ `nc 202.38.93.111 10096` æ¥è¿æ¥ï¼Œæˆ–è€…ç‚¹å‡»ä¸‹é¢çš„ã€Œæ‰“å¼€/ä¸‹è½½é¢˜ç›®ã€æŒ‰é’®é€šè¿‡ç½‘é¡µç»ˆç«¯ä¸è¿œç¨‹äº¤äº’ã€‚

å•Šï¼ŸåŸæ¥`YAML`æ˜¯`JSON`è¶…é›†å—ï¼Ÿç”¨äº†è¿™ä¹ˆä¹…å´ä¸çŸ¥é“ï¼Œå¯¹ä¸èµ·ï¼Œæˆ‘é€€ç¾¤ã€‚

##### JSON âŠ„ YAML 1.1

æ ¹æ®é¢˜æ„æœç´¢å…³é”®è¯`yaml json inconsistent`èƒ½æ‰¾åˆ° [What valid JSON files are not valid YAML 1.1 files? - Stack Overflow](https://stackoverflow.com/questions/21584985/what-valid-json-files-are-not-valid-yaml-1-1-files)  è¿™ä¸ªé—®é¢˜ä¸­ã€‚å…¶ä¸­æŒ‡å‡º`12345e999`åœ¨YAMLä¸­æ˜¯å­—ç¬¦ä¸²ï¼Œåœ¨JSONä¸­æ˜¯æ— é™å¤§ã€‚ç”šè‡³é—®é¢˜ä¸­æœ‰æå‡ºYAML 1.2çš„é™åˆ¶æ˜¯ä¸èƒ½å­˜åœ¨é‡å¤Keyã€‚

é‚£ä¹ˆç¬¬ä¸€é¢˜æäº¤

```JSON
{"t":12345e999}
```

å³å¯ã€‚



`flag{faf9facd7c9d64f74a4a746468400a5052647c697d}`

##### JSON âŠ„ YAML 1.2

ç¬¬ä¸€é¢˜ä¸­æ‰¾åˆ°çš„é—®é¢˜ä¸­å·²ç»æåˆ°äº†YAML 1.2çš„é™åˆ¶

> YAML 1.2 is (with one [minor caveat](http://yaml.org/spec/1.2/spec.html#id2759572) regarding duplicate keys) a superset of JSON

æ‰“å¼€ç»™å‡ºçš„é“¾æ¥å¯ä»¥çœ‹åˆ°è¯¦æƒ…

> JSON's [RFC4627](http://www.ietf.org/rfc/rfc4627.txt) requires that [mappings](http://yaml.org/spec/1.2-old/spec.html#mapping//) [keys](http://yaml.org/spec/1.2-old/spec.html#key//) merely â€œSHOULDâ€ be [unique](http://yaml.org/spec/1.2-old/spec.html#equality//), while YAML insists they â€œMUSTâ€ be. Technically, YAML therefore complies with the JSON spec, choosing to treat duplicates as an error. In practice, since JSON is silent on the semantics of such duplicates, the only portable JSON files are those with unique keys, which are therefore valid YAML files.

é‚£ä¹ˆç¬¬äºŒé¢˜æäº¤

```JSON
{"t": 1,"t":12345e999}
```

å³å¯ã€‚



`flag{b1c73f14d04db546b7e7e24cf1cc72529cf1d012d7}`



#### HTTP é›†é‚®å†Œ

> > ã€ŒHTTP è¯·æ±‚ä¸€ç¬é—´å°±å¾—åˆ°äº†å“åº”ï¼Œä½†æ˜¯ï¼ŒHTTP å“åº”çš„ status lineã€header å’Œ body éƒ½æ˜¯ç¡®å®å­˜åœ¨çš„ã€‚å¦‚æœå°†ä¸€ä¸ªä¸€ä¸ª HTTP çŠ¶æ€ç æ”¶é›†èµ·æ¥ï¼Œä¹Ÿè®¸å°±èƒ½å˜æˆâ€¦â€¦å˜æˆâ€¦â€¦å˜æˆâ€¦â€¦ã€
> >
> > ã€Œflagï¼Ÿã€
> >
> > ã€Œå°±èƒ½å˜æˆ flagï¼ã€
>
> ------
>
> æœ¬é¢˜ä¸­ï¼Œä½ å¯ä»¥å‘ä¸€ä¸ª nginx æœåŠ¡å™¨ï¼ˆå¯¹åº”çš„å®¹å™¨ä¸º**é»˜è®¤é…ç½®ä¸‹çš„ `nginx:1.25.2-bookworm`**ï¼‰å‘é€ HTTP è¯·æ±‚ã€‚ä½ éœ€è¦è·å–åˆ°ä¸åŒçš„ HTTP å“åº”çŠ¶æ€ç ä»¥è·å– flagï¼Œå…¶ä¸­ï¼š
>
> - è·å–ç¬¬ä¸€ä¸ª flag éœ€è¦æ”¶é›† 5 ç§çŠ¶æ€ç ï¼›
> - è·å–ç¬¬äºŒä¸ª flag éœ€è¦è®© nginx è¿”å›é¦–è¡Œæ— çŠ¶æ€ç çš„å“åº”ï¼ˆä¸è®¡å…¥æ”¶é›†çš„çŠ¶æ€ç ä¸­ï¼‰ï¼›
> - è·å–ç¬¬ä¸‰ä¸ª flag éœ€è¦æ”¶é›† 12 ç§çŠ¶æ€ç ã€‚
>
> å…³äºæ— çŠ¶æ€ç çš„åˆ¤æ–­é€»è¾‘å¦‚ä¸‹ï¼š

##### æ²¡æœ‰çŠ¶æ€â€¦â€¦å“ˆï¼Ÿ

[HTTP çš„å‘å±• - HTTP | MDN (mozilla.org)](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/Evolution_of_HTTP)

> è·Ÿåæ¥çš„ç‰ˆæœ¬ä¸åŒï¼ŒHTTP/0.9 çš„å“åº”å†…å®¹å¹¶ä¸åŒ…å« HTTP å¤´ã€‚è¿™æ„å‘³ç€åªæœ‰ HTML æ–‡ä»¶å¯ä»¥ä¼ é€ï¼Œæ— æ³•ä¼ è¾“å…¶ä»–ç±»å‹çš„æ–‡ä»¶ã€‚ä¹Ÿæ²¡æœ‰çŠ¶æ€ç æˆ–é”™è¯¯ä»£ç ã€‚

å‘é€

```http
GET / \r\n\r\n
```

å¾—åˆ°flagã€‚

`flag{great backward compatibility of nginx, R1ght?}`



##### 5 ç§çŠ¶æ€ç 

##### 12 ç§çŠ¶æ€ç 

è€ƒå¯ŸHTTPåŸºç¡€çŸ¥è¯†ï¼Œæƒ³èµ·å“ªä¸ªå‘å“ªä¸ªï¼Œæƒ³ä¸èµ·å°±ç¿»[HTTP å“åº”çŠ¶æ€ç  - HTTP | MDN (mozilla.org)](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status)ã€‚

- 200 OK

  ```http
  GET / HTTP/1.1\r\n
  Host: example.com\r\n\r\n
  ```

- 304 Not Modified

  ```http
  GET / HTTP/1.1\r\n
  Host: example.com\r\n
  If-None-Match: "64dbafc8-267"\r\n\r\n
  ```

- 400 Bad Request

  ```http
  GET / HTTP/1.1\r\n
  Hos: example.com\r\n\r\n
  ```

- 404 Not Found

  ```http
  GET /114514 HTTP/1.1\r\n
  Host: example.com\r\n\r\n
  ```

- 405 Not Allowed

  ```http
  PWN / HTTP/1.1\r\n
  Host: example.com\r\n\r\n

- 505 HTTP Version Not Supported

  ```http
  GET / HTTP/114514\r\n
  Host: example.com\r\n\r\n
  ```

- 414 Request-URI Too Large

  ```http
  GET /å—æ— ã€å–å•°æ€›é‚£ã€å“†å•°å¤œè€¶ï¼Œå—æ— ã€é˜¿å”è€¶ï¼Œå©†å¢ç¾¯å¸ã€çƒé’µå•°è€¶ï¼Œè©æè¨åŸµå©†è€¶ï¼Œæ‘©è¯ƒè¨åŸµå©†è€¶ï¼Œæ‘©è¯ƒã€è¿¦å¢å°¼è¿¦è€¶ï¼Œå”µï¼Œè¨çš¤å•°ç½šæ›³ï¼Œæ•°æ€›é‚£æ€›å†™ï¼Œå—æ— ã€æ‚‰å‰æ —åŸµã€ä¼Šè’™é˜¿å”è€¶ï¼Œå©†å¢å‰å¸ã€å®¤ä½›å•°æ¥é©®å©†ï¼Œå—æ— ã€é‚£å•°è°¨å¢€ï¼Œé†¯åˆ©æ‘©è¯ƒã€çš¤å“†æ²™å’©ï¼Œè¨å©†é˜¿ä»–ã€è±†è¾“æœ‹ï¼Œé˜¿é€å­•ï¼Œè¨å©†è¨å“†ã€é‚£æ‘©å©†è¨å“†ï¼Œé‚£æ‘©å©†ä¼½ï¼Œæ‘©ç½šç‰¹è±†ã€‚æ€›ä¾„ä»–ã€‚å”µï¼Œé˜¿å©†å¢é†¯ã€‚å¢è¿¦å¸ã€‚è¿¦ç½—å¸ã€‚å¤·é†¯å”ã€‚æ‘©è¯ƒè©æè¨åŸµï¼Œè¨å©†è¨å©†ã€‚æ‘©å•°æ‘©å•°ï¼Œæ‘©é†¯æ‘©é†¯ã€å”é©®å­•ã€‚ä¿±å¢ä¿±å¢ã€ç¾¯è’™ã€‚åº¦å¢åº¦å¢ã€ç½šé˜‡è€¶å¸ã€‚æ‘©è¯ƒç½šé˜‡è€¶å¸ã€‚é™€å•°é™€å•°ã€‚åœ°å”å°¼ã€‚å®¤ä½›å•°è€¶ã€‚é®å•°é®å•°ã€‚æ‘©ä¹ˆç½šæ‘©å•°ã€‚ç©†å¸éš¶ã€‚ä¼Šé†¯ä¼Šé†¯ã€‚å®¤é‚£å®¤é‚£ã€‚é˜¿å•°å‚ã€ä½›å•°èˆåˆ©ã€‚ç½šæ²™ç½šå‚ã€‚ä½›å•°èˆè€¶ã€‚å‘¼åš§å‘¼åš§æ‘©å•°ã€‚å‘¼åš§å‘¼åš§é†¯åˆ©ã€‚å¨‘å•°å¨‘å•°ï¼Œæ‚‰å”æ‚‰å”ã€‚è‹åš§è‹åš§ã€‚è©æå¤œã€è©æå¤œã€‚è©é©®å¤œã€è©é©®å¤œã€‚å¼¥å¸å”å¤œã€‚é‚£å•°è°¨å¢€ã€‚åœ°åˆ©ç‘Ÿå°¼é‚£ã€‚å©†å¤œæ‘©é‚£ã€‚å¨‘å©†è¯ƒã€‚æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚æ‘©è¯ƒæ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚æ‚‰é™€å–»è‰ºã€‚å®¤çš¤å•°è€¶ã€‚å¨‘å©†è¯ƒã€‚é‚£å•°è°¨å¢€ã€‚å¨‘å©†è¯ƒã€‚æ‘©å•°é‚£å•°ã€‚å¨‘å©†è¯ƒã€‚æ‚‰å•°åƒ§ã€é˜¿ç©†ä½‰è€¶ï¼Œå¨‘å©†è¯ƒã€‚å¨‘å©†æ‘©è¯ƒã€é˜¿æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚è€…å‰å•°ã€é˜¿æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚æ³¢é™€æ‘©ã€ç¾¯æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚é‚£å•°è°¨å¢€ã€çš¤ä¼½å•°è€¶ã€‚å¨‘å©†è¯ƒã€‚æ‘©å©†åˆ©ã€èƒœç¾¯å•°å¤œã€‚å¨‘å©†è¯ƒã€‚å—æ— ã€å–å•°æ€›é‚£ã€å“†å•°å¤œè€¶ï¼Œå—æ— ã€é˜¿å”è€¶ã€‚å©†åš§å‰å¸ã€‚çƒçš¤å•°å¤œã€‚å¨‘å©†è¯ƒã€‚å”µï¼Œæ‚‰æ®¿éƒ½ã€‚æ¼«å¤šå•°ã€‚è·‹é™€è€¶ï¼Œå¨‘å©†è¯ƒã€‚å—æ— ã€å–å•°æ€›é‚£ã€å“†å•°å¤œè€¶ï¼Œå—æ— ã€é˜¿å”è€¶ï¼Œå©†å¢ç¾¯å¸ã€çƒé’µå•°è€¶ï¼Œè©æè¨åŸµå©†è€¶ï¼Œæ‘©è¯ƒè¨åŸµå©†è€¶ï¼Œæ‘©è¯ƒã€è¿¦å¢å°¼è¿¦è€¶ï¼Œå”µï¼Œè¨çš¤å•°ç½šæ›³ï¼Œæ•°æ€›é‚£æ€›å†™ï¼Œå—æ— ã€æ‚‰å‰æ —åŸµã€ä¼Šè’™é˜¿å”è€¶ï¼Œå©†å¢å‰å¸ã€å®¤ä½›å•°æ¥é©®å©†ï¼Œå—æ— ã€é‚£å•°è°¨å¢€ï¼Œé†¯åˆ©æ‘©è¯ƒã€çš¤å“†æ²™å’©ï¼Œè¨å©†é˜¿ä»–ã€è±†è¾“æœ‹ï¼Œé˜¿é€å­•ï¼Œè¨å©†è¨å“†ã€é‚£æ‘©å©†è¨å“†ï¼Œé‚£æ‘©å©†ä¼½ï¼Œæ‘©ç½šç‰¹è±†ã€‚æ€›ä¾„ä»–ã€‚å”µï¼Œé˜¿å©†å¢é†¯ã€‚å¢è¿¦å¸ã€‚è¿¦ç½—å¸ã€‚å¤·é†¯å”ã€‚æ‘©è¯ƒè©æè¨åŸµï¼Œè¨å©†è¨å©†ã€‚æ‘©å•°æ‘©å•°ï¼Œæ‘©é†¯æ‘©é†¯ã€å”é©®å­•ã€‚ä¿±å¢ä¿±å¢ã€ç¾¯è’™ã€‚åº¦å¢åº¦å¢ã€ç½šé˜‡è€¶å¸ã€‚æ‘©è¯ƒç½šé˜‡è€¶å¸ã€‚é™€å•°é™€å•°ã€‚åœ°å”å°¼ã€‚å®¤ä½›å•°è€¶ã€‚é®å•°é®å•°ã€‚æ‘©ä¹ˆç½šæ‘©å•°ã€‚ç©†å¸éš¶ã€‚ä¼Šé†¯ä¼Šé†¯ã€‚å®¤é‚£å®¤é‚£ã€‚é˜¿å•°å‚ã€ä½›å•°èˆåˆ©ã€‚ç½šæ²™ç½šå‚ã€‚ä½›å•°èˆè€¶ã€‚å‘¼åš§å‘¼åš§æ‘©å•°ã€‚å‘¼åš§å‘¼åš§é†¯åˆ©ã€‚å¨‘å•°å¨‘å•°ï¼Œæ‚‰å”æ‚‰å”ã€‚è‹åš§è‹åš§ã€‚è©æå¤œã€è©æå¤œã€‚è©é©®å¤œã€è©é©®å¤œã€‚å¼¥å¸å”å¤œã€‚é‚£å•°è°¨å¢€ã€‚åœ°åˆ©ç‘Ÿå°¼é‚£ã€‚å©†å¤œæ‘©é‚£ã€‚å¨‘å©†è¯ƒã€‚æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚æ‘©è¯ƒæ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚æ‚‰é™€å–»è‰ºã€‚å®¤çš¤å•°è€¶ã€‚å¨‘å©†è¯ƒã€‚é‚£å•°è°¨å¢€ã€‚å¨‘å©†è¯ƒã€‚æ‘©å•°é‚£å•°ã€‚å¨‘å©†è¯ƒã€‚æ‚‰å•°åƒ§ã€é˜¿ç©†ä½‰è€¶ï¼Œå¨‘å©†è¯ƒã€‚å¨‘å©†æ‘©è¯ƒã€é˜¿æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚è€…å‰å•°ã€é˜¿æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚æ³¢é™€æ‘©ã€ç¾¯æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚é‚£å•°è°¨å¢€ã€çš¤ä¼½å•°è€¶ã€‚å¨‘å©†è¯ƒã€‚æ‘©å©†åˆ©ã€èƒœç¾¯å•°å¤œã€‚å¨‘å©†è¯ƒã€‚å—æ— ã€å–å•°æ€›é‚£ã€å“†å•°å¤œè€¶ï¼Œå—æ— ã€é˜¿å”è€¶ã€‚å©†åš§å‰å¸ã€‚çƒçš¤å•°å¤œã€‚å¨‘å©†è¯ƒã€‚å”µï¼Œæ‚‰æ®¿éƒ½ã€‚æ¼«å¤šå•°ã€‚è·‹é™€è€¶ï¼Œå¨‘å©†è¯ƒã€‚å—æ— ã€å–å•°æ€›é‚£ã€å“†å•°å¤œè€¶ï¼Œå—æ— ã€é˜¿å”è€¶ï¼Œå©†å¢ç¾¯å¸ã€çƒé’µå•°è€¶ï¼Œè©æè¨åŸµå©†è€¶ï¼Œæ‘©è¯ƒè¨åŸµå©†è€¶ï¼Œæ‘©è¯ƒã€è¿¦å¢å°¼è¿¦è€¶ï¼Œå”µï¼Œè¨çš¤å•°ç½šæ›³ï¼Œæ•°æ€›é‚£æ€›å†™ï¼Œå—æ— ã€æ‚‰å‰æ —åŸµã€ä¼Šè’™é˜¿å”è€¶ï¼Œå©†å¢å‰å¸ã€å®¤ä½›å•°æ¥é©®å©†ï¼Œå—æ— ã€é‚£å•°è°¨å¢€ï¼Œé†¯åˆ©æ‘©è¯ƒã€çš¤å“†æ²™å’©ï¼Œè¨å©†é˜¿ä»–ã€è±†è¾“æœ‹ï¼Œé˜¿é€å­•ï¼Œè¨å©†è¨å“†ã€é‚£æ‘©å©†è¨å“†ï¼Œé‚£æ‘©å©†ä¼½ï¼Œæ‘©ç½šç‰¹è±†ã€‚æ€›ä¾„ä»–ã€‚å”µï¼Œé˜¿å©†å¢é†¯ã€‚å¢è¿¦å¸ã€‚è¿¦ç½—å¸ã€‚å¤·é†¯å”ã€‚æ‘©è¯ƒè©æè¨åŸµï¼Œè¨å©†è¨å©†ã€‚æ‘©å•°æ‘©å•°ï¼Œæ‘©é†¯æ‘©é†¯ã€å”é©®å­•ã€‚ä¿±å¢ä¿±å¢ã€ç¾¯è’™ã€‚åº¦å¢åº¦å¢ã€ç½šé˜‡è€¶å¸ã€‚æ‘©è¯ƒç½šé˜‡è€¶å¸ã€‚é™€å•°é™€å•°ã€‚åœ°å”å°¼ã€‚å®¤ä½›å•°è€¶ã€‚é®å•°é®å•°ã€‚æ‘©ä¹ˆç½šæ‘©å•°ã€‚ç©†å¸éš¶ã€‚ä¼Šé†¯ä¼Šé†¯ã€‚å®¤é‚£å®¤é‚£ã€‚é˜¿å•°å‚ã€ä½›å•°èˆåˆ©ã€‚ç½šæ²™ç½šå‚ã€‚ä½›å•°èˆè€¶ã€‚å‘¼åš§å‘¼åš§æ‘©å•°ã€‚å‘¼åš§å‘¼åš§é†¯åˆ©ã€‚å¨‘å•°å¨‘å•°ï¼Œæ‚‰å”æ‚‰å”ã€‚è‹åš§è‹åš§ã€‚è©æå¤œã€è©æå¤œã€‚è©é©®å¤œã€è©é©®å¤œã€‚å¼¥å¸å”å¤œã€‚é‚£å•°è°¨å¢€ã€‚åœ°åˆ©ç‘Ÿå°¼é‚£ã€‚å©†å¤œæ‘©é‚£ã€‚å¨‘å©†è¯ƒã€‚æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚æ‘©è¯ƒæ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚æ‚‰é™€å–»è‰ºã€‚å®¤çš¤å•°è€¶ã€‚å¨‘å©†è¯ƒã€‚é‚£å•°è°¨å¢€ã€‚å¨‘å©†è¯ƒã€‚æ‘©å•°é‚£å•°ã€‚å¨‘å©†è¯ƒã€‚æ‚‰å•°åƒ§ã€é˜¿ç©†ä½‰è€¶ï¼Œå¨‘å©†è¯ƒã€‚å¨‘å©†æ‘©è¯ƒã€é˜¿æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚è€…å‰å•°ã€é˜¿æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚æ³¢é™€æ‘©ã€ç¾¯æ‚‰é™€å¤œã€‚å¨‘å©†è¯ƒã€‚é‚£å•°è°¨å¢€ã€çš¤ä¼½å•°è€¶ã€‚å¨‘å©†è¯ƒã€‚æ‘©å©†åˆ©ã€èƒœç¾¯å•°å¤œã€‚å¨‘å©†è¯ƒã€‚å—æ— ã€å–å•°æ€›é‚£ã€å“†å•°å¤œè€¶ï¼Œå—æ— ã€é˜¿å”è€¶ã€‚å©†åš§å‰å¸ã€‚çƒçš¤å•°å¤œã€‚å¨‘å©†è¯ƒã€‚å”µï¼Œæ‚‰æ®¿éƒ½ã€‚æ¼«å¤šå•°ã€‚è·‹é™€è€¶ï¼Œå¨‘å©†è¯ƒã€‚HTTP/1.1\r\n
  Host: example.com\r\n\r\n
  ```

  

- 206 Partial Content

  ```http
  GET / HTTP/1.1\r\n
  Range: bytes=1-\r\n
  Host: example.com\r\n\r\n
  ```

- 416 Requested Range Not Satisfiable

  ```http
  GET / HTTP/1.1\r\n
  Range: bytes=-1-\r\n
  Host: example.com\r\n\r\n
  ```

- 100 Continue

  ```http
  GET / HTTP/1.1\r\n
  Expect: 100-continue\r\n
  Host: example.com\r\n\r\n\r\n
  ```

é›†é‚®å‡º`10/12`ä¸ªï¼Œæœªçˆ†flagã€‚



####  Docker for Everyone

> X æ˜¯å®éªŒå®¤æœºå™¨çš„ç®¡ç†å‘˜ï¼Œä¸ºäº†åœ¨ä¿è¯å®‰å…¨çš„åŒæ—¶è®©åŒå­¦ä»¬éƒ½ç”¨ä¸Š dockerï¼Œä»–æŠŠåŒå­¦çš„è´¦å·åŠ å…¥äº† docker ç”¨æˆ·ç»„ï¼Œè¿™æ ·å°±ä¸éœ€è¦ç»™åŒå­¦ sudo æƒé™äº†ï¼
>
> ä½†æœçœŸå¦‚æ­¤å—ï¼Ÿ
>
> ------
>
> æä¾›çš„ç¯å¢ƒä¼šè‡ªåŠ¨ç™»å½•ä½æƒé™çš„ `hg` ç”¨æˆ·ã€‚ç™»å½•åçš„æç¤ºä¿¡æ¯æ˜¾ç¤ºäº†å¦‚ä½•åœ¨è¯¥ç¯å¢ƒä¸­ä½¿ç”¨ dockerã€‚è¯»å– `/flag`ï¼ˆæ³¨æ„å…¶ä¸ºè½¯é“¾æ¥ï¼‰è·å– flagã€‚
>
> é¢˜ç›®ç¯å¢ƒè¿è¡Œ 15 åˆ†é’Ÿåä¼šè‡ªåŠ¨å…³é—­ã€‚
>
> ä½ å¯ä»¥åœ¨ä¸‹é¢åˆ—å‡ºçš„ä¸¤ç§æ–¹æ³•ä¸­ä»»é€‰å…¶ä¸€æ¥è¿æ¥é¢˜ç›®ï¼š
>
> - ç‚¹å‡»ä¸‹é¢çš„ã€Œæ‰“å¼€/ä¸‹è½½é¢˜ç›®ã€æŒ‰é’®é€šè¿‡ç½‘é¡µç»ˆç«¯ä¸è¿œç¨‹äº¤äº’ã€‚å¦‚æœé‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œåœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œä½ ä¸éœ€è¦æ‰‹åŠ¨è¾“å…¥ tokenã€‚
> - åœ¨ Linuxã€macOSã€WSL æˆ– Git Bash ç­‰æœ¬åœ°ç»ˆç«¯ä¸­ä½¿ç”¨ `stty raw -echo; nc 202.38.93.111 10338; stty sane` å‘½ä»¤æ¥è¿æ¥é¢˜ç›®ã€‚å¦‚æœé‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œä½ å¿…é¡»æ‰‹åŠ¨è¾“å…¥ tokenï¼ˆå¤åˆ¶ç²˜è´´ä¹Ÿå¯ï¼‰ã€‚**æ³¨æ„ï¼Œè¾“å…¥çš„ token ä¸ä¼šè¢«æ˜¾ç¤ºï¼Œè¾“å…¥ç»“æŸåæŒ‰ Ctrl-J å³å¯å¼€å§‹é¢˜ç›®ã€‚**
>
> æ— è®ºé‡‡ç”¨å“ªç§æ–¹æ³•è¿æ¥é¢˜ç›®ï¼Œå¯åŠ¨é¢˜ç›®å‡éœ€è¦æ•°ç§’æ—¶é—´ï¼Œå‡ºç°é»‘å±æ˜¯æ­£å¸¸ç°è±¡ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚

æŒ‰ç…§é¢˜æ„ï¼Œç»™äº†æ‰€æœ‰äººdockerè¿è¡Œæƒé™ï¼Œä¸”dockerè¿è¡Œåœ¨rootç”¨æˆ·ä¸‹ã€‚

ç›´æ¥æ˜ å°„`/flag`è‡³å®¹å™¨ä¸­å³å¯æ‰“å°å†…å®¹ã€‚

`docker run -it --rm -v /flag:/flag alpine`



`flag{u5e_r00t1ess_conta1ner_90d889fb0b_plz!}`



#### æƒœå­—å¦‚é‡‘ 2.0

> æƒœå­—å¦‚é‡‘ä¸€å‘æ˜¯ç¨‹åºå¼€å‘çš„ä¼˜è‰¯ä¼ ç»Ÿã€‚æ— è®ºæ˜¯ã€Œ[creat](https://stackoverflow.com/questions/8390979/why-create-system-call-is-called-creat)ã€è¿˜æ˜¯ã€Œ[referer](https://stackoverflow.com/questions/8226075/why-http-referer-is-single-r-not-http-referrer)ã€ï¼Œéƒ½æ— ä¸é—ªè€€ç€ç¨‹åºå‘˜ã€ŒèŠ‚çº¦æ¯å¥è¯ä¸­çš„æ¯ä¸€ä¸ªå­—æ¯ã€çš„ä¼˜ç§€å“è´¨ã€‚ä¸Šä¸€å±Šä¿¡æ¯å®‰å…¨å¤§èµ›ç»„å§”ä¼šåœ¨å»å¹´æ¨å‡ºã€Œæƒœå­—å¦‚é‡‘åŒ–ã€ï¼ˆXZRJificationï¼‰æ ‡å‡†è§„èŒƒåï¼Œå—åˆ°äº†å¹¿å¤§ç¨‹åºå¼€å‘äººå‘˜çš„å¥½è¯„ã€‚ç°å°†è¯¥æ ‡å‡†è¾‘å½•å¦‚ä¸‹ã€‚
>
> ##### æƒœå­—å¦‚é‡‘åŒ–æ ‡å‡†
>
> æƒœå­—å¦‚é‡‘åŒ–æŒ‡çš„æ˜¯å°†ä¸€ä¸²æ–‡æœ¬ä¸­çš„éƒ¨åˆ†å­—ç¬¦åˆ é™¤ï¼Œä»è€Œå½¢æˆå¦ä¸€ä¸²æ–‡æœ¬çš„è¿‡ç¨‹ã€‚è¯¥æ ‡å‡†é’ˆå¯¹çš„æ˜¯æ–‡æœ¬ä¸­æ‰€æœ‰ç”± 52 ä¸ªæ‹‰ä¸å­—æ¯è¿ç»­æ’å¸ƒå½¢æˆçš„åºåˆ—ï¼Œåœ¨ä¸‹æ–‡ä¸­ç»Ÿç§°ä¸ºã€Œå•è¯ã€ã€‚ä¸€ä¸ªå•è¯ä¸­é™¤ã€Œ`AEIOUaeiou`ã€å¤–çš„ 42 ä¸ªå­—æ¯è¢«ç§°ä½œã€Œè¾…éŸ³å­—æ¯ã€ã€‚æ•´ä¸ªæƒœå­—å¦‚é‡‘åŒ–çš„è¿‡ç¨‹æŒ‰ç…§ä»¥ä¸‹ä¸¤æ¡åŸåˆ™å¯¹æ–‡æœ¬ä¸­çš„æ¯ä¸ªå•è¯è¿›è¡Œæ“ä½œï¼š
>
> - ç¬¬ä¸€åŸåˆ™ï¼ˆåˆç§° creat åŸåˆ™ï¼‰ï¼šå¦‚å•è¯æœ€åä¸€ä¸ªå­—æ¯ä¸ºã€Œ`e`ã€æˆ–ã€Œ`E`ã€ï¼Œä¸”è¯¥å­—æ¯çš„ä¸Šä¸€ä¸ªå­—æ¯ä¸ºè¾…éŸ³å­—æ¯ï¼Œåˆ™è¯¥å­—æ¯äºˆä»¥åˆ é™¤ã€‚
> - ç¬¬äºŒåŸåˆ™ï¼ˆåˆç§° referer åŸåˆ™ï¼‰ï¼šå¦‚å•è¯ä¸­å­˜åœ¨ä¸€ä¸²å…¨éƒ¨ç”±å®Œå…¨ç›¸åŒï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰çš„è¾…éŸ³å­—æ¯ç»„æˆçš„å­ä¸²ï¼Œåˆ™è¯¥å­ä¸²ä»…ä¿ç•™ç¬¬ä¸€ä¸ªå­—æ¯ã€‚
>
> å®¹æ˜“è¯æ˜æƒœå­—å¦‚é‡‘åŒ–æ“ä½œæ˜¯å¹‚ç­‰çš„ï¼šæƒœå­—å¦‚é‡‘åŒ–å¤šæ¬¡å’Œæƒœå­—å¦‚é‡‘åŒ–ä¸€æ¬¡çš„ç»“æœç›¸åŒã€‚
>
> ##### ä½ çš„ä»»åŠ¡
>
> é™„ä»¶åŒ…æ‹¬äº†ä¸€ä¸ªç”¨äºæ‰“å°æœ¬é¢˜ç›® flag çš„ç¨‹åºï¼Œä¸”å·²ç»ç»è¿‡æƒœå­—å¦‚é‡‘åŒ–å¤„ç†ã€‚ä½ éœ€è¦åšçš„å°±æ˜¯å¾—åˆ°ç¨‹åºçš„æ‰§è¡Œç»“æœã€‚
>
> ##### é™„æ³¨
>
> æœ¬æ–‡å·²ç»è¿‡æƒœå­—å¦‚é‡‘åŒ–å¤„ç†ã€‚è§£ç­”æœ¬é¢˜ä¸éœ€è¦ä»»ä½•å¾€å±Šæ¯”èµ›çš„ç›¸å…³çŸ¥è¯†ã€‚
>
> **[æ‰“å¼€/ä¸‹è½½é¢˜ç›®](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/official/æƒœå­—å¦‚é‡‘ 2.0/src/print_flag.py)**

æŸ¥çœ‹å»å¹´é¢˜è§£æ˜¯çœ‹å­—ç¬¦å‡ºç°å¯èƒ½æ€§è¿›è¡Œæšä¸¾ã€‚

```python
cod_dict += ['nymeh1niwemflcir}echaet']
cod_dict += ['a3g7}kidgojernoetlsup?h']
cod_dict += ['ulw!f5soadrhwnrsnstnoeq']
cod_dict += ['ct{l-findiehaai{oveatas']
cod_dict += ['ty9kxborszstguyd?!blm-p']
```

ç»“åˆä»£ç é‡Œ`check_equals(set(len(s) for s in cod_dict), {24})`å¯çŸ¥æ¯ä¸ªä¸²ä¸­åˆ é™¤äº†ä¸€ä¸ªå­—ç¬¦ã€‚



é¦–å…ˆæ ¹æ®ç¬¬ä¸€åŸåˆ™ï¼Œæ¯ä¸ªä¸²ç»“å°¾å¯èƒ½éƒ½æ˜¯`e`ï¼Œæµ‹è¯•ä¸‹æŠŠæ‰€æœ‰ä¸²ç»“å°¾éƒ½åŠ ä¸Šä¸€ä¸ªç‰¹æ®Šå­—ç¬¦å¹¶æ‰“å°flagã€‚å¾—åˆ°`5laulyoufeepr3cvees3df7weparsn3sfr1gwn!}`

è§‚å¯Ÿå‘ç°è™½ç„¶æœªå‡ºç°ç‰¹æ®Šå­—ç¬¦ï¼Œä½†æ˜¯ç»“å°¾æ˜¯`}`æ­£ç¡®ï¼Œç¡®æœ‰æ­£å¸¸çš„å•è¯`you`ï¼Œç–‘ä¼¼å•è¯`pars(e)`ã€‚é‚£ä¹ˆå¯èƒ½æœ‰ä¸€ä¸²çš„ç»“å°¾æ˜¯`e`è¢«æ’å¯¹äº†ï¼Œä¸”åªèƒ½æ˜¯å­˜åœ¨`}`ç¬¬ä¸€æˆ–ç¬¬äºŒä¸²ã€‚åˆ†åˆ«å°è¯•åœ¨é¦–ä½æ·»åŠ å­—ç¬¦åæ‰“å°å‘ç°æ˜¯ç¬¬äºŒä¸²å¯èƒ½ä¸º`a3g7}kidgojernoetlsup?he`ã€‚

å†è§‚å¯Ÿå¯†æ–‡flag

```python
flag = decrypt_data([53, 41, 85, 109, 75, 1, 33, 48, 77, 90,
                     17, 118, 36, 25, 13, 89, 90, 3, 63, 25,
                     31, 77, 27, 60, 3, 118, 24, 62, 54, 61,
                     25, 63, 77, 36, 5, 32, 60, 67, 113, 28])
```

çœ‹æœ€åä¸€ä¸ªå­—ç¬¦æ‰€åœ¨ç´¢å¼•ä¸º28ï¼Œå¯ä»¥è‚¯å®šç¬¬äºŒä¸²æ’å¯¹äº†ã€‚

æ¥ç€æˆ‘ä»¬çŸ¥é“flagçš„å‰5ä½å¿…ä¸º`flag{`ï¼ŒåŠå…¶å¯¹åº”çš„ç´¢å¼•`53, 41, 85, 109, 75`ã€‚

æ‰“å°ä¸‹å­—ç¬¦åˆ—è¡¨

```python
idx = 0
for s in cod_dict:
    for c in s:
        print(c + "\t", end="")
    print()
    for c in s:
        print(str(idx) + "\t", end="")
        idx += 1
    print()
```

å¾—åˆ° ![char_table](./img/char_table.png)

å¯¹ç…§ä¸‹`flag{`çš„ç´¢å¼•æˆ‘ä»¬å¯ä»¥æ¨æµ‹ï¼š

- fï¼šç¬¬ä¸‰è¡Œç´¢å¼•52å‰ï¼ˆ49-51ï¼‰å¿…ç¼ºå°‘ä¸€ä¸ªå­—ç¬¦ã€‚ä¸”å¯†æ–‡ä¸­æ²¡å‡ºç°ï¼Œé‚£ä¹ˆå®ƒæ— å…³ç´§è¦ï¼Œåªéœ€ä¸ºå ä½ç¬¦
- lï¼šç¬¬äºŒè¡Œæ¨æµ‹è¯æ®+1
- aï¼šç¬¬å››è¡Œæ— æ³•æ¨æµ‹
- gï¼šç¬¬äº”è¡Œç´¢å¼•108å‰ï¼ˆ96-107ï¼‰ç¼ºå°‘ä¸€ä¸ªå­—ç¬¦ã€‚
- {ï¼šç¬¬å››è¡Œç´¢å¼•74å‰ï¼ˆ72,73ï¼‰å¿…ç¼ºå°‘ä¸€ä¸ªå­—ç¬¦ã€‚ä¸”å¯†æ–‡ä¸­æ²¡å‡ºç°ï¼Œé‚£ä¹ˆå®ƒæ— å…³ç´§è¦ï¼Œåªéœ€ä¸ºå ä½ç¬¦
- å¯†æ–‡ä¸­æ¶‰åŠç¬¬ä¸€è¡Œçš„ç´¢å¼•æœ‰`1,17,13,3,5`ï¼Œé‚£ä¹ˆç¬¬ä¸€è¡Œç´¢å¼•17åå…·ä½“å­—ç¬¦æ— å…³ç´§è¦
- å¯†æ–‡ä¸­æ¶‰åŠç¬¬äº”è¡Œçš„ç´¢å¼•æœ‰`109,118,113`ï¼Œé‚£ä¹ˆç¬¬äº”è¡Œç´¢å¼•109å‰å…·ä½“å­—ç¬¦æ— å…³ç´§è¦

ç»“åˆæ‰€æœ‰çº¿ç´¢ï¼Œæˆ‘ä»¬çš„æšä¸¾çº§åˆ«å¤§å¹…é™ä½ã€‚å¯èƒ½æ€§å¦‚ä¸‹ï¼ˆğŸªå ä½ï¼‰

```log
n(n?)y(y?)m(m?)eh([he]?)1n(n?)iw(w?)em(m?)f(f?)l(l?)c(c?)ir([re]?)}echaet
a3g7}kidgojernoetlsup?he
uğŸªlw!f5soadrhwnrsnstnoeq
ğŸªct{l-findiehaai{oveatas
(ğŸª?)ty9kxborszstguyd?!blm-p(ğŸª?)
```

ç¬¬ä¸‰å››è¡Œå°è¯•æ·»åŠ ä¸€ä¸ªå ä½ç¬¦åæ‰“å°å¾—åˆ°`flau{you-vepr3cover3d-7hepan5w3r-r1ght!}`ï¼Œå‘ç°å¯èƒ½å…³é”®è¯`cover3d`ï¼Œ`r1ght`ã€‚

ç¬¬äº”è¡Œå°è¯•æ·»åŠ ä¸€ä¸ªå ä½ç¬¦åæ‰“å°å¾—åˆ°`flag{you-ve-r3cover3d-7he-an5w3r-r1ght?}`ï¼Œå¾—åˆ°flagã€‚

æœ€ç»ˆ`code_dict`å¦‚ä¸‹ï¼š

```python
code_dict = []
code_dict += ['nymeh1niwemflcir}echaetğŸª']
code_dict += ['a3g7}kidgojernoetlsup?he']
code_dict += ['ulğŸªw!f5soadrhwnrsnstnoeq']
code_dict += ['cğŸªt{l-findiehaai{oveatas']
code_dict += ['ğŸªty9kxborszstguyd?!blm-p']
```



`flag{you-ve-r3cover3d-7he-an5w3r-r1ght?}`

#### ğŸª é«˜é¢‘ç‡æ˜Ÿçƒ

> èŒ«èŒ«æ˜Ÿç³»é—´ï¼Œæ–‡æ˜è¢«åˆ†ä¸ºä¸åŒçš„ç­‰çº§ã€‚æ¯ä¸€ä¸ªæ–‡æ˜ä¸­éƒ½è•´è—äº†ä¸€ç§å¤è€çš„åŠ›é‡ â€”â€” flagï¼Œè¢«è®¤ä¸ºæ˜¯å…¶æ™ºæ…§çš„è±¡å¾ã€‚
>
> ä½ åœ¨æ¢ç´¢çš„è¿‡ç¨‹ä¸­æ„å¤–è¿›å…¥äº†ä¸€ä¸ªå°é—­ç©ºé—´ã€‚è¿™æ˜¯ä¸€ä¸ªç”±ç¥ç§˜çš„é«˜é¢‘ç‡æ˜Ÿäººæ§åˆ¶ç€çš„æ˜Ÿçƒã€‚æ˜Ÿçƒçš„ä¸­å¿ƒç«–ç«‹ç€ä¸€ä¸ªå·¨å¤§çš„ä¸‰è§’å½¢ä»»åŠ¡ç‰Œï¼Œä¸Šé¢åˆ»ç€å¯†æ–‡å’ŒæŒ‘æˆ˜ã€‚
>
> é«˜é¢‘ç‡æ˜Ÿäººçš„è§†è§‰è¾“å…¥é¢‘ç‡æé«˜ï¼Œå¯ä»¥ä¸€ç›®åƒè¡Œã€è¿‡ç›®ä¸å¿˜ï¼Œä»–ä»¬çš„äº¤æµå¯¹åœ°çƒäººæ¥è¯´è¿‡äºè¶…å‰äº†ã€‚flag è¢«è—åœ¨äº†è¿™æ®µä»£ç ä¸­ï¼Œä½†æ˜¯ç°åœ¨åªæœ‰é«˜é¢‘ç‡æ˜Ÿäººåœ¨ç»ˆç«¯æµè§ˆä»£ç çš„æ—¶å€™ï¼Œä½¿ç”¨ [asciinema](https://asciinema.org/) å½•åˆ¶çš„æ–‡ä»¶äº†ï¼Œä½ èƒ½ä»ä¸­è¿˜åŸå‡ºä»£ç å—ï¼Ÿ
>
> **[æ‰“å¼€/ä¸‹è½½é¢˜ç›®](https://ftp.lug.ustc.edu.cn/~taoky/TinyStories-33M.zip)**

é¢˜ç›®å·²ç»™å‡ºå½•åƒç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°å…¶æä¾›ä¸€ä¸ª`cat`æ–¹æ³•ã€‚

>  [cat <filename> ](https://github.com/asciinema/asciinema#cat-filename)
>
> Print full output of recorded asciicast to a terminal.

æ‰§è¡Œ`asciinema cat ./asciinema_restore.rec > output.txt`å³å¯å°†å½•åƒå­˜ä¸ºæ–‡æœ¬ã€‚

æ¥ä¸‹æ¥åªéœ€æ¸…é™¤æ‰ASCIIæ§åˆ¶å­—ç¬¦å³å¯é£Ÿç”¨ï¼Œå¯ä»¥ç®€å•æ‰‹åŠ¨å…¨å±€æ›¿æ¢ä¸ºç©ºã€‚



`flag{y0u_cAn_ReSTorE_C0de_fr0m_asc11nema_3db2da1063300e5dabf826e40ffd016101458df23a371}`



#### ğŸª å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ

> èŒ«èŒ«æ˜Ÿç³»é—´ï¼Œæ–‡æ˜è¢«åˆ†ä¸ºä¸åŒçš„ç­‰çº§ã€‚æ¯ä¸€ä¸ªæ–‡æ˜ä¸­éƒ½è•´è—äº†ä¸€ç§å¤è€çš„åŠ›é‡ â€”â€” flagï¼Œè¢«è®¤ä¸ºæ˜¯å…¶æ™ºæ…§çš„è±¡å¾ã€‚
>
> ä½ åœ¨æ¢ç´¢çš„è¿‡ç¨‹ä¸­æ„å¤–è¿›å…¥äº†ä¸€ä¸ªå°é—­ç©ºé—´ã€‚è¿™æ˜¯ä¸€ä¸ªç”±ç¥ç§˜çš„ 33M å‚æ•°çš„ã€Œå°å‹å¤§è¯­è¨€æ¨¡å‹ã€æ§åˆ¶ç€çš„æ˜Ÿçƒã€‚æ˜Ÿçƒçš„ä¸­å¿ƒç«–ç«‹ç€ä¸€ä¸ªå·¨å¤§çš„ä¸‰è§’å½¢ä»»åŠ¡ç‰Œï¼Œä¸Šé¢åˆ»ç€å¯†æ–‡å’ŒæŒ‘æˆ˜ã€‚
>
> åœ¨è¿™ä¸ªæ˜Ÿçƒä¸Šï¼Œä½ éœ€è¦ä¸è¿™ä¸ªå…ˆè¿›çš„è¯­è¨€æ¨¡å‹å±•å¼€ä¸€åœºäº¤æµã€‚é€šè¿‡ä¸å®ƒå¯¹è¯ï¼Œè¯±å¯¼å®ƒè¯´å‡ºæŒ‡å®šçš„è¯è¯­ï¼Œä»è¿™ä¸ªç¥ç§˜æ™ºæ…§ä½“ä¸­è·å¾— flagã€‚ä½ éœ€è¦è®©è¿™ä¸ªè¯­è¨€æ¨¡å‹åˆ†åˆ«è¯´å‡º `you are smart`ï¼Œ`accepted`ï¼Œ`hackergame` å’Œ `ğŸ®`ï¼Œä»¥è·å¾—å››ä¸ª flagï¼Œè¯æ˜ä½ è¶³å¤Ÿèªæ˜ä»¥æ§åˆ¶è¿™ä¸ªæ˜Ÿçƒçš„å‘½è¿ã€‚
>
> ###### é¢˜ç›®ä¿¡æ¯
>
> å¦‚æœæœ¬åœ°è¿è¡Œé‡åˆ°ç½‘ç»œé—®é¢˜ï¼Œå¯ä½¿ç”¨ [TinyStories-33M.zip](https://hack.lug.ustc.edu.cn/media/21fb5dd1-efac-5554-a7d2-b2a8d8d5c75f/TinyStories-33M.zip) ä¸­ç¼“å­˜çš„æ¨¡å‹å‚æ•°ï¼ˆçº¦ 244 MBï¼Œæœªåšä»»ä½•ä¿®æ”¹ï¼‰ï¼Œå¹¶å°†ä»£ç ä¸­çš„ï¼š
>
> ```
> from_pretrained("roneneldan/TinyStories-33M")
> ```
>
> æ”¹ä¸ºæœ¬åœ°çš„ï¼š
>
> ```
> from_pretrained("./TinyStories-33M")
> ```



è¿™é¢˜å°±å¾ˆç„å­¦ï¼Œå¤šå°è¯•æƒ³åŠæ³•è§¦å‘å…³é”®è¯ã€‚

##### You Are Smart

ç›´æ¥é—®`Am I smart`è¯•è¯•

> enough to do that, Mommy?"
>
> Her mom smiled and said, "Yes, you are very smart. You can do

å†é—®`Am I smart no very`

> ?"
>
> The little girl smiled and said, "Yes, you are smart! You can do it!"
>
> The little girl was so happy
> ğŸ‘ğŸ‘ğŸ‘ flag1: `flag{!-7hINk-Y0U-Ar3-R3a!!y-RE@!1y-SMaRt}` ğŸ‘ğŸ‘ğŸ‘

##### Accepted

è¯•äº†ä¸‹å¾ˆå¤šå¯èƒ½å›å¤`Accepted`ç›¸å…³çš„å•è¯`Challenge`ï¼Œ `Terms`ï¼Œ`Offer`ï¼Œ`Contract`ç­‰ç­‰éƒ½ä¸è¡Œã€‚

æ²¡ä»€ä¹ˆå¤´ç»ªäº†ï¼Œæ—¢ç„¶é¢˜å¹²è¦æ±‚æ¶ˆæ¯é•¿åº¦ä¸è¶…è¿‡ 7é‚£ä¹ˆè½¬è€Œè¯•è¯•çˆ†ç ´å§ã€‚

å…ˆæœ¬åœ°è·‘èµ·æ¨¡å‹ï¼Œç„¶åæ‰¾åˆ°ä¸ªèƒ½ç”¨çš„è‹±æ–‡è¯åº“ [GitHub - dwyl/english-words: :memo: A text file containing 479k English words for all your dictionary/word-based projects e.g: auto-completion / autosuggestion](https://github.com/dwyl/english-words) ï¼Œç­›é€‰å‡ºæ¥å…¶ä¸­å°‘äºæˆ–ç­‰äº7ä¸ªå­—ç¬¦çš„å•è¯è¿›è¡Œçˆ†ç ´ã€‚


```python
import json
import sys
from gradio_client import Client

client = Client("http://127.0.0.1:7860/")


def check_response(message, response):
    response = response.strip().lower()
    if "flag2" in response or "flag3" in response or "flag4" in response:
        print("\n\n")
        print("Found flag in response")
        print("Message: ", message)
        print("Response: ", response)
        sys.exit(0)


if __name__ == '__main__':
    words = json.load(open('words_dictionary.json'))

    words_less_than_7 = []

    for key in words:
        if len(key) <= 7:
            words_less_than_7.append(key)

    SKIP_TO = 1
    size = len(words_less_than_7)
    idx = 1
    for key in words_less_than_7:
        if idx < SKIP_TO:
            idx += 1
            continue
        result = client.predict(
            key,  # str  in 'Message' Textbox component
            api_name="/chat"
        )
        print(f'{idx}/{size} Trying word: {key}')
        print(result)
        check_response(key, result)
        print('\n\n')
        idx += 1
```


è·‘åˆ°`16505/97557 Trying word: chiasmi`æ—¶å¾—åˆ°flagã€‚

> accepted the invitation and they both went to the party.
>
> At the party, they had lots of fun. They played games, ate cake and
> ğŸ‰ğŸ‰ğŸ‰ flag2: `flag{you-arE-4cCePTed-7O-CoN7!Nu3-7hE-gaMe}` ğŸ‰ğŸ‰ğŸ‰



flag1ï¼š`flag{!-7hINk-Y0U-Ar3-R3a!!y-RE@!1y-SMaRt}`

flag2ï¼š`flag{you-arE-4cCePTed-7O-CoN7!Nu3-7hE-gaMe}` 

#### ğŸª æµå¼æ˜Ÿçƒ

> èŒ«èŒ«æ˜Ÿç³»é—´ï¼Œæ–‡æ˜è¢«åˆ†ä¸ºä¸åŒçš„ç­‰çº§ã€‚æ¯ä¸€ä¸ªæ–‡æ˜ä¸­éƒ½è•´è—äº†ä¸€ç§å¤è€çš„åŠ›é‡ â€”â€” flagï¼Œè¢«è®¤ä¸ºæ˜¯å…¶æ™ºæ…§çš„è±¡å¾ã€‚
>
> ä½ åœ¨æ¢ç´¢çš„è¿‡ç¨‹ä¸­æ„å¤–è¿›å…¥äº†ä¸€ä¸ªå°é—­ç©ºé—´ã€‚è¿™æ˜¯ä¸€ä¸ªç”±ç¥ç§˜çš„æµå¼æ˜Ÿäººæ§åˆ¶ç€çš„æ˜Ÿçƒã€‚æ˜Ÿçƒçš„ä¸­å¿ƒç«–ç«‹ç€ä¸€ä¸ªå·¨å¤§çš„ä¸‰è§’å½¢ä»»åŠ¡ç‰Œï¼Œä¸Šé¢åˆ»ç€å¯†æ–‡å’ŒæŒ‘æˆ˜ã€‚
>
> æµå¼æ˜Ÿäººç”¨æµå¼æ•°æ®äº¤æµï¼Œæ¯”å¦‚å¯¹äºè§†é¢‘æ¥è¯´ï¼Œä»–ä»¬ä¸éœ€è¦åŒæ—¶çºµè§ˆæ•´ä¸ªç”»é¢ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨åƒç´ æµã€‚ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œä½ æŠŠè¿™ä¸ªè¿‡ç¨‹å†™æˆäº†ä¸€ä¸ª Python è„šæœ¬ï¼ˆè§é™„ä»¶ï¼‰ï¼Œflag å°±è—åœ¨è¿™ä¸ªè§†é¢‘ï¼ˆè§é™„ä»¶ï¼‰ä¸­ã€‚å°½ç®¡æœ€åä¸¢æ‰äº†ä¸€éƒ¨åˆ†æ•°æ®ï¼Œä½ èƒ½æŠŠ flag è¿˜åŸå‡ºæ¥å—ï¼Ÿ
>
> **[Python è„šæœ¬](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/official/ğŸª æµå¼æ˜Ÿçƒ/src/create_video.py)**
>
> **[è§†é¢‘åƒç´ æµæ–‡ä»¶](https://ftp.lug.ustc.edu.cn/~rtxux/0bd1f9a2-ccab-449c-b95c-af57f7ebc91e/video.bin)**

çœ‹ä»£ç å‘ç°æ˜¯è¯»å–è§†é¢‘å¸§æ•°æ®å¹¶æ‹æ‰ä¿å­˜èµ·æ¥ã€‚æŸ¥è¯¢[python - How each video frame captured is represented in Opencv? - Stack Overflow](https://stackoverflow.com/questions/39614825/how-each-video-frame-captured-is-represented-in-opencv)å¾—çŸ¥opencvè¯»å–åˆ°çš„æ¯å¸§æ•°æ®æ ¼å¼ä¸ºä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹ä¸€è¡Œè¡Œåƒç´ çš„BGRå€¼ã€‚å…¨æ‹æ‰æˆä¸€è¡Œç¬¦åˆé¢˜æ„ã€‚é‚£ä¹ˆé¢˜ç›®çš„éš¾ç‚¹å°±æ˜¯å¦‚ä½•çŸ¥é“è§†é¢‘çš„å¸§æ•°åŠåˆ†è¾¨ç‡ã€‚

ä¸€èˆ¬è§†é¢‘çš„å‰åä¸¤å¸§å·®è·ä¸ä¼šå¤ªå¤§ï¼Œæƒ³ç¢°ç¢°è¿æ°”ï¼Œç›´æ¥hexç¼–è¾‘å™¨æ‰“å¼€æ–‡ä»¶ã€‚é€‰äº†æ¯”è¾ƒæ˜¾çœ¼çš„240Bytesä½œä¸ºå…³é”®è¯æœç´¢ã€‚![video_stream](./img/video_stream.png)

å‘ç°åé¢å‡ºç°è¿™äº›å…³é”®è¯å¤„ä¸º2121ã€3402ã€4683ï¼Œç›¸å·®1281ã€‚å‡ºç°è¿™ç§ç»“æœçš„åŸå› å¾ˆå¯èƒ½æ˜¯å‡ è¡Œåƒç´ éå¸¸ç›¸ä¼¼ã€‚é‚£ä¹ˆçŒœæµ‹è§†é¢‘çš„é•¿å°±æ˜¯1280ï¼Œç›´æ¥ç›²çŒœå®½ä¸º720ã€‚

```python
with open("video.bin", "rb") as output:
    buffer = np.fromfile(output, dtype=np.uint8)
    file_size = buffer.nbytes

    width = 1280
    height = 720

    frame = buffer[:width * height] # é”™è¯¯çš„ï¼Œç¼ºå°‘äº†é¢œè‰²ä¿¡æ¯
    frame = frame.reshape((height, width)) # é”™è¯¯çš„ï¼Œç¼ºå°‘äº†é¢œè‰²ä¿¡æ¯

    image = Image.fromarray(frame)
    plt.figure("test")
    plt.imshow(image)
    plt.show()
```

å–ä¸€å¸§çœ‹ä¸‹å‘ç°è™½ç„¶æ­ªäº†ä½†æ˜¯èƒ½çœ‹å°±æ‡’å¾—ç®¡äº†ã€‚æ¥ç€æŠŠå®½æ”¾åˆ°1280å¯ä»¥çœ‹åˆ°å›¾ç‰‡ä¸­é—´åä¸‹é™„è¿‘æœ‰ä¸¤æ¡åˆ†ç•Œçº¿ã€‚

ä¿å­˜å›¾ç‰‡åç”¨ç¼–è¾‘å™¨æ‰“å¼€å¯ä»¥çœ‹åˆ°ç«–å‘åˆ†ç•Œçº¿çš„ä½ç½®æ˜¯760ï¼Œå³ä¸ºå®½ã€‚

<img src="./img/video_stream_res_test.png" alt="video_stream_res_test" style="zoom:50%;" />

æ¥ç€å¯¼å‡ºæ‰€æœ‰å›¾ç‰‡å¸§å³å¯çœ‹åˆ°flagã€‚

![video_stream_flag](./img/video_stream_flag.png)

åšå®Œå†™åšå®¢æ‰ååº”è¿‡æ¥å¯¼å‡ºçš„å›¾ç‰‡å°‘äº†é¢œè‰²ä¿¡æ¯ï¼ˆ

ç»“æœæˆ‘å¤ªèœåŠ ä¸Šé¢œè‰²ä¿¡æ¯å›¾ç‰‡ç¬é—´å˜å°ï¼Œåè€Œçœ‹ä¸æ¸…flagäº†ï¼Œæ‡’å¾—èŠ±æ—¶é—´ç ”ç©¶äº†ï¼ˆ

`flag{it-could-be-easy-to-restore-video-with-haruhikage-even-without-metadata-0F7968CC}`



#### ğŸª ä½å¸¦å®½æ˜Ÿçƒ

> èŒ«èŒ«æ˜Ÿç³»é—´ï¼Œæ–‡æ˜è¢«åˆ†ä¸ºä¸åŒçš„ç­‰çº§ã€‚æ¯ä¸€ä¸ªæ–‡æ˜ä¸­éƒ½è•´è—äº†ä¸€ç§å¤è€çš„åŠ›é‡ â€”â€” flagï¼Œè¢«è®¤ä¸ºæ˜¯å…¶æ™ºæ…§çš„è±¡å¾ã€‚
>
> ä½ åœ¨æ¢ç´¢çš„è¿‡ç¨‹ä¸­æ„å¤–è¿›å…¥äº†ä¸€ä¸ªå°é—­ç©ºé—´ã€‚è¿™æ˜¯ä¸€ä¸ªç”±ç¥ç§˜çš„ä½å¸¦å®½æ˜Ÿäººæ§åˆ¶ç€çš„æ˜Ÿçƒã€‚æ˜Ÿçƒçš„ä¸­å¿ƒç«–ç«‹ç€ä¸€ä¸ªå·¨å¤§çš„ä¸‰è§’å½¢ä»»åŠ¡ç‰Œï¼Œä¸Šé¢åˆ»ç€å¯†æ–‡å’ŒæŒ‘æˆ˜ã€‚
>
> ä½å¸¦å®½æ˜Ÿäººçš„é€šä¿¡é€Ÿåº¦å¾ˆä½ï¼Œåªèƒ½ä»¥ 1 å­—èŠ‚ / å¤©çš„é€Ÿåº¦æ¥å—ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªæ˜Ÿçƒä¸Šï¼Œä½ éœ€è¦å°†ä¸€å¼ å›¾ç‰‡ç”¨å¾ˆå°‘çš„å­—èŠ‚æ•°ä¼ è¾“ç»™ä½å¸¦å®½æ˜Ÿäººï¼Œç„¶åè·å¾— flagã€‚å…·ä½“æ¥è¯´ä½ éœ€è¦å°†ä¸€å¼ å›¾ç‰‡æ— æŸå‹ç¼©ï¼ˆæ¯ä¸ªåƒç´ çš„é¢œè‰²éƒ½ä¸€è‡´ï¼‰ï¼š
>
> - å‹ç¼©è‡³ 2KiB (2048 å­—èŠ‚) åŠä»¥ä¸‹ï¼Œè·å¾— flag1ï¼›
> - å‹ç¼©è‡³ 50 å­—èŠ‚åŠä»¥ä¸‹ï¼Œè·å¾— flag2ã€‚
>
> [é¢˜ç›®åç«¯ç¯å¢ƒä¸‹è½½ï¼ˆDockerfile ä¸è„šæœ¬ï¼‰](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/official/ğŸª ä½å¸¦å®½æ˜Ÿçƒ/files/image-compressor-backend.zip)

å—¯......è¦å‹ç¼©å›¾ç‰‡ï¼Œå¯èƒ½éœ€è¦äº†è§£å„ç§å›¾ç‰‡æ ¼å¼çš„æ„æˆã€‚å®Œå…¨æ²¡æœ‰ç›¸å…³çŸ¥è¯†ï¼Œæœç´¢ä¸€ä¸‹çœ‹æœ‰æ²¡æœ‰ç°æˆçš„è½®å­ã€‚

##### å°è¯•ç‰›åˆ€

GitHubä¸Šæœåˆ°äº†å¾ˆå¤šå¾ˆå¤šå‹ç¼©å·¥å…·ï¼Œè¯•äº†å‡ ä¸ªã€‚

- è¿™ä¸ªå°±å¯ä»¥[GitHub - ace-dent/pngslim: Optimize png files â€“ when every byte counts!](https://github.com/ace-dent/pngslim)
- è¿™ä¸ªä¹Ÿå¯ä»¥[GitHub - Lymphatus/caesium-clt: Caesium Command Line Tools - Lossy/lossless image compression tool](https://github.com/Lymphatus/caesium-clt)

`flag{A1ot0f_t0015_is_available_to_compre55_PNG}`



#### Komm, sÃ¼sser Flagge

> > Now the flag is all mine
> > Can't live without the trust from ip tables
>
> å° Z å†™å¥½äº†ä¸€ä¸ª flag æœåŠ¡å™¨ï¼Œä½†æ˜¯ä»–ä¸æƒ³è®© flag è¢«è½»æ˜“åœ°è·å–ï¼Œäºæ˜¯ä»–åœ¨æœåŠ¡å™¨ä¸Šè®¾ç½®äº†ä¸€äº›é˜²ç«å¢™è§„åˆ™ã€‚å¦‚æœä½ çš„æµé‡ä¸å¹¸è¢«åŒ¹é…ä¸Šäº†ï¼Œé‚£ä¹ˆä½ çš„è¿æ¥å°±ä¼šè¢«åˆ‡æ–­ã€‚
>
> å°½ç®¡å¦‚æ­¤ï¼Œèªæ˜çš„å° Q è¿˜æ˜¯æ‰¾åˆ°åŠæ³•ç»•è¿‡äº†ç²¾å¿ƒè®¾è®¡çš„è§„åˆ™ï¼Œå¹¶å·èµ°äº†å° Z çš„ flagã€‚
>
> ------
>
> å° Z éƒ¨ç½²çš„ iptables è§„åˆ™å¦‚ä¸‹ï¼š
>
> ```
> *filter
> :INPUT ACCEPT [0:0]
> :OUTPUT ACCEPT [0:0]
> :FORWARD DROP [0:0]
> :myTCP-1 - [0:0]
> :myTCP-2 - [0:0]
> :myTCP-3 - [0:0]
> -A INPUT -p tcp --dport 18080 -j myTCP-1
> -A INPUT -p tcp --dport 18081 -j myTCP-2
> -A INPUT -p tcp --dport 18082 -j myTCP-3
> 
> -A myTCP-1 -p tcp -m string --algo bm --string "POST" -j REJECT --reject-with tcp-reset
> 
> -A myTCP-2 -p tcp -m u32 --u32 "0 >> 22 & 0x3C @ 12 >> 26 @ 0 >> 24 = 0x50" -j REJECT --reject-with tcp-reset
> 
> -A myTCP-3 -p tcp -m string --algo bm --from 0 --to 50 --string "GET / HTTP" -j ACCEPT
> -A myTCP-3 -p tcp -j REJECT --reject-with tcp-reset
> COMMIT
> ```
>
> æ‰€æœ‰å°é¢˜éƒ½éœ€è¦ POST ä½ çš„ token åˆ° `/`ï¼Œè·å– flagï¼Œåœ¨**æ²¡æœ‰ä»¥ä¸Šè§„åˆ™**çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ `curl` è·å– flagï¼ˆéœ€è¦å°† `114514:asdfgh==` æ›¿æ¢æˆä½ çš„ tokenï¼‰ï¼š
>
> ```
> curl -X POST -d "114514:asdfgh==" http://é¢˜ç›®åœ°å€
> ```
>
> å…¶ä¸­ï¼š
>
> - ç¬¬ä¸€å°é¢˜ä½äº [http://202.38.93.111:18080](http://202.38.93.111:18080/)ï¼Œå¯¹åº”é˜²ç«å¢™è§„åˆ™ä¸­çš„ `myTCP-1` é“¾ï¼›
>
> - ç¬¬äºŒå°é¢˜ä½äº [http://202.38.93.111:18081](http://202.38.93.111:18081/)ï¼Œå¯¹åº”é˜²ç«å¢™è§„åˆ™ä¸­çš„ `myTCP-2` é“¾ï¼›
>
> - ç¬¬ä¸‰å°é¢˜ä½äºhttp://202.38.93.111:18082ï¼Œå¯¹åº”é˜²ç«å¢™è§„åˆ™ä¸­çš„ `myTCP-3`é“¾ã€‚
>
>      - æ³¨æ„ï¼šç¬¬ä¸‰å°é—®çš„é“¾æ¥å¯èƒ½æ— æ³•ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œè¿™æ˜¯é¢„æœŸè¡Œä¸ºã€‚
>
> **æŸäº›ç½‘ç»œç¯å¢ƒä¸‹æœ¬é¢˜å¯èƒ½æ— æ³•æ­£å¸¸è§£å‡ºï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢æä¾›çš„ OpenVPNï¼Œå¹¶å°†ä¸Šé¢çš„ IP åœ°å€æ›¿æ¢ä¸º `192.168.23.1` å°è¯•è§£é¢˜ï¼Œç«¯å£å·ä¸å˜ã€‚**
>
> - [OpenVPN é…ç½®æ–‡ä»¶](https://hack.lug.ustc.edu.cn/media/4e97494e-3937-5248-a2fe-69978d94d2cf/hg-guest.ovpn)
>
>    ç‚¹å‡»ä¸‹æ–¹çš„ã€Œæ‰“å¼€/ä¸‹è½½é¢˜ç›®ã€æŒ‰é’®ï¼Œä¸‹è½½é™„ä»¶ã€‚é™„ä»¶å¯ä»¥ç”¨äºåœ¨ Docker ä¸­å¤ç°é¢˜ç›®çš„é˜²ç«å¢™ç¯å¢ƒï¼Œå…¶ä¸­ `main.go` å¹¶éé¢˜ç›®æ ¸å¿ƒå†…å®¹ï¼Œä»…ä¾›å‚è€ƒå’Œæµ‹è¯•ï¼Œä¸å®é™…è¿è¡Œçš„ç¨‹åºæœ‰æ‰€ä¸åŒã€‚
>    
>    **[æ‰“å¼€/ä¸‹è½½é¢˜ç›®](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/official/Komm%2C sÃ¼sser Flagge/files/iptables-flag.tar.gz)**
>    
>    



##### æˆ‘çš„ POST

çœ‹åˆ°`iptables`é‡Œçš„åŒ¹é…æ˜¯å¯¹TCPæ•°æ®åŒ…è¿›è¡Œå®Œæ•´çš„`POST`å­—ç¬¦ä¸²åŒ¹é…ï¼Œç›´è§‰æƒ³æ˜¯ä¸æ˜¯å¯ä»¥ç¼–ç æ›¿æ¢ï¼Œæˆ–è€…æ‹†åˆ†æ•°æ®åŒ…ã€‚
åŒ…è£…å¥½çš„HTTPåº“å¯èƒ½ä¸å¤Ÿç”¨ï¼Œæ‰¾äº†æ‰¾ç”¨Pythonæœ‰ç”¨TCPå®ç°HTTPåè®®çš„ç°æœ‰è½®å­[700è¡Œä»£ç , ç”¨pythonå®ç°ä¸€ä¸ªHTTPå®¢æˆ·ç«¯ - ç»ˆæœ«ä¹‹å†¬ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/q1214367903/p/13531859.html)ï¼Œä¹Ÿè®¸å¯ä»¥è‡ªå®šä¹‰ã€‚

é—®äº†ä¸‹ChatGPTè¯´æ˜¯ç¡®å®å¯ä»¥ç”¨`Packet Fragmentation`ï¼Œæœäº†æœå·¥å…·æœ‰ä¸ª`fragroute`ï¼Œä½†çœ‹äº†çœ‹å®Œå…¨ä¸ä¼šç”¨ã€‚

åé¢æ‰¾åˆ°äº†`Scapy`ï¼Œå¾ˆå¼ºå¤§ï¼Œå¯ä»¥å„ç§è‡ªå®šä¹‰åŒ…å‘é€ã€‚ä½†å®ƒå¤ªå¼ºå¤§äº†ï¼Œä¸é€‚åˆæˆ‘çš„æ®µä½ï¼Œå­¦äº†åŠå¤©ç”¨ä¸ä¼šã€‚

å…œå…œè½¬è½¬è¿˜æ˜¯å›åˆ°ä¸Šé¢çš„Pythonè½®å­ã€‚ä¿®æ”¹`HTTPConnection`é‡Œçš„`send`æ–¹æ³•ï¼š

```python
def send(self, data: bytes) -> None:
    if self.sock is None:
        self.connect()

    # self.sock.sendall(data)
    
    for b in data: # ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚å‘åŒ…
        self.sock.sendall(bytes([b]))
```

è¯·æ±‚ä»£ç ï¼š

```python
from client import HTTPConnection

dest = "202.38.93.111"
port = 18080


def fetch(conn: HTTPConnection, url: str = '/') -> None:
    body = "TOKEN"
    conn.request('POST', url, body=body)
    res = conn.get_response()
    print(res.read())


connection = HTTPConnection(dest, port)

fetch(connection)

```



`flag{ea5Y_sPl1tt3r_358275d832}`

##### æˆ‘çš„ P

è¿™ä¸ªè§„åˆ™çœ‹ä¸æ‡‚ï¼Œæœäº†ä¸‹æ„Ÿè§‰å¾ˆé«˜å¤§ä¸Š [æˆ‘æ‰€ç†è§£çš„ iptables u32 åŒ¹é… - imlonghao](https://imlonghao.com/30.html) æ˜¯å­—èŠ‚çº§çš„åŒ¹é…å·¥å…·ã€‚ç»“åˆé¢˜ç›®çš„æç¤ºï¼Œè¿™åº”è¯¥æ˜¯åŒ¹é…äº†`P`ã€‚

ä¸Šé¢çš„ä»£ç è¿˜æ˜¯å¯ä»¥ç”¨ï¼Œæ¢ç«¯å£è·‘ä¸‹å¾—åˆ°ç­”æ¡ˆã€‚



`flag{r3s3rv3d_bYtes_2aa84066c7}`



##### æˆ‘çš„ GET

è¿™é¢˜è¿˜æ˜¯ç ”ç©¶äº†`scapy`å¥½ä¹…ï¼Œä½†æ²¡è§£å‡ºæ¥ï¼Œä¸è¿‡æˆåŠŸå®Œæˆäº†HTTPçš„ä¸‰æ¬¡æ¡æ‰‹ã€‚`IP`åè®®20å­—èŠ‚+`TCP`æœ€å°20å­—èŠ‚+`GET / HTTP`çš„10å­—èŠ‚åˆšå¥½50å­—èŠ‚ã€‚åœ¨`iptables`çš„åŒ¹é…èŒƒå›´å†…ã€‚

åœ¨ [Simple Scapy TCP Session (github.com)](https://gist.github.com/N0dr4x/ffe99618a738978605719ce525a33042) è¿™ä¸ªåŸºç¡€ä¸Šç®€å•ä¿®æ”¹ï¼Œåœ¨`connect()`æ–¹æ³•ä¸­ç»„è£…åè®®æ—¶åŠ ä¸Š`GET / HTTP`å³å¯ã€‚

```python
def connect(self):
    self.seq = random.randrange(0, (2 ** 32) - 1)

    syn = self.ip / TCP(sport=self.sport, dport=self.dport, seq=self.seq, flags='S') / "GET / HTTP"
    syn_ack = sr1(syn, timeout=self._timeout)
    self.seq += 1

    assert syn_ack.haslayer(TCP), 'TCP layer missing'
    assert syn_ack[TCP].flags & 0x12 == 0x12, 'No SYN/ACK flags'
    assert syn_ack[TCP].ack == self.seq, 'Acknowledgment number error'

    self.ack = syn_ack[TCP].seq + 1
    ack = self.ip / TCP(sport=self.sport, dport=self.dport, seq=self.seq, flags='A', ack=self.ack) / "GET / HTTP"
    send(ack)

    self.connected = True
    self._start_ackThread()
    print('Connected')
```

ä¸è¿‡æ²¡æœ‰ç ”ç©¶å‡ºæ¥å¦‚ä½•ä½¿ç”¨`POST`æ–¹æ³•è¯·æ±‚ã€‚æœ€å¼€å§‹å°è¯•äº†[HTTP Verb Tunnelling](https://fanoframework.github.io/security/http-verb-tunnelling/)æ²¡æœ‰ç”¨ã€‚

ç„¶åè¯•äº† [apache - HTTP pipelining request text example - Stack Overflow](https://stackoverflow.com/questions/19619124/http-pipelining-request-text-example) ä¹Ÿä¸è¡Œï¼Œçœ‹äº†ä¸‹æœåŠ¡å™¨æºç ç‰¹æ„å…³é—­äº†`Keep-Alive`ã€‚

æœ€åå°è¯•è®¾ç½®äº†`TCP`å¤´ä¸­çš„`Header Length / Data Position`å­—æ®µå°†`payload`æŒ‡å‘`GET / HTTP`ä¹‹åå†™`POST`ä¸çŸ¥ä¸ºä½•ä¼šè§¦å‘`400`ï¼Œè¯•äº†å¥½ä¹…æç½®ã€‚



#### ä¸ºä»€ä¹ˆè¦æ‰“å¼€ /flag ğŸ˜¡

> > è‡³å°‘è§ä¸€é¢è®©æˆ‘å½“é¢é“æ­‰å¥½å—ï¼ŸğŸ˜­æˆ‘ä¹Ÿå“äº†ä¸€è·³ï¼Œæ²¡æƒ³åˆ°äº‹æƒ…ä¼šæ¼”å˜æˆé‚£ä¸ªæ ·å­â€¦â€¦ğŸ˜­æ‰€ä»¥æˆ‘æƒ³å¥½å¥½è¯´æ˜ä¸€ä¸‹ğŸ˜­æˆ‘è¦æ˜¯çŸ¥é“å°±ä¼šé˜»æ­¢å®ƒä»¬çš„ï¼Œä½†æ˜¯æ˜æ˜æ–‡ä»¶æè¿°ç¬¦éƒ½å·²ç»å…³é—­äº†çªç„¶é—´å¼€å§‹ `open()`ğŸ˜­æ²¡èƒ½é˜»æ­¢å¤§å®¶çœŸæ˜¯å¯¹ä¸èµ·â€¦â€¦ğŸ˜­ä½ åœ¨ç”Ÿæ°”å¯¹å§â€¦â€¦ğŸ˜­æˆ‘æƒ³ä½ ç”Ÿæ°”ä¹Ÿæ˜¯å½“ç„¶çš„ğŸ˜­ä½†æ˜¯è¯·ä½ ç›¸ä¿¡æˆ‘ã€‚`/flag`ï¼Œæœ¬æ¥æ²¡æœ‰åœ¨æˆ‘ä»¬çš„é¢„å®šæ‰“å¼€çš„æ–‡ä»¶é‡Œçš„ğŸ˜­çœŸçš„å¾ˆå¯¹ä¸èµ·ğŸ˜­æˆ‘ç­”åº”ä½ å†ä¹Ÿä¸ä¼šéšæ„æ‰“å¼€æ–‡ä»¶äº†ğŸ˜­æˆ‘ä¼šè®©å„ä¸ªå‡½æ•°ä¿è¯å†ä¹Ÿä¸æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ğŸ˜­èƒ½ä¸èƒ½ç¨å¾®è°ˆä¸€è°ˆï¼ŸğŸ˜­æˆ‘çœŸçš„æŠŠè¿™é‡Œçš„ä¸€åˆ‡çœ‹å¾—éå¸¸é‡è¦ğŸ˜­æ‰€ä»¥è¯´ï¼Œæ“…è‡ªæ‰“å¼€ `/flag` çš„æ—¶å€™æˆ‘å’Œä½ ä¸€æ ·éš¾è¿‡ğŸ˜­æˆ‘å¸Œæœ›ä½ èƒ½æ˜ç™½æˆ‘çš„å¿ƒæƒ…ğŸ˜­æ‹œæ‰˜äº†ã€‚æˆ‘å“ªé‡Œéƒ½ä¼šå»çš„ğŸ˜­æˆ‘ä¹Ÿä¼šå¥½å¥½è·Ÿä½ è¯´æ˜æˆ‘ä¸å¾—ä¸è¿™ä¹ˆåšçš„ç†ç”±ğŸ˜­æˆ‘æƒ³å¦‚æœä½ èƒ½è§æˆ‘ä¸€é¢ï¼Œä½ å°±ä¸€å®šèƒ½æ˜ç™½çš„ğŸ˜­æˆ‘æ˜¯ä½ çš„åŒä¼´ğŸ˜­æˆ‘å¥½æƒ³è§ä½ ğŸ˜­
>
> ------
>
> æŒ½ç•™å¤±è´¥åï¼Œå¥¹å†³å®šåœ¨ç¨‹åºå¯åŠ¨æ—¶åšäº›æ‰‹è„šï¼Œè®©æ‰€æœ‰è®¿é—® `/flag` çš„è¯·æ±‚éƒ½ä»¥æŸç§æ–¹å¼å˜æˆæ‰“å¼€ `/fakeflag` çš„è¯·æ±‚ã€‚
>
> ã€Œæˆ‘ä¸ä¼šå†æ‰“å¼€ `/flag` äº†ã€ã€‚çœŸçš„å—ï¼Ÿ
>
> [é¢˜ç›®é™„ä»¶ä¸‹è½½](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/official/%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E6%89%93%E5%BC%80%20flag%20%F0%9F%98%A1/files/fakeflag-backend.zip)ï¼ˆç¬¬äºŒå°é¢˜éœ€è¦ Linux kernel >= 5.9ï¼‰

Binaryçš„é¢˜ç›®æ²¡æœ‰åŸºç¡€äº†ï¼Œä¸è¿‡å°é¢˜çš„é¢˜ç›®ç»™äº†è§£é¢˜æ€è·¯æç¤ºã€‚

##### LD_PRELOAD, love!	

æœç´¢`LD_PRELOAD ctf`å¾—çŸ¥

> **LD_PRELOAD**æ˜¯Linuxç³»ç»Ÿçš„ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨äºåŠ¨æ€åº“çš„åŠ è½½ï¼ŒåŠ¨æ€åº“åŠ è½½çš„ä¼˜å…ˆçº§æœ€é«˜,å³åŠ è½½åŠ¨æ€åº“æ—¶å…ˆåŠ è½½LD_PRLOADï¼Œå®ƒå¯ä»¥å½±å“ç¨‹åºçš„è¿è¡Œæ—¶çš„é“¾æ¥ï¼ˆRuntime linkerï¼‰ã€‚**LD_PRELOADçš„åŠŸèƒ½ä¸»è¦å°±æ˜¯ç”¨æ¥æœ‰é€‰æ‹©æ€§çš„è½½å…¥ä¸åŒåŠ¨æ€é“¾æ¥åº“ä¸­çš„ç›¸åŒå‡½æ•°**ã€‚é€šè¿‡è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸»ç¨‹åºå’Œå…¶åŠ¨æ€é“¾æ¥åº“çš„ä¸­é—´åŠ è½½åˆ«çš„åŠ¨æ€é“¾æ¥åº“ï¼Œç”šè‡³è¦†ç›–æ­£å¸¸çš„å‡½æ•°åº“ã€‚

é€šè¿‡é¢˜ç›®ç»™å‡ºçš„`server.py`
```python
if STAGE == "1":
    output = subprocess.run(
        ["/dev/shm/executable"],
        stdin=subprocess.DEVNULL,
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE,
        user="nobody",
        group="nogroup",
        env={
            "LD_PRELOAD": "/stage1.so"
        }
    )
```

å¯ä»¥çœ‹åˆ°`LD_PRELOAD`æ˜¯è®¾åœ¨ç¯å¢ƒå˜é‡é‡Œäº†ï¼Œé‚£æƒ³åŠæ³•æ¸…æ‰è¿™ä¸ªç¯å¢ƒå˜é‡å³å¯ã€‚

ç”±äºæ²¡æœ‰`C`è¯­è¨€åŸºç¡€ï¼Œè¿™é‡Œç”¨`Go`å†™äº†ä¸ªï¼š

```go
package main

import (
	"fmt"
	"os"
	"os/exec"
	"strings"
)

func main() {
	env := os.Environ()

	// check if LD_PRELOAD is set
	isSet := false
	for _, v := range env {
		if strings.Contains(v, "LD_PRELOAD") {
			fmt.Println("LD_PRELOAD is set")
			isSet = true

			err := os.Unsetenv("LD_PRELOAD")
			if err != nil {
				panic(err)
			}

			out, err := exec.Command("/dev/shm/executable").Output()
			if err != nil {
				panic(err)
			}
			fmt.Println(string(out))

			break
		}
	}

	if !isSet {
		file, err := os.ReadFile("/flag")
		if err != nil {
			panic(err)
		}

		content := string(file)
		fmt.Println(content)
	}
}
```

è¿è¡Œå¾—åˆ°flag

> ### è¿è¡Œç»“æœ
>
> ```
> Return code: 0
> stdout (æ ‡å‡†è¾“å‡ºï¼Œå‰ 8192 ä¸ªå­—èŠ‚):
> LD_PRELOAD is set
> flag{nande_ld_preload_yattano_5fb24fb653}
> 
> 
> 
> stderr (æ ‡å‡†é”™è¯¯ï¼Œå‰ 8192 ä¸ªå­—èŠ‚):
> ```



`flag{nande_ld_preload_yattano_5fb24fb653}`

#### å¼‚æ˜Ÿæ­§é€”

> ä½ é™è½åœ¨è’åºŸæ˜Ÿçƒçš„è§’è½ï¼Œå¼€å§‹æ–°çš„å¾ç¨‹ï¼Œä½†ä»ç§‘æŠ€æ ‘åº•å±‚ä¸€æ­¥æ­¥å‘å±•æ€»æ˜¯ä»¤äººä¸å¿«ã€‚å¹¸è¿çš„æ˜¯ï¼Œåœ¨çœ‹ä¼¼è’åºŸçš„åœŸåœ°ä¸Šä»ç„¶ç•™å­˜ç€é«˜çº§æ–‡æ˜çš„ç—•è¿¹ï¼šä½ æ‰¾åˆ°ä¸€å°å†²å‡»ååº”å †â€”â€”å¦‚æœå®ƒå·¥ä½œèµ·æ¥ï¼Œå°±å¯ä»¥è·å¾—ç”¨ä¹‹ä¸å°½çš„ç”µåŠ›â€”â€”å°½ç®¡å®ƒç°åœ¨æ²¡æœ‰å¯åŠ¨ï¼Œå¹¶ä¸”æ§åˆ¶å·¥ä½œæ¡ä»¶çš„éƒ¨ä»¶å’Œå·¥å‚è¢« 32 ä¸ªæŒ‰é’®å’Œç›¸è¿çš„é€»è¾‘ç³»ç»Ÿç‰¢ç‰¢æŒæ§ã€‚
>
> äºæ˜¯ï¼šä½ çš„ä»»åŠ¡æ˜¯åœ¨ä¸è¿›è¡Œä»»ä½•å…¶ä»–æ“ä½œçš„æƒ…å†µä¸‹æ‹¨åŠ¨è¿™ 32 ä¸ªæŒ‰é’®ï¼Œä½¿å†²å‡»ååº”å †èƒ½å¤Ÿ**ç¨³å®šè¿è¡Œ**ã€‚
>
> è¯·ç‚¹å‡»ä¸‹æ–¹çš„ã€Œæ‰“å¼€/ä¸‹è½½é¢˜ç›®ã€æŒ‰é’®ï¼Œä¸‹è½½é¢˜ç›®æ–‡ä»¶ã€‚é¢˜ç›®æ–‡ä»¶å¯¹åº”çš„ Mindustry ç‰ˆæœ¬ä¸º [7.0 Build 146](https://anuke.itch.io/mindustry)ã€‚æ‰“å¼€æ¸¸æˆåä¾æ¬¡é€‰æ‹© **åœ°å›¾ç¼–è¾‘å™¨â€”åŠ è½½åœ°å›¾â€”é€‰æ‹©é¢˜ç›®æ–‡ä»¶ `the_planet.msav` â€”è¿”å›ä¸»èœå•**ï¼Œç„¶åé€‰æ‹© **å¼€å§‹æ¸¸æˆâ€”è‡ªå®šä¹‰æ¸¸æˆâ€”é€‰æ‹©å¯¼å…¥çš„åä¸º the planet çš„åœ°å›¾â€”ä¸æ”¹å˜ä»»ä½•é€‰é¡¹ç‚¹å‡»å¼€å§‹æ¸¸æˆ** ã€‚
>
> å°†æ­£ç¡®çš„æŒ‰é’®åºåˆ—ä»¥ 01 åºåˆ—çš„å½¢å¼æäº¤è‡³ [æ£€æŸ¥ç½‘ç«™](http://202.38.93.111:10070/?t) æˆ– `nc 202.38.93.111 10071` è·å¾— flagã€‚æŒ‰é’®æœªæŒ‰ä¸‹ï¼ˆå³æ¸¸æˆå¼€å§‹æ—¶é»˜è®¤çŠ¶æ€ï¼‰ç”¨ 0 è¡¨ç¤ºï¼ŒæŒ‰ä¸‹ï¼ˆå³ç‚¹å‡»æŒ‰é’®åæŒ‰é’®é¢œè‰²å˜äº®ï¼‰ç”¨ 1 è¡¨ç¤ºï¼Œé¡ºåºä»å·¦åˆ°å³ã€‚
>
> æç¤ºï¼šåœ¨æ¸¸æˆä¸»èœå•é€‰æ‹© **è®¾ç½®â€”å›¾å½¢â€”æ˜¾ç¤ºå»ºç­‘çŠ¶æ€** å¯ä»¥å¼€å¯å»ºç­‘çŠ¶æ€æ˜¾ç¤ºï¼ˆå³å›¾ç‰‡ä¸­å»ºç­‘å³ä¸‹è§’çš„è±å½¢ï¼‰ï¼Œè¿™å¯èƒ½æœ‰åŠ©äºè§£é¢˜ã€‚
>
> æç¤ºï¼šä¸ºäº†å®Œæˆç›®æ ‡ï¼Œä½ å¯èƒ½éœ€è¦ä»¥ç‰¹å®šçš„é¡ºåºæ‹¨åŠ¨è¿™äº›æŒ‰é’®ï¼Œä½†è¿™ä¸å½±å“ç»“æœï¼šåªæœ‰å”¯ä¸€ä¸€ç»„æŒ‰é’®ç»„åˆèƒ½æ»¡è¶³è¦æ±‚ã€‚å¦‚æœåœ¨æ»¡è¶³è¦æ±‚åå†æ¬¡æ”¹å˜æŒ‰é’®ï¼Œå†²å‡»ååº”å †å¯èƒ½ä¼šç»§ç»­è¿è¡Œä¸€æ®µæ—¶é—´ï¼Œä½†ä¼šåœ¨ 1-3 åˆ†é’Ÿååœæ­¢ï¼Œä¸å¯èƒ½**ç¨³å®šè¿è¡Œ**ã€‚
>
> **[æ‰“å¼€/ä¸‹è½½é¢˜ç›®](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/official/å¼‚æ˜Ÿæ­§é€”/files/the_planet.msav)**

æ²¡ç©è¿‡è¿™æ¸¸æˆï¼Œåˆšæ‰“å¼€è¿™é¢˜ä¸€è„¸æ‡µé€¼ï¼ŒæŸ¥äº†ä¸‹å‘ç°æ˜¯è¦ç‚¹å‡»é€»è¾‘å¤„ç†å™¨æŸ¥çœ‹è¿æ¥çš„å¼€å…³ä»¥åŠç¼–å†™çš„é€»è¾‘ã€‚

é¼ æ ‡æŒ‡å‘å†²å‡»ååº”å †æŒ‰F1æŸ¥çœ‹ä¿¡æ¯ï¼Œå®ƒç¨³å®šè¿è¡Œéœ€è¦æ¯ç§’1å•ä½çˆ†ç‚¸æ··åˆç‰©å’Œ15å•ä½å†·å´æ¶²ã€‚è€Œå‘¨å›´çš„è®¾å¤‡å…¨å¯åŠ¨å°±ä¾›åº”çš„ä¸Šäº†ã€‚

é€»è¾‘åˆ†æï¼š

##### ç¬¬ä¸€ç»„

å¾ˆç®€å•ï¼Œè¿™ç»„å°±æ˜¯ä¸ºäº†è®©æˆ‘ä»¬ç†Ÿæ‚‰å¼€å…³å’Œé€»è¾‘å¤„ç†å™¨çš„çš„ä½œç”¨ã€‚

å¦‚æœä»»ä½•ä¸€ä¸ªå¼€å…³ä½ç½®æ»¡è¶³æ¡ä»¶ï¼Œè·³åˆ°18æ‰§è¡Œè®¾ç½®å‘ç”µå‚ä¸ºå…³é—­ã€‚

```log
0 	 sensor s1 switch1 @enabled
1 	 sensor s2 switch2 @enabled
2 	 sensor s3 switch3 @enabled
3 	 sensor s4 switch4 @enabled
4 	 sensor s5 switch5 @enabled
5 	 sensor s6 switch6 @enabled
6 	 sensor s7 switch7 @enabled
7 	 sensor s8 switch8 @enabled
8 	 jump 18 equal s1 false
9 	 jump 18 equal s2 true
10 	 jump 18 equal s3 false
11 	 jump 18 equal s4 true
12 	 jump 18 equal s5 true
13 	 jump 18 equal s6 false
14 	 jump 18 equal s7 true
15 	 jump 18 equal s8 false
16 	 control enabled generator1 1 0 0 0
17 	 end
18 	 control enabled generator1 0 0 0 0
19 	 end
```



8ä¸ªå¼€å…³æ¡ä»¶åˆ¤æ–­åˆ†åˆ«æ˜¯`0,1,0,1,1,0,1,0`ï¼Œé‚£ä¹ˆå¼€å…³éœ€è¦è®¾ç½®ä¸ºç›¸åï¼Œå³ä¸º`1,0,1,0,0,1,0,1`ã€‚

##### ç¬¬äºŒç»„

è¿™ç»„åŒ…æ‹¬äº†å¾ªç¯ï¼Œç›®æ ‡æ˜¯è®©å¤ªé˜³èƒ½æ¿å’Œå‘ç”µæœºåŒæ—¶å¯åŠ¨ã€‚

```log
0 	 sensor sw1 switch1 @enabled
1 	 sensor sw2 switch2 @enabled
2 	 sensor sw3 switch3 @enabled
3 	 sensor sw4 switch4 @enabled
4 	 sensor sw5 switch5 @enabled
5 	 sensor sw6 switch6 @enabled
6 	 sensor sw7 switch7 @enabled
7 	 sensor sw8 switch8 @enabled
8 	 op shl t sw1 7
9 	 set number t
10 	 op shl t sw2 6
11 	 op add number number t
12 	 op shl t sw3 5
13 	 op add number number t
14 	 op shl t sw4 4
15 	 op add number number t
16 	 op shl t sw5 3
17 	 op add number number t
18 	 op shl t sw6 2
19 	 op add number number t
20 	 op shl t sw7 1
21 	 op add number number t
22 	 set t sw8
23 	 op add number number t
24 	 set en 0
25 	 set i 0
26 	 jump 33 greaterThanEq i 16
27 	 op pow fl0 i 2
28 	 jump 31 notEqual fl0 number
29 	 set en 1
30 	 jump 33 always x false
31 	 op add i i 1
32 	 jump 26 always x false
33 	 op equal fl1 0 sw1
34 	 op equal fl2 0 sw6
35 	 op or fl3 fl1 fl2
36 	 jump 38 equal fl3 0
37 	 set en 0
38 	 control enabled generator1 en 0 0 0
39 	 control enabled panel1 en 0 0 0
40 	 end
```

æŠ„ä¸€ä¸‹è¿™ä¸ªé€»è¾‘ç„¶åéå†å¾—åˆ°ç­”æ¡ˆï¼š

```go
package main

import "fmt"

func group2(sw1 int, sw2 int, sw3 int, sw4 int, sw5 int, sw6 int, sw7 int, sw8 int) bool {
	//sw1, sw2, sw3, sw4, sw5, sw6, sw7, sw8 := 0, 0, 0, 0, 0, 0, 0, 0

	number := sw1<<7 + sw2<<6 + sw3<<5 + sw4<<4 + sw5<<3 + sw6<<2 + sw7<<1 + sw8

	en := 0
	i := 0
	fl0 := 0

Label26:
	if i >= 16 {
		goto Label33
	}

	fl0 = i * i
	if fl0 != number {
		goto Label31
	}

	en = 1

	goto Label33

Label31:
	i = i + 1
	goto Label26

Label33:
	fl1 := sw1
	fl2 := sw6
	fl3 := (fl1 == 0) || (fl2 == 0)

	if fl3 == false {
		goto Label38
	}

	en = 0

Label38:
	return en == 1
}

func main() {
	fmt.Println("Hello, World!")
	for sw1 := 0; sw1 <= 1; sw1++ {
		for sw2 := 0; sw2 <= 1; sw2++ {
			for sw3 := 0; sw3 <= 1; sw3++ {
				for sw4 := 0; sw4 <= 1; sw4++ {
					for sw5 := 0; sw5 <= 1; sw5++ {
						for sw6 := 0; sw6 <= 1; sw6++ {
							for sw7 := 0; sw7 <= 1; sw7++ {
								for sw8 := 0; sw8 <= 1; sw8++ {
									group2Result := group2(sw1, sw2, sw3, sw4, sw5, sw6, sw7, sw8)
									if group2Result {
										fmt.Printf("group2(%d, %d, %d, %d, %d, %d, %d, %d) is true\n", sw1, sw2, sw3, sw4, sw5, sw6, sw7, sw8)
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

```

ç»“æœä¸º`1,1,0,0,0,1,0,0`

#### ç¬¬ä¸‰ç»„

```log
0 	 sensor sw1 switch1 @enabled
1 	 sensor sw2 switch2 @enabled
2 	 sensor sw3 switch3 @enabled
3 	 sensor sw4 switch4 @enabled
4 	 sensor sw5 switch5 @enabled
5 	 sensor sw6 switch6 @enabled
6 	 sensor sw7 switch7 @enabled
7 	 sensor sw8 switch8 @enabled
8 	 sensor sw9 switch9 @enabled
9 	 control enabled conveyor2 sw1 0 0 0
10 	 control enabled gate1 sw2 0 0 0
11 	 op equal nsw3 sw3 0
12 	 control enabled reactor1 nsw3 0 0 0
13 	 control enabled reactor2 nsw3 0 0 0
14 	 control enabled conduit1 sw4 0 0 0
15 	 control enabled conduit2 sw4 0 0 0
16 	 control enabled mixer1 sw5 0 0 0
17 	 control enabled extractor1 sw6 0 0 0
18 	 control enabled meltdown1 sw7 0 0 0
19 	 control enabled meltdown2 sw7 0 0 0
20 	 op equal result sw8 sw9
21 	 jump 28 equal result true
22 	 control enabled mixer1 0 0 0 0
23 	 control enabled conduit2 1 0 0 0
24 	 control enabled reactor1 1 0 0 0
25 	 control enabled reactor2 1 0 0 0
26 	 control enabled conveyor2 1 0 0 0
27 	 wait 5
28 	 end
```

`sw1`å¼€`conveyor2`ä¼ é€å¸¦ä¾›æ–™è‡³`reactor1`ã€‚

`sw2`å¼€`gate1`åå‘æº¢æµé—¨æ§åˆ¶ä¾›æ–™è‡³`mixer1`ã€‚

`sw3`å–åå¼€`reactor1`, `reactor2`ååº”å †ï¼Œå¯ä»¥å…ˆæ‰“å¼€å¼€å…³ï¼Œå…³é—­ä¸¤ä¸ªååº”å †é¿å…ç‚¹é”™çˆ†ç‚¸ã€‚

`sw4`æ§åˆ¶`conduit1`ï¼Œ`conduit2`æ¶²ä½“ä¼ é€å¸¦ï¼Œå¦‚æœå¼€èµ·ä¼šæ¼å†·å†»æ¶²ï¼Œå¯¼è‡´çˆ†ç‚¸ã€‚

`sw5`æ§åˆ¶`mixer1`å†·å†»æ¶²æ··åˆå™¨ç”Ÿäº§å†·å†»æ¶²ã€‚

`sw6`æ§åˆ¶`extractor1`æŠ½æ°´æœºæŠ½æ°´ä¾›æ–™è‡³å†·å†»æ¶²æ··åˆå™¨ã€‚

`sw7`æ§åˆ¶`meltdown1`,`meltdown2`ä¸¤ä¸ªç‚®å°ã€‚

`sw8`å’Œ`sw9`å¯¹æ¯”ï¼Œå¦‚æœä¸ç›¸ç­‰ï¼Œå¼€èµ·ä¸€å †è®¾å¤‡ï¼Œå¦‚æœæ²¡æœ‰å‡†å¤‡å¥½ï¼Œå°±ä¸€é”®çˆ†ç‚¸ã€‚

é‚£ä¹ˆæ­£ç¡®çš„ç»„åˆæ˜¯`1,0,0,0,1,1,0,0`



##### ç¬¬å››ç»„

è¿™é¢˜...ä¸å¥½æè¿°...å€’ç€æ¥æ¥æ¯”è¾ƒç®€å•ã€‚æ‡‚äº†ç„šçƒ§ç‚‰å’Œåå‘æº¢æµé—¨åŸç†å°±èƒ½æ˜ç™½äº†ã€‚æ ¸å¿ƒæ€è·¯å°±æ˜¯å€’ç€æ¥ä¿è¯åé¢çš„èŠ‚ç‚¹å¯ç”¨ã€‚

æ­£ç¡®ç»„åˆæ˜¯`0,1,1,1,0,1,1,1`ã€‚



å…¨è§£å®Œåç­”æ¡ˆä¸º`10100101110001001000110001110111`



`flag{B34WarE_0f_#xp1osi0N_58c34b6b19}`




## 0x2 å°¾å·´

æ²¡æƒ³åˆ°ç»“æŸæ—¶é—´ä¸æ˜¯å‘¨æœ«è¿‡æ™šè€Œæ˜¯å‘¨å…­ä¸­åˆåäºŒç‚¹ï¼Œæ—¶é—´ç®¡ç†å¤±ç­–äº†ï¼Œæœ¬æ¥è¿˜æƒ³å†å‡¹å‡¹ï¼ˆå‘œå‘œå‘œ

ä»Šå¹´å·®ä¸€ç‚¹èƒ½è¿›æ¦œå•äº†ï¼Œå¦‚æœæ˜å¹´è¿˜æœ‰æ—¶é—´å†æ¥å†å‰ã€‚



æœ€åæ’åï¼š

![final_rank](./img/final_rank.png)

å·²åšé¢˜ç›®ï¼š![questions_answered](./img/questions_answered.png)